<!DOCTYPE HTML>
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;Excepciones comprobadas versus no verificadas</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css?3.001" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder="" /> 
        <input type="submit" name="btnG" value="Búsqueda" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">Excepciones comprobadas versus no verificadas</div>
    <br />Excepciones no comprobadas:
    <ul>
      <li>
        representan <span class="highlight">defectos en el programa (errores)</span> - a menudo argumentos no válidos pasados a un 
        método no privado. Para citar del <em>The Java Programming Language</em>, por Arnold Gosling y Holmes: "Las excepciones en 
        tiempo de ejecución no comprobadas representan condiciones que, en términos generales, reflejan errores en la lógica de su 
        programa y no pueden recuperarse razonablemente en tiempo de ejecución."
      </li>
      <li>
        son subclases de  
        <code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/RuntimeException.html">RuntimeException</a></code>, y 
        están habitualmente implementadas usando 
        <code>
          <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalArgumentException.html">IllegalArgumentException</a>
        </code>, 
        <code>
          <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/NullPointerException.html">NullPointerException</a>
        </code>, o
        <code>
          <a href="https://docs.oracle.com/javase/10/docs/api/java/lang/IllegalStateException.html">IllegalStateException</a>
        </code>
      </li>
      <li>
        un método <i>no</i> está obligado a establecer una política para las excepciones no comprobadas lanzadas por su 
        implementación (y casi siempre no lo hacen)
      </li>
    </ul>
    Excepciones comprobadas:
    <ul>
      <li>
        representan <span class="highlight">condiciones no válidas en áreas fuera del control inmediato del programa</span> 
        (entrada del usuario no válida, problemas con la base de datos, cortes de la red, ficheros ausentes)
      </li>
      <li>
        son subclases de <code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Exception.html">Exception</a></code>
      </li>
      <li>
        un método está <i>obligado</i> a establecer una política para todas las excepciones comprobadas lanzadas por su 
        implementación (ya se pasando la excepción comprobada más arriba en la pila, o manejándola de alguna forma)
      </li>
    </ul>
    Es algo confuso, pero tenga en cuenta también que 
    <code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/RuntimeException.html">RuntimeException</a></code> 
    (no comprobada) es en sí misma una subclase de 
    <code><a href="https://docs.oracle.com/javase/10/docs/api/java/lang/Exception.html">Exception</a></code> (comprobada).
    <p>
      <b>Ejemplo 1</b>
    </p>
    <p>
      <a href="..\patrones\patrones_187.html">Modelo de Objetos</a> son las clases centradas en los datos usadas para representar 
      elementos en un dominio particular. Los constructores del Modelo de Objetos necesitan manejar tanto la entrada arbitraria del 
      usuario, y la entrada de los <code>ResultSet</code>s. de la base de datos subyacente.
    </p>
    <p>
      Los constructores del Modelo de Objetos deben lanzar excepciones comprobadas:
    </p>
    <ul>
      <li>
        el programa puede no tener control directo sobre la entrada del usuario. Esto es particularmente verdadero en aplicaciones 
        web. Parece más seguro para un Modelo de Objetos tratar la entrada del usuario como si tuviese contenido arbitrario y no 
        validado.
      </li>
      <li>
        no es seguro para una aplicación hacer suposiciones sobre el estado de la base de datos. La base de datos es una entidad 
        independiente, y sus datos pueden ser cambiado de varias ofrmas, fuera de cualquier aplicación en particular. Por ejemplo, 
        las herramientas de carga de datos se usan comunmente para crear un estado inicial en una base de datos nueva. Tales datos 
        pueden facilmente violar las restricciones construídas dentro de una aplicación de llamada. Así, la suposición más segura es 
        tratar a los <code>ResultSet</code>s de la base de datos como si tuvieran contenido arbitrario y no validado.
      </li>
    </ul>
    Aquí tiene un ejemplo de Modelo de Objetos, tomado de la aplicación de ejemplo 
    <a href="..\servlets\servlets_188.html">WEB4J</a>. Su constructor lanza <code>ModelCtorException</code> (una excepción 
    comprobada):
    <br />
    <pre>
<span class="keyword">package</span> hirondelle.fish.main.resto;

<span class="keyword">import</span> hirondelle.web4j.model.ModelCtorException;
<span class="keyword">import</span> hirondelle.web4j.model.ModelUtil;
<span class="keyword">import</span> hirondelle.web4j.model.Id;
<span class="keyword">import</span> hirondelle.web4j.security.SafeText;
<span class="keyword">import</span> hirondelle.web4j.model.Decimal;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.model.Decimal.ZERO;
<span class="keyword">import</span> hirondelle.web4j.model.Check;
<span class="keyword">import</span> hirondelle.web4j.model.Validator;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.util.Consts.FAILS;

<span class="comment">/** Modelo de Objetos para un Restaurante. */</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> Resto {

  <span class="comment">/**
   Constructor completo.
    
   @param aId identificador interno de la base de datos (opcional) 1..50 caracteres
   @param aName del restaurante (requerido), 2..50 caracteres
   @param aLocation dirección de la calle del restaurante (opcional), 2..50 caracteres
   @param aPrice de la comida de patatas fritas y pescado (opcional) $0.00..$100.00
   @param aComment sobre el restaurante en general (opcional) 2..50 caracteres
  */</span>
  <span class="keyword">public</span> Resto(
    Id aId, SafeText aName, SafeText aLocation, Decimal aPrice, SafeText aComment
  ) <span class="keyword">throws</span> ModelCtorException {
    fId = aId;
    fName = aName;
    fLocation = aLocation;
    fPrice = aPrice;
    fComment = aComment;
    validateState();
  }
  
  <span class="keyword">public</span> Id getId() { <span class="keyword">return</span> fId; }
  <span class="keyword">public</span> SafeText getName() {  <span
            class="keyword">return</span> fName; }
  <span class="keyword">public</span> SafeText getLocation() {  <span
            class="keyword">return</span> fLocation;  }
  <span class="keyword">public</span> Decimal getPrice() { <span
            class="keyword">return</span> fPrice; }
  <span class="keyword">public</span> SafeText getComment() {  <span
            class="keyword">return</span> fComment; }

  <span class="keyword">@Override</span> <span class="keyword">public</span> String toString(){
    <span class="keyword">return</span> ModelUtil.toStringFor(<span
            class="keyword">this</span>);
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span>  <span
            class="keyword">boolean</span> equals(Object aThat){
    Boolean result = ModelUtil.quickEquals(<span class="keyword">this</span>, aThat);
    <span class="keyword">if</span> (result ==  <span class="keyword">null</span>) {
      Resto that = (Resto) aThat;
      result = ModelUtil.equalsFor(
        <span class="keyword">this</span>.getSignificantFields(), that.getSignificantFields()
      );
    }
    <span class="keyword">return</span> result;
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span> <span
            class="keyword">int</span> hashCode(){
    <span class="keyword">if</span> (fHashCode == <span class="literal">0</span>){
      fHashCode = ModelUtil.hashCodeFor(getSignificantFields());
    }
    <span class="keyword">return</span> fHashCode;
  }
  
  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> <span class="keyword">final</span> Id fId;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fName;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fLocation;
  <span class="keyword">private</span> <span class="keyword">final</span> Decimal fPrice;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fComment;
  <span class="keyword">private</span> <span class="keyword">int</span> fHashCode;
  
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> Decimal HUNDRED = Decimal.from(<span
            class="literal">"100"</span>);

  <span class="keyword">private</span> <span class="keyword">void</span> validateState() <span
            class="keyword">throws</span> ModelCtorException {
    ModelCtorException ex = <span class="keyword">new</span> ModelCtorException();
    <span class="keyword">if</span> (FAILS == Check.optional(fId, Check.range(<span
            class="literal">1</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"Id es opcional, 1..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.requerido(fName, Check.range(<span
            class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"El nombre del restaurante es requerido, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fLocation, Check.range(<span
            class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"La ubicación es opcional, 2..50 chars."</span>);
    }
    Validator[] priceChecks = {Check.range(ZERO, HUNDRED), Check.numDecimalsAlways(<span
            class="literal">2</span>)};
    <span class="keyword">if</span> (FAILS == Check.optional(fPrice, priceChecks)) {
      ex.add(<span class="literal">"EL precio es opcional, 0.00 to 100.00."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fComment, Check.range(<span
            class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"El comentario es opcional, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> ( ! ex.isEmpty() ) <span
            class="keyword">throw</span> ex;
  }
  
  <span class="keyword">private</span> Object[] getSignificantFields(){
    <span class="keyword">return</span> <span class="keyword">new</span> Object[] {fName, fLocation, fPrice, fComment};
  }
}
 
    </pre>
    <br />
    <b>Ejemplo 2</b>
    <p></p>
    <p>
      <code>Args</code> es una clase de utilidad conveniente. Realiza validaciones comunes sobre los argumentos de los métodos. Si 
      una validación falla, entonces lanza una excepción no comprobada. Es adecuado para verificar la consistencia interna del 
      programa, pero no para verificar la entrada arbitraria del usuario.<br />
    </p>
    <pre>
<span class="keyword">package</span> hirondelle.web4j.util;

<span class="keyword">import</span> java.util.regex.*;

<span class="comment">/**
 Métodos de utilidad para validaciones comunes de argumentos.

&lt;P&gt;Reemplaza sentencias &lt;tt&gt;if&lt;/tt&gt; al principio de un método con 
 llamadas de método más compactas.
 
 &lt;P&gt;Ejemplo de caso de uso.
 &lt;P&gt;En vez de  :
 &lt;PRE&gt;
 public void doThis(String aText){
   if (!Util.textHasContent(aText)){
     throw new IllegalArgumentException();
   }
   //..cuerpo principal eludido
 }
 &lt;/PRE&gt;
 &lt;P&gt;En su lugar, se puede escribir:
 &lt;PRE&gt;
 public void doThis(String aText){
   Args.checkForContent(aText);
   //..cuerpo principal eludido
 }
 &lt;/PRE&gt;
*/</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> Args {
  
  <span class="comment">/**
   Si &lt;code&gt;aText&lt;/code&gt; no satisface  {@link Util#textHasContent}, entonces
   lanza una &lt;code&gt;IllegalArgumentException&lt;/code&gt;.
  
   &lt;P&gt;La mayor parte del texto que se usa en una aplicación es significativo solo si tiene contenido visible.
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> checkForContent(String aText){
    <span class="keyword">if</span>( ! Util.textHasContent(aText) ){
      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span
            class="literal">"El texto no tiene contenido visible"</span>);
    }
  }

  <span class="comment">/**
   Si {@link Util#isInRange} devuelve &lt;code&gt;false&lt;/code&gt;, entonces 
   lanza una &lt;code&gt;IllegalArgumentException&lt;/code&gt;. 
  
   @param aLow es menor o igual que &lt;code&gt;aHigh&lt;/code&gt;.
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> checkForRange(<span
            class="keyword">int</span> aNumber, <span class="keyword">int</span> aLow, <span
            class="keyword">int</span> aHigh) {
    <span class="keyword">if</span> ( ! Util.isInRange(aNumber, aLow, aHigh) ) {
      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(aNumber + <span
            class="literal">" no en el rango "</span> + aLow + <span
            class="literal">".."</span> + aHigh);
    }
  }

  <span class="comment">/**
   Si &lt;tt&gt;aNumber&lt;/tt&gt; es menor que &lt;tt&gt;1&lt;/tt&gt;, entonces lanza una 
   &lt;tt&gt;IllegalArgumentException&lt;/tt&gt;.
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> checkForPositive(<span
            class="keyword">int</span> aNumber) {
    <span class="keyword">if</span> (aNumber &lt; <span class="literal">1</span>) {
      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(aNumber + <span
            class="literal">" es menor que 1"</span>);
    }
  }

  <span class="comment">/**
   Si {@link Util#matches} devuelve &lt;tt&gt;false&lt;/tt&gt;, entonces 
   lanza una &lt;code&gt;IllegalArgumentException&lt;/code&gt;. 
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> checkForMatch(Pattern aPattern, String aText){
    <span class="keyword">if</span> (! Util.matches(aPattern, aText)){
      <span class="keyword">throw</span> <span class="keyword">new</span> IllegalArgumentException(
        <span class="literal">"El texto "</span> + Util.quote(aText) + <span
            class="literal">" no coincide con '"</span> +aPattern.pattern()+ <span
            class="literal">"'"</span>
      );
    }
  }
  
  <span class="comment">/**
   Si &lt;code&gt;aObject&lt;/code&gt; es nulo, entonces lanza una &lt;code&gt;NullPointerException&lt;/code&gt;.
  
   &lt;P&gt;Casos de uso :
  &lt;pre&gt;
   doSomething( Football aBall ){
     //1. llama algún método sobre el argumento : 
     //si aBall es nulo, entonce se lanza automáticamente la excepción, así 
     //que no hay necesidad de una comprobación explícita de nulo.
     aBall.inflate();
    
     //2. asigna al campo correspondiente (común en los constructores): 
     //si aBall es nulo, no se lanza inmediatamente ninguna excepción, así que 
     //una comprobación explícita por nulo podría ser útil aquí
     Args.checkForNull( aBall );
     fBall = aBall;
     
     //3. pasar a algún otro método como parámetro: 
     //puede o no puede ser apropiado tener una comprobación explícita 
     //de nulos aquí, de acuerdo a las necesidades del problema
     Args.checkForNull( aBall ); //??
     fReferee.verify( aBall );
   }
   &lt;/pre&gt;
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> checkForNull(Object aObject) {
    <span class="keyword">if</span> (aObject == <span class="keyword">null</span>) {
      <span class="keyword">throw</span> <span class="keyword">new</span> NullPointerException();
    }
  }
  
  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> Args(){
    <span class="comment">//vacío - evita la construcción
</span>  }
}
 
    </pre>
    <br />
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\patrones\patrones_187.html">Objetos de Modelo</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a><br /> 
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>
  </body>
</html>
