<!DOCTYPE html>
<!-- saved from url=(0056)http://www.javapractices.com/topic/TopicAction.do?Id=209 -->
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;La validación pertenece al Modelo de Objetos</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
        <input type="submit" name="btnG" value="Search" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">La validación pertenece al Modelo de Objetos</div>
    <br />
    Una aplicación debe realizar la validación de datos en el Modelo de Objetos, donde se puede validar tanto la entrada de 
    usuario, y los datos que se obtienen de una base de datos. Esta validación debe ser realizada en una <em>class</em>, y no en 
    un archivo de configuración .xml o alguna herramienta similar.
    <p>
      El rol de un Modelo de Objetos es implementar la lógica de negocios, y la validación es el tipo de lógica empresarial más 
      común (y posiblemente el más importante). <span class="highlight">La razón fundamenteal para crear cualquier clase se indica 
        a menudo como reunir datos y operaciones estrechamente relacionadas con esos datos. Esto es a menudo la primera idea 
        enseñada en los cursos sobre programación de objetos.</span>
    </p>
    <p>
      Sorprendetemente, hay muchos marcos de trabajo de presentación web que <em>no</em> siguen este principio rector de valor 
      duradero. En vez de eso, animan al programador de aplicaicones a <em>separar</em> los datos y la lógica, realizando la 
      validación en las Java Server Pages (JSP), o en ficheros de configuración (habitualmente un archivo <code>.xml</code>). ¿Qué 
      justificación hay para esto? No parece haber ninguna. Si la razón es que "esto permite que la validación sea configurada", 
      entonces esto parece un argumento dudoso. ¿Es el trabajo de un implementador o del autor de una página tomar decisiones con 
      respecto a la lógica comercial importante? No, no lo es. Por el contrario, para la mayoría de las organizaciones, permitir 
      cambios tan casuales en la lógica empresarial en un entorno de producción se considera altamente indeseable y, por lo tanto, 
      es un argumento <em>contra</em> tales técnicas, no a favor de ellas.
    </p>
    <p>
      Fundamentalmente, la validación es una tarea de <em>programación</em>, y siempre lo será: implica <em>lógica</em>. <em>No</em> 
      es una tarea de presentación, y <em>no</em> es una tarea de implementación. Los marcos de trabajo de presentación que 
      proporcionan herramientas de validación se están "filtrando" al dominio de la lógica empresarial, en un intento aparente de 
      incrementar su lista de funcionalidades. Sin embargo, este estilo es inapropiado para el programador de aplicaciones, ya que 
      rompe un regla fundamental de la programación de objetos. Por lo tanto, es probable que deba evitarse ese estilo de 
      validación.
    </p>
    <p>
      Implementar la validación en los Modelos de Objetos es simple y natural. Como de costumbre, cualquier validación común se 
      puede factorizar en clases de utilidad. Además, escribir casos de prueba es simple, pueden ser ejecutados de forma 
      independiente, fuera del entorno web.
    </p>
    <p>
      <b>Ejemplo</b>
    </p>
    <p>
      Para asistir al programador de aplicación con validaciones comunes, la herramienta 
      <a href="http://www.javapractices.com/topic/TopicAction.do?Id=188">WEB4J</a> define una interfaz 
      <code><a href="http://www.javapractices.com/apps/web4j/javadoc/hirondelle/web4j/model/Validator.html">Validator</a></code>
      , y una clase 
      <code><a href="http://www.javapractices.com/apps/web4j/javadoc/hirondelle/web4j/model/Check.html">Check</a></code> que 
      devuelve algunas implementaciones comunes de esa interfaz. La validació nse implementa enteramente en código, y nunca en JSP's
      o archivos de configuración. Aquí, un Modelo de Objetos <code>Resto</code> usa <code>Check</code> para realizar todas las 
      validaciones requeridas en su constructor, llamando a <code>validateState</code>:<br />
    </p>
    <pre>
<span class="keyword">package</span> hirondelle.fish.main.resto;

<span class="keyword">import</span> hirondelle.web4j.model.ModelCtorException;
<span class="keyword">import</span> hirondelle.web4j.model.ModelUtil;
<span class="keyword">import</span> hirondelle.web4j.model.Id;
<span class="keyword">import</span> hirondelle.web4j.security.SafeText;
<span class="keyword">import</span> hirondelle.web4j.model.Decimal;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.model.Decimal.ZERO;
<span class="keyword">import</span> hirondelle.web4j.model.Check;
<span class="keyword">import</span> hirondelle.web4j.model.Validator;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.util.Consts.FAILS;

<span class="comment">/** Modelo de  Objetos para un Restaurante. */</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
			class="keyword">class</span> Resto {

  <span class="comment">/**
   Consrtructor completo.
    
   @param aId identificador de base de datos interna subyacente (opcional) 1..50 caracteres
   @param aName del restaurante (requerido), 2..50 caracteres
   @param aLocation dirección de la calle del restaurante (opcional), 2..50 caracteres
   @param aPrice de la comida de pescado y patatas fritas (opcional) $0.00..$100.00
   @param aComment sobre el restaurante en general(opcional) 2..50 caracteres
  */</span>
  <span class="keyword">public</span> Resto(
    Id aId, SafeText aName, SafeText aLocation, Decimal aPrice, SafeText aComment
  ) <span class="keyword">throws</span> ModelCtorException {
    fId = aId;
    fName = aName;
    fLocation = aLocation;
    fPrice = aPrice;
    fComment = aComment;
    validateState();
  }
  
  <span class="keyword">public</span> Id getId() { <span class="keyword">return</span> fId; }
  <span class="keyword">public</span> SafeText getName() {  <span
			class="keyword">return</span> fName; }
  <span class="keyword">public</span> SafeText getLocation() {  <span
			class="keyword">return</span> fLocation;  }
  <span class="keyword">public</span> Decimal getPrice() { <span
			class="keyword">return</span> fPrice; }
  <span class="keyword">public</span> SafeText getComment() {  <span
			class="keyword">return</span> fComment; }

  <span class="keyword">@Override</span> <span class="keyword">public</span> String toString(){
    <span class="keyword">return</span> ModelUtil.toStringFor(<span
			class="keyword">this</span>);
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span>  <span
			class="keyword">boolean</span> equals(Object aThat){
    Boolean result = ModelUtil.quickEquals(<span class="keyword">this</span>, aThat);
    <span class="keyword">if</span> (result ==  <span class="keyword">null</span>) {
      Resto that = (Resto) aThat;
      result = ModelUtil.equalsFor(
        <span class="keyword">this</span>.getSignificantFields(), that.getSignificantFields()
      );
    }
    <span class="keyword">return</span> result;
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span> <span
			class="keyword">int</span> hashCode(){
    <span class="keyword">if</span> (fHashCode == <span class="literal">0</span>){
      fHashCode = ModelUtil.hashCodeFor(getSignificantFields());
    }
    <span class="keyword">return</span> fHashCode;
  }
  
  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> <span class="keyword">final</span> Id fId;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fName;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fLocation;
  <span class="keyword">private</span> <span class="keyword">final</span> Decimal fPrice;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fComment;
  <span class="keyword">private</span> <span class="keyword">int</span> fHashCode;
  
  <span class="keyword">private</span> <span class="keyword">static</span> <span
			class="keyword">final</span> Decimal HUNDRED = Decimal.from(<span
			class="literal">"100"</span>);

  <span class="keyword">private</span> <span class="keyword">void</span> validateState() <span
			class="keyword">throws</span> ModelCtorException {
    ModelCtorException ex = <span class="keyword">new</span> ModelCtorException();
    <span class="keyword">if</span> (FAILS == Check.optional(fId, Check.range(<span
			class="literal">1</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"El id es opcional, 1..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.required(fName, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"El nombre del restaurante se requiere, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fLocation, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"La ubicación es opcional, 2..50 chars."</span>);
    }
    Validator[] priceChecks = {Check.range(ZERO, HUNDRED), Check.numDecimalsAlways(<span
			class="literal">2</span>)};
    <span class="keyword">if</span> (FAILS == Check.optional(fPrice, priceChecks)) {
      ex.add(<span class="literal">"El precio es opcional, 0.00 to 100.00."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fComment, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"El comentario es opcional, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> ( ! ex.isEmpty() ) <span
			class="keyword">throw</span> ex;
  }
  
  <span class="keyword">private</span> Object[] getSignificantFields(){
    <span class="keyword">return</span> <span class="keyword">new</span> Object[] {fName, fLocation, fPrice, fComment};
  }
}
 
    </pre>
    <br />
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\servlets\servlets_112.html">Los JSPs contendrán sólo lógica de presentación</a><br />
      <a href="..\patrones\patrones_187.html">Objetos Modelo</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br /> Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>

  </body>
</html>