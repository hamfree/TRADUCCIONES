<!DOCTYPE html>
<!-- saved from url=(0056)http://www.javapractices.com/topic/TopicAction.do?Id=209 -->
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;La validación pertenece al Modelo de Objetos</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
        <input type="submit" name="btnG" value="Search" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">La validación pertenece al Modelo de Objetos</div>
    An application should perform data validation in a Model Object, where it can validate both user input, and the data being 
    fetched from a database. This validation should be performed in a <em>class</em>, and not in an .xml configuration file or some 
    similar tool.
    <p>
      The role of a Model Object is to implement business logic, and validation is the single most common (and arguably the most 
      important) kind of business logic. <span class="highlight">The fundamental reason for creating any class is often stated as 
        bringing together data and closely related operations on that data. This is often the first idea taught in courses on object 
        programming.</span>
    </p>
    <p>
      Surprisingly, there are many web presentation frameworks that do <em>not</em> follow this simple guiding principle of lasting 
      value. Instead, they encourage the application programmer to <em>separate</em> data and logic, by doing validation either in 
      Java Server Pages, or in configuration files (typically an <code>.xml</code> file). What is the justification for this? There 
      does not seem to be any. If the reason is that "it allows validation to be configured", then this seems like a dubious 
      argument. Is it the job of a deployer or a page author to make decisions regarding important business logic? No, it's not. On 
      the contrary, for most organizations, allowing such casual changes to business logic in a production environment is regarded 
      as highly undesirable, and is thus an argument <em>against</em> such techniques, not for them.
    </p>
    <p>
      Fundamentally, validation is a <em>programming</em> task, and it always will be: it involves <em>logic</em>. It's 
      <em>not</em> a presentation task, and it's <em>not</em> a deployment task. Presentation frameworks which provide validation 
      tools are "leaking over" into the domain of business logic, in an apparent attempt to increase their list of features. 
      However, this style is inappropriate for the application programmer, since it breaks a fundamental rule of object 
      programming. Thus, such style of validation should likely be avoided.
    </p>
    <p>
      Implementing validation in Model Objects is simple and natural. As usual, any common validations can be factored out into 
      utility classes. In addition, writing test cases is simple, and can be executed stand-alone, outside of the web environment.
    </p>
    <p>
      <b>Example</b>
    </p>
    <p>
      To assist the application programmer with common validations, the 
      <a href="http://www.javapractices.com/topic/TopicAction.do?Id=188">WEB4J</a> tool defines a 
      <code><a href="http://www.javapractices.com/apps/web4j/javadoc/hirondelle/web4j/model/Validator.html">Validator</a></code>
      interface, and a 
      <code><a href="http://www.javapractices.com/apps/web4j/javadoc/hirondelle/web4j/model/Check.html">Check</a></code> class which 
      returns some common implementations of that interface. Validation is implemented entirely in code, and never with JSPs or
      configuration files. Here, a <code>Resto</code> Model Object uses <code>Check</code> to perform all required validation in its 
      constructor, by calling <code>validateState</code>:<br />
    </p>
    <pre>
<span class="keyword">package</span> hirondelle.fish.main.resto;

<span class="keyword">import</span> hirondelle.web4j.model.ModelCtorException;
<span class="keyword">import</span> hirondelle.web4j.model.ModelUtil;
<span class="keyword">import</span> hirondelle.web4j.model.Id;
<span class="keyword">import</span> hirondelle.web4j.security.SafeText;
<span class="keyword">import</span> hirondelle.web4j.model.Decimal;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.model.Decimal.ZERO;
<span class="keyword">import</span> hirondelle.web4j.model.Check;
<span class="keyword">import</span> hirondelle.web4j.model.Validator;
<span class="keyword">import</span> <span class="keyword">static</span> hirondelle.web4j.util.Consts.FAILS;

<span class="comment">/** Model Object for a Restaurant. */</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
			class="keyword">class</span> Resto {

  <span class="comment">/**
   Full constructor.
    
   @param aId underlying database internal identifier (optional) 1..50 characters
   @param aName of the restaurant (required), 2..50 characters
   @param aLocation street address of the restaurant (optional), 2..50 characters
   @param aPrice of the fish and chips meal (optional) $0.00..$100.00
   @param aComment on the restaurant in general (optional) 2..50 characters
  */</span>
  <span class="keyword">public</span> Resto(
    Id aId, SafeText aName, SafeText aLocation, Decimal aPrice, SafeText aComment
  ) <span class="keyword">throws</span> ModelCtorException {
    fId = aId;
    fName = aName;
    fLocation = aLocation;
    fPrice = aPrice;
    fComment = aComment;
    validateState();
  }
  
  <span class="keyword">public</span> Id getId() { <span class="keyword">return</span> fId; }
  <span class="keyword">public</span> SafeText getName() {  <span
			class="keyword">return</span> fName; }
  <span class="keyword">public</span> SafeText getLocation() {  <span
			class="keyword">return</span> fLocation;  }
  <span class="keyword">public</span> Decimal getPrice() { <span
			class="keyword">return</span> fPrice; }
  <span class="keyword">public</span> SafeText getComment() {  <span
			class="keyword">return</span> fComment; }

  <span class="keyword">@Override</span> <span class="keyword">public</span> String toString(){
    <span class="keyword">return</span> ModelUtil.toStringFor(<span
			class="keyword">this</span>);
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span>  <span
			class="keyword">boolean</span> equals(Object aThat){
    Boolean result = ModelUtil.quickEquals(<span class="keyword">this</span>, aThat);
    <span class="keyword">if</span> (result ==  <span class="keyword">null</span>) {
      Resto that = (Resto) aThat;
      result = ModelUtil.equalsFor(
        <span class="keyword">this</span>.getSignificantFields(), that.getSignificantFields()
      );
    }
    <span class="keyword">return</span> result;
  }
  
  <span class="keyword">@Override</span> <span class="keyword">public</span> <span
			class="keyword">int</span> hashCode(){
    <span class="keyword">if</span> (fHashCode == <span class="literal">0</span>){
      fHashCode = ModelUtil.hashCodeFor(getSignificantFields());
    }
    <span class="keyword">return</span> fHashCode;
  }
  
  <span class="comment">// PRIVATE 
</span>  <span class="keyword">private</span> <span class="keyword">final</span> Id fId;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fName;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fLocation;
  <span class="keyword">private</span> <span class="keyword">final</span> Decimal fPrice;
  <span class="keyword">private</span> <span class="keyword">final</span> SafeText fComment;
  <span class="keyword">private</span> <span class="keyword">int</span> fHashCode;
  
  <span class="keyword">private</span> <span class="keyword">static</span> <span
			class="keyword">final</span> Decimal HUNDRED = Decimal.from(<span
			class="literal">"100"</span>);

  <span class="keyword">private</span> <span class="keyword">void</span> validateState() <span
			class="keyword">throws</span> ModelCtorException {
    ModelCtorException ex = <span class="keyword">new</span> ModelCtorException();
    <span class="keyword">if</span> (FAILS == Check.optional(fId, Check.range(<span
			class="literal">1</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"Id is optional, 1..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.required(fName, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"Restaurant Name is required, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fLocation, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"Location is optional, 2..50 chars."</span>);
    }
    Validator[] priceChecks = {Check.range(ZERO, HUNDRED), Check.numDecimalsAlways(<span
			class="literal">2</span>)};
    <span class="keyword">if</span> (FAILS == Check.optional(fPrice, priceChecks)) {
      ex.add(<span class="literal">"Price is optional, 0.00 to 100.00."</span>);
    }
    <span class="keyword">if</span> (FAILS == Check.optional(fComment, Check.range(<span
			class="literal">2</span>,<span class="literal">50</span>))) {
      ex.add(<span class="literal">"Comment is optional, 2..50 chars."</span>);
    }
    <span class="keyword">if</span> ( ! ex.isEmpty() ) <span
			class="keyword">throw</span> ex;
  }
  
  <span class="keyword">private</span> Object[] getSignificantFields(){
    <span class="keyword">return</span> <span class="keyword">new</span> Object[] {fName, fLocation, fPrice, fComment};
  }
}
 
    </pre>
    <br />
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\servlets\servlets_112.html">Los JSPs contendrán sólo lógica de presentación</a><br />
      <a href="..\patrones\patrones_187.html">Objetos Modelo</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br /> Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>

  </body>
</html>