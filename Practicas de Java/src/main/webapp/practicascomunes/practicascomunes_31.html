<!DOCTYPE html>
<!-- saved from url=(0055)http://www.javapractices.com/topic/TopicAction.do?Id=31 -->
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description"
          content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords"
          content="java,programación java,Prácticas de Java,idioma 
          java,estilo java,patrones de diseño java,convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;Tenga cuidado con el operador
      instanceof</title>
    <link id="stylesheet" rel="stylesheet" type="text/css"
          href="../css/stylesheet9.css" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Table of Contents"
         style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search"
            class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255"
               value="" placeholder=""> <input type="submit"
               name="btnG" value="Search"> <input type="hidden"
               name="sitesearch" value="www.javapractices.com">
      </form>
    </nav>
    <div class="page-title">Tenga cuidado con el operador
      instanceof</div>
    <br>Many hold that the
    <code>instanceof</code>
    operator should be used only as a last resort, and that an
    overridden method is usually (but not always) a better alternative.
    <p>
      The
      <code>instanceof</code>
      operator can be used to call a method based <i>explicitly</i> on
      the class of some object, instead of <i>implicitly</i> using an
      overridden method and polymorphism. Thus, inexperienced
      programmers may mistakenly use
      <code>instanceof</code>
      where an overidden method is more appropriate.
    </p>
    <p>
      A common exception to this guideline, however, is the use of
      <code>instanceof</code>
      within an
      <code>
        <a
          href="http://www.javapractices.com/topic/TopicAction.do?Id=17">equals</a>
      </code>
      method.
    </p>
    <p>
      From <i>Effective C++</i>, by Scott Meyers:
    </p>
    <p>
      <i>"Anytime you find yourself writing code of the form "if
        the object is of type T1, then do something, but if it's of
        type T2, then do something else," slap yourself.</i>
    </p>
    <p>
      Here's an example of the type of abuse Scott Meyers is speaking
      of: <br>
    </p>
    <pre>
		<span class="comment">/**
* Naive, incorrect use of instanceof.
*/</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> BadInstanceOf {

  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> doSomething(Animal aAnimal){
    <span class="keyword">if</span> (aAnimal <span class="keyword">instanceof</span> Fish){
      Fish fish = (Fish)aAnimal;
      fish.swim();
    }
    <span class="keyword">else</span> <span class="keyword">if</span> (aAnimal <span
            class="keyword">instanceof</span> Spider){
      Spider spider = (Spider)aAnimal;
      spider.crawl();
    }
  }

  <span class="comment">// PRIVATE
</span>  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">class</span> Animal {}

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Fish <span
            class="keyword">extends</span> Animal {
    <span class="keyword">void</span> swim(){}
  }
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Spider <span
            class="keyword">extends</span> Animal {
    <span class="keyword">void</span> crawl(){}
  }
} 
    </pre>
    The mistake is corrected by using an overridable method:
    <br>
    <pre>
		<span class="comment">/**
* Using polymorphism to call different methods.
* Does not use instanceof.
*/</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> BadInstanceOfFixed {

  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> main(String... aArgs){
    log(<span class="literal">"Starting..."</span>);
     Animal animal = <span class="keyword">new</span> Animal();
     doSomething(animal);
     
     <span class="comment">//repoint the same 'animal' reference to other objects:
</span>     
     animal = <span class="keyword">new</span> Fish();
     doSomething(animal);
     
     animal = <span class="keyword">new</span> Spider();
     doSomething(animal);
     
     log(<span class="literal">"Done."</span>);
  }

  <span class="comment">/**
  * This method implementation doesn't care at all 
  * about Fish/Spider. It just knows that it has 
  * been passed an Animal. Different versions of 
  * 'move' are called, specific to each Animal. 
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> doSomething(Animal aAnimal){
    aAnimal.move();
  }

  <span class="comment">// PRIVATE 
</span>  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">class</span> Animal {
    <span class="keyword">void</span> move(){
      log(<span class="literal">"Move like an animal..."</span>);
    }
  }

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Fish <span
            class="keyword">extends</span> Animal {
    <span class="keyword">@Override</span> <span class="keyword">void</span> move(){
      log(<span class="literal">"Move like a fish..."</span>);
    }
  }
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Spider <span
            class="keyword">extends</span> Animal {
    <span class="keyword">@Override</span> <span class="keyword">void</span> move(){
      log(<span class="literal">"Move like a spider..."</span>);
    }
  }

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">void</span> log(String aMessage){
    System.out.println(aMessage);
  }
} 
    </pre>
    An example run of this class:
    <p></p>
    <pre>Starting...
Move like an animal...
Move like a fish...
Move like a spider...
Done.</pre>
    <br>
    <p></p>
    <div class="topic-section" id="see-also-title">See Also :</div>
    <div id="see-also" class="main-body">
      <a href="..\objetos\objects_17.html">Implementar equals</a> <br>
      <a href="..\practicascomunes\practicascomunes_227.html">Evite
        los estilos de error básicos</a> <br>
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> <span
        id="app_version_number">3.001</span><br> © <span
        id="copyright">2018 Hirondelle Systems</span><br> <a
        href="http://www.javapractices.com/source/SourceAction.do">Código
        Fuente</a> | <a href="mailto:webmaster@javapractices.com"
                      rel="author">Contacto</a> | <a
                      href="http://creativecommons.org/licenses/by-nc-sa/1.0/"
                      rel="license">Licencia</a> | <a
                      href="http://www.javapractices.com/apps/cjp.rss"
                      rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br> Los trozos de código individual tienen una <a
        href="http://www.javapractices.com/LICENSE.txt"
        rel="license">licencia BSD</a><br> Sobre 1,000,000 de
      IPs únicas el último año<br> Última actualización
      <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time>
      <br> - In Memoriam : Bill Dirani -
    </footer>
  </body>
</html>