<!DOCTYPE html>
<!-- saved from url=(0055)http://www.javapractices.com/topic/TopicAction.do?Id=31 -->
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;Tenga cuidado con el operador instanceof</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
        <input type="submit" name="btnG" value="Búsqueda" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">Tenga cuidado con el operador instanceof</div>
    <br />
    Muchos sostienen que el operador <code>instanceof</code> debe ser usado solo como último recurso, y que un método sobreescrito 
    suele ser (pero no siempre) una mejor alternativa.
    <p>
      El operador <code>instanceof</code> se puede usar para llamar un método basado <i>explícitamente</i> en la clase de algún 
      objeto, en lugar de <i>implícitamente</i> usando un método sobreescrito y polimorfismo. Por lo tanto, los programadores sin 
      experiencia pueden usar erróneamente <code>instanceof</code> donde un método sobreescrito es más apropiado.
    </p>
    <p>
      Una excepción común  a esta directriz, sin embargo, es el uso de <code>instanceof</code> dentro de un método 
      <code><a href="../objetos/objects_17.html">equals</a></code>.
    </p>
    <p>
      De <i>C++ Efectivo</i>, por Scott Meyers:
    </p>
    <p>
      <i>Siempre que te encuentres escribiendo un código de la forma "si el objeto es de tipo T1, haz algo, pero si es de tipo T2, 
        haz otra cosa", date una bofetada.</i>
    </p>
    <p>
      Aquí tiene un ejemplo del tipo de abuso del que Scott Meyers está hablando:<br />
    </p>
    <pre>
<span class="comment">/**
 * Uso ingenuo e incorrecto de instanceof.
 */</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> BadInstanceOf {

  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> doSomething(Animal aAnimal){
    <span class="keyword">if</span> (aAnimal <span class="keyword">instanceof</span> Fish){
      Fish fish = (Fish)aAnimal;
      fish.swim();
    }
    <span class="keyword">else</span> <span class="keyword">if</span> (aAnimal <span
            class="keyword">instanceof</span> Spider){
      Spider spider = (Spider)aAnimal;
      spider.crawl();
    }
  }

  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">class</span> Animal {}

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Fish <span
            class="keyword">extends</span> Animal {
    <span class="keyword">void</span> swim(){}
  }
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Spider <span
            class="keyword">extends</span> Animal {
    <span class="keyword">void</span> crawl(){}
  }
} 
    </pre>
    El error se corrige usando un método sobreescribible:
    <br />
    <pre>
<span class="comment">/**
 * Usando polimorfismo para llamar a métodos diferentes.
 * No usa instanceof.
 */</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> BadInstanceOfFixed {

  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> main(String... aArgs){
    log(<span class="literal">"Iniciando..."</span>);
     Animal animal = <span class="keyword">new</span> Animal();
     doSomething(animal);
     
     <span class="comment">//redirige la misma referencia 'animal' a otros objetos:
</span>     
     animal = <span class="keyword">new</span> Fish();
     doSomething(animal);
     
     animal = <span class="keyword">new</span> Spider();
     doSomething(animal);
     
     log(<span class="literal">"Hecho."</span>);
  }

 <span class="comment">/**
  * A esta implementación de método no le importa en absoluto 
  * sobre Fish/Spider. Solo sabe que se le ha 
  * pasado un Animal. Diferentes versiones de 
  * 'move' se llaman, específicas para cada Animal. 
  */</span>
  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> doSomething(Animal aAnimal){
    aAnimal.move();
  }

  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">class</span> Animal {
    <span class="keyword">void</span> move(){
      log(<span class="literal">"Muévete como una animal..."</span>);
    }
  }

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Fish <span
            class="keyword">extends</span> Animal {
    <span class="keyword">@Override</span> <span class="keyword">void</span> move(){
      log(<span class="literal">"Muévete como un pescado..."</span>);
    }
  }
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> <span class="keyword">class</span> Spider <span
            class="keyword">extends</span> Animal {
    <span class="keyword">@Override</span> <span class="keyword">void</span> move(){
      log(<span class="literal">"Muévete como una araña..."</span>);
    }
  }

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">void</span> log(String aMessage){
    System.out.println(aMessage);
  }
} 
    </pre>
    Un ejemplo de ejecución de esta clase:
    <p></p>
    <pre>
Iniciando...
Muévete como una animal...
Muévete como un pescado...
Muévete como una araña...
Hecho.
    </pre>
    <br />
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\objetos\objects_17.html">Implementar equals</a><br />
      <a href="..\practicascomunes\practicascomunes_227.html">Evite los estilos de error básicos</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br /> Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>
  </body>
</html>