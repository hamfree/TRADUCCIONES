<!DOCTYPE html>
<!-- saved from url=(0056)http://www.javapractices.com/topic/TopicAction.do?Id=118 -->
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;Leer y escribir bloqueos</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
        <input type="submit" name="btnG" value="Búsqueda" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">Leer y escribir bloqueos</div>
    <br />
    En la gran mayoría de las aplicaciones de bases de datos, la frecuencia de las operaciones de lectura supera con creces la 
    frecuencia de las operaciones de escritura. Esto es porque las bases de datos implementan los bloqueos de lectura-escritura 
    para sus registros, que permiten la lectura concurrente, pero todavía demandan escritura exclusiva. Esto puede aumentar 
    notablemente el rendimiento.
    <p>
      <em>Ocasionalmente</em>, una clase puede beneficiarse también de un bloqueo de lectura-escritura, por exactamente las mismas 
      razones - las lecturas son mucho más frecuentes que las escrituras. Como es habitual, debe medir el rendimiento para 
      determinar si un bloque de lectura-escritura realmente mejora el rendimiento.
    </p>
    <p>
      Aquí hay un boceto de cómo usar tales bloqueos. Use 
      <code>
        <a
          href="https://docs.oracle.com/javase/10/docs/api/java/util/concurrent/locks/ReentrantReadWriteLock.html">
          ReentrantReadWriteLock</a>
      </code> del paquete <code>java.util.concurrent</code>.<br />
    </p>
    <pre>
<span class="keyword">import</span> java.util.LinkedHashMap;
<span class="keyword">import</span> java.util.Map;
<span class="keyword">import</span> java.util.concurrent.locks.Lock;
<span class="keyword">import</span> java.util.concurrent.locks.ReentrantReadWriteLock;

<span class="comment">/**
  Preferencias de usuario, usando un bloqueo de lectura-escritura.
  
  
 &lt;P&gt;El contexto: la información de preferencias se lee al inicio.
 Los datos de configuración son 'leídos mayormente': usualmente, un llamador 
 simplemente lee la información. Se actualiza solo ocasionalmente.
 
 &lt;P&gt;El uso de un bloque de lectura-escritura significa que varios lectores pueden acceder a los 
 mismos datos simultáneamente. Si un único escritor obtiene el bloqueo, sin embargo, entonces 
 el resto de escritores (ya sean lectores o escritores) se bloquearán hasta que el bloqueo sea 
 liberado por el escritor.
 
  &lt;P&gt;(En la práctica, Brian Goetz informa que la implementación de ConcurrentHashMap es tan buena 
  que probablemente sería suficiente en muchos casos, en lugar de un bloqueo de lectura y escritura).
*/</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
			class="keyword">class</span> Preferences {
  
  <span class="comment">/** Obtener una configuración - esta es la operación más común.  */</span>
  <span class="keyword">public</span> String fetch(String aName){
    String result = <span class="literal">""</span>;
    fReadLock.lock();
    <span class="keyword">try</span> {
      result = fPreferences.get(aName);
    }
    <span class="keyword">finally</span> {
      fReadLock.unlock();
    }
    <span class="keyword">return</span> result;
  }
 
  <span class="comment">/** Cambiar una configuración - esta la operación menos común. */</span>
  <span class="keyword">public</span> <span class="keyword">void</span> update(String aName, String aValue){
    fWriteLock.lock();
    <span class="keyword">try</span> {
      fPreferences.put(aName, aValue);
    }
    <span class="keyword">finally</span> {
      fWriteLock.unlock();
    }
  }
 
  <span class="comment">//...omitido
</span>  
  <span class="comment">// PRIVADO
</span>  
  <span class="comment">/** Contiene las preferencias como pares simples de nombre-valor de Strings. */</span>
  <span class="keyword">private</span> <span class="keyword">final</span> Map&lt;String, String&gt; fPreferences = <span
			class="keyword">new</span> LinkedHashMap&lt;&gt;();
  <span class="keyword">private</span> <span class="keyword">final</span> ReentrantReadWriteLock fLock = <span
			class="keyword">new</span> ReentrantReadWriteLock();
  <span class="keyword">private</span> <span class="keyword">final</span> Lock fReadLock = fLock.readLock();
  <span class="keyword">private</span> <span class="keyword">final</span> Lock fWriteLock = fLock.writeLock();
}
 
    </pre>
    <br />
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\hilos\hilos_253.html">Usar finally para desbloquear</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br /> Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>
  </body>
</html>