<!DOCTYPE html>
<html lang="es">
    <head>
        <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="description" content="Prácticas y técnicas de programación en Java.">
        <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
              convenciones de codigo java">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Prácticas Java-&gt;Observadores y escuchadores</title>
        <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css" media="all">
        <link rel="icon" type="image/png" href="../img/favicon.png">
    </head>
    <body>
        <nav class="menu-bar" id="menu-bar">
            <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
            <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
                <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
                <input type="submit" name="btnG" value="Búsqueda" /> 
                <input type="hidden" name="sitesearch" value="www.javapractices.com" />
            </form>
        </nav>
        <div class="page-title">
            Observadores y escuchadores
        </div>
        <br />
        El patrón 
        The <a href="http://en.wikipedia.org/wiki/Observer_pattern">Observador</a> (también conocido como Escuchador, o 
        Publicar-Subscribir) es particularmente útil para las aplicaciones gráficas.
        <p>
            La idea general es que uno o más objetos (los subscriptores) registren sus intereses en ser notificados de los cambios 
            en otro objeto (el publicador). Los subscriptores pueden también cambiar el estado del publicador, aunque esto no es 
            obligatior (uno podría llamar a estos observadores "activos", a diferencia de los "pasivos", que no cambian el estado 
            del publicador). Las interfaces se usan para asegurar que los publicadores y subscriptore tengan un conocimiento mínimo 
            entre sí.
        </p>
        <p>
            Cuando se usa Swing, hay una elección entre usar 
            <code><a href="https://docs.oracle.com/javase/10/docs/api/java/util/Observable.html">Observable</a></code> y 
            <code><a href="https://docs.oracle.com/javase/10/docs/api/java/util/Observer.html">Observer</a></code>, o uno de las 
            muchas interfaces 
            <code><a href="http://docs.oracle.com/javase/tutorial/uiswing/events/index.html">XXXListener</a></code> que se aplican a 
            a los components del IGU.
        </p>
        <p>
            Aunque <code>Observer</code> es de hecho una interfaz, <code>Observable</code> no es una interfaz ni una clase base 
            abstracta: <i>es una clase concreta</i>. Esto es muy poco habitual. Casi todas las implementaciones de los Patrones de 
            Diseño definen los elementos importantes como interfaces o clases base abstracta, no como clases concretas.
        </p>
        <p>
            <b>Ejemplo</b>
        </p>
        <p>
            La clase 
            <code>
                <a href="http://www.javapractices.com/apps/stocksmonitor/javadoc/src-html/hirondelle/stocks/portfolio/CurrentPortfolio.html">CurrentPortfolio</a>
            </code> es una clase no gráfica que encapsula datos relacionados con un conjunto de acciones - una cartera de acciones. 
            Es la abstracción central de la aplicación, y una variedad de otras clases necesitan interactuar con esta, tanto como 
            escuchadores activos como pasivos. Ya que es una clase no gráfica, extiende 
            <code><a  href="https://docs.oracle.com/javase/10/docs/api/java/util/Observable.html">Observable</a></code>. Tenga en 
            cuenta cómo llama:
        </p>
        <pre>
		<code>
          Observable.<a href="https://docs.oracle.com/javase/10/docs/api/java/util/Observable.html#setChanged()">setChanged()</a>
		</code>
        </pre>
        cada vez que cambian sus datos subyacentes, informando a sus oyentes de los cambios en la cartera.
        <p>
            La clase 
            <code>
                <a href="http://www.javapractices.com/apps/stocksmonitor/javadoc/src-html/hirondelle/stocks/file/FileSaveAction.html">FileSaveAction</a>
            </code> es un  <code>Observer</code> "activo" de <code>CurrentPortfolio</code>: reacciona a los cambios en 
            <code>CurrentPortfolio</code>, y la cambia. Reacciona a <code>CurrentPortfolio</code> en su método <code>update</code>, 
            donde habilita la acción solo cuando <code>CurrentPortfolio</code> tiene ediciones sin salvar. Cuando 
            <code>FileSaveAction</code> se ejecuta por sí misma, por otro lado, su método <code>actionPerformed</code> actúa sobre 
            <code>CurrentPortfolio</code> cambiando su estado a "ediciones sin guardar".<br />
        </p>
        <pre>
<span class="keyword">package</span> hirondelle.stocks.file;

<span class="keyword">import</span> java.awt.event.*;
<span class="keyword">import</span> javax.swing.*;
<span class="keyword">import</span> java.util.*;
<span class="keyword">import</span> hirondelle.stocks.portfolio.PortfolioDAO;
<span class="keyword">import</span> hirondelle.stocks.portfolio.CurrentPortfolio;
<span class="keyword">import</span> hirondelle.stocks.util.ui.UiUtil;
<span class="keyword">import</span> java.util.logging.Logger;
<span class="keyword">import</span> hirondelle.stocks.util.Util;

<span class="comment">/**
* Salva las ediciones realizadas en {@link CurrentPortfolio}, y actualiza la pantalla
* para mostrar que &lt;tt&gt;CurrentPortfolio&lt;/tt&gt; ya no necesita salvarse.
*/</span>
<span class="keyword">public</span> <span class="keyword">final</span> <span
            class="keyword">class</span> FileSaveAction <span
            class="keyword">extends</span> AbstractAction <span
            class="keyword">implements</span> Observer {

  <span class="comment">/**
  * Constructor.
  *  
  * @param aCurrentPortfolio va a ser salvado por esta acción.
  */</span>
  <span class="keyword">public</span> FileSaveAction(CurrentPortfolio aCurrentPortfolio) {
    <span class="keyword">super</span>(<span class="literal">"Save"</span>, UiUtil.getImageIcon(<span
            class="literal">"/toolbarButtonGraphics/general/Save"</span>)); 
    fCurrentPortfolio = aCurrentPortfolio;
    fCurrentPortfolio.addObserver(<span class="keyword">this</span>);
    putValue(SHORT_DESCRIPTION, <span class="literal">"Guarda las ediciones en la cartera actual"</span>);
    putValue(
      ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_S, ActionEvent.CTRL_MASK)
    );
    putValue(LONG_DESCRIPTION, <span class="literal">"Guarde las ediciones en la cartera actual"</span>);
    putValue(MNEMONIC_KEY, <span class="keyword">new</span> Integer(KeyEvent.VK_S));    
  }

  <span class="keyword">@Override</span> <span class="keyword">public</span> <span
            class="keyword">void</span> actionPerformed(ActionEvent e) {
    fLogger.info(<span class="literal">"Guardando las ediciones en la cartera actual."</span>);
    PortfolioDAO portfolioDAO = <span class="keyword">new</span> PortfolioDAO();
    portfolioDAO.save(fCurrentPortfolio.getPortfolio());
    fCurrentPortfolio.setNeedsSave(<span class="keyword">false</span>);
    fCurrentPortfolio.notifyObservers();
  }  
  
  <span class="comment">/**
  * Sincroniza el estado de este objeto con el estado del 
  * &lt;tt&gt;CurrentPortfolio&lt;/tt&gt; pasado al constructor.
  * 
  * Esta acción se habilita solo cuando &lt;tt&gt;CurrentPortfolio&lt;/tt&gt; está editada y 
  * necesita salvarse.
  */</span>
  <span class="keyword">@Override</span> <span class="keyword">public</span> <span
            class="keyword">void</span> update(Observable aPublisher, Object aData) {
    setEnabled(fCurrentPortfolio.getNeedsSave() &amp;&amp; !fCurrentPortfolio.isUntitled());
  } 
  
  <span class="comment">// PRIVADO
</span>  <span class="keyword">private</span> CurrentPortfolio fCurrentPortfolio;
  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> Logger fLogger = Util.getLogger(FileSaveAction.<span
            class="keyword">class</span>);
}
 
        </pre>
        <br />
        <p></p>
        <p></p>
        <div class="topic-section" id="see-also-title">
            Vea También :
        </div>
        <div id="see-also" class="main-body">
            <a href="../swing/swing_163.html">Filtrar las filas de la tabla</a><br />
        </div>
        <footer id="footer" class="legalese">
            <span id="app_name">Prácticas de Java</span> 
            <span id="app_version_number">3.001</span><br /> © 
            <span id="copyright">2018 Hirondelle Systems</span><br /> 
            <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
            <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
            <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
            <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
            <!-- ukey="2AC36CD2" -->
            <!-- ckey="16DF3D87" -->
            <br /> Los trozos de código individual tienen una 
            <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
            Sobre 1,000,000 de IPs únicas el último año<br /> 
            Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
            - In Memoriam : Bill Dirani -
        </footer>
    </body>
</html>