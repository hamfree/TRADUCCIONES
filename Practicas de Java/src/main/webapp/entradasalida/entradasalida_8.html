<!doctype html>
<html lang="es">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta name="description" content="Prácticas y técnicas de programación en Java.">
    <meta name="keywords" content="java, programación java, Prácticas de Java, idioma java, estilo java, patrones de diseño java, 
          convenciones de codigo java">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Prácticas de Java-&gt;Cierre siempre los flujos</title>
    <link id="stylesheet" rel="stylesheet" type="text/css" href="../css/stylesheet9.css?3.001" media="all">
    <link rel="icon" type="image/png" href="../img/favicon.png">
  </head>
  <body>
    <nav class="menu-bar" id="menu-bar">
      <a href="../index.html" title="Tabla de Contenido" style="float: left;">Inicio</a> &nbsp;&nbsp;
      <form method="GET" action="https://www.google.com/search" class="search-form" style="float: right;">
        <input type="text" name="q" size="15" maxlength="255" value="" placeholder=""/> 
        <input type="submit" name="btnG" value="Search" /> 
        <input type="hidden" name="sitesearch" value="www.javapractices.com" />
      </form>
    </nav>
    <div class="page-title">Cierre siempre los flujos</div>
    <br />
    Cuando usa la sentencia 
    <a href="http://docs.oracle.com/javase/7/docs/technotes/guides/language/try-with-resources.html">try-with-resources</a> 
    correctamente, después nunca tiene que cerrar los flujos explícitamente. (De hecho, esa es la razón por la que se agregó 
    try-with-resources en primer lugar).
    <p>
      Sin embargo, puede ver aún código que no usa un KDJ moderno, o falla en aprovecharse de try-with-resources.
    </p>
    <p>
      <b>KDJ &lt; 7</b>
    </p>
    <p>
      Los flujos representan recursos a los que debe siempre limpiar de forma explícita, llamando al método <code>close</code>.
    </p>
    <p>
      Algunas clases <code>java.io</code> (aparentemente solo las clases de salida) incluyen un método <code>flush</code>. 
      Cuando se llama a un método <code>close</code> en tal clase, esta automáticamente realiza un <code>flush</code>. No hay 
      necesidad de llamar explícitamente a <code>flush</code> antes de llamar a <code>close</code>.
    </p>
    <p>
      Un flujo puede ser encadenado a otro pasándoselo al constructor de un segundo flujo. Cuando este segundo flujo se cierra, 
      después este automáticamente también cierra el flujo subyacente original.
    </p>
    <p>
      Si se encadenan múltiples flujos juntos, cerrar el  último que se construyó y, por lo tanto, se encuentra en el nivel más alto 
      de abstracción, cerrará automáticamente todas los flujos subyacentes. Así, uno solo tiene que llamar a <code>close</code> 
      en un flujo para cerrar (y limpiar, si es aplicable) una serie entera de flujos relacionados.
    </p>
    <p>
      <b>Ejemplo</b> <br />
    </p>
    <pre>
<span class="keyword">import</span> java.io.*;
<span class="keyword">import</span> java.util.*;
<span class="keyword">import</span> java.util.logging.*;

<span class="comment">/** KDJ antes de la versión 7. */</span>
<span class="keyword">public</span> <span class="keyword">class</span> ExerciseSerializable {

  <span class="keyword">public</span> <span class="keyword">static</span> <span
            class="keyword">void</span> main(String... aArguments) {
    <span class="comment">//crea una Lista serializable
</span>    List&lt;String&gt; quarks = Arrays.asList(
      <span class="literal">"up"</span>, <span class="literal">"down"</span>, <span
            class="literal">"strange"</span>, <span class="literal">"charm"</span>, <span
            class="literal">"top"</span>, <span class="literal">"bottom"</span>
    );

    <span class="comment">//serializa la Lista
</span>    <span class="comment">//tenga en cuenta el uso de referencias a clase base abstracta
</span>
    <span class="keyword">try</span>{
      <span class="comment">//usa almacenamiento en búfer
</span>      OutputStream file = <span class="keyword">new</span> FileOutputStream(<span
            class="literal">"quarks.ser"</span>);
      OutputStream buffer = <span class="keyword">new</span> BufferedOutputStream(file);
      ObjectOutput output = <span class="keyword">new</span> ObjectOutputStream(buffer);
      <span class="keyword">try</span>{
        output.writeObject(quarks);
      }
      <span class="keyword">finally</span>{
        output.close();
      }
    }  
    <span class="keyword">catch</span>(IOException ex){
      fLogger.log(Level.SEVERE, <span class="literal">"No puedo realizar la salida."</span>, ex);
    }

    <span class="comment">//deserializa el fichero quarks.ser
</span>    <span class="comment">//tenga en cuenta el uso de referencias a clase base abstracta
</span>    
    <span class="keyword">try</span>{
      <span class="comment">//usa almacenamiento en búfer
</span>      InputStream file = <span class="keyword">new</span> FileInputStream(<span
            class="literal">"quarks.ser"</span>);
      InputStream buffer = <span class="keyword">new</span> BufferedInputStream(file);
      ObjectInput input = <span class="keyword">new</span> ObjectInputStream (buffer);
      <span class="keyword">try</span>{
        <span class="comment">//deserializa la Lista
</span>        List&lt;String&gt; recoveredQuarks = (List&lt;String&gt;)input.readObject();
        <span class="comment">//visualiza sus datos
</span>        <span class="keyword">for</span>(String quark: recoveredQuarks){
          System.out.println(<span class="literal">"Quark Recuperado: "</span> + quark);
        }
      }
      <span class="keyword">finally</span>{
        input.close();
      }
    }
    <span class="keyword">catch</span>(ClassNotFoundException ex){
      fLogger.log(Level.SEVERE, <span class="literal">"No puedo realizar la entrada. Clase no encontrada."</span>, ex);
    }
    <span class="keyword">catch</span>(IOException ex){
      fLogger.log(Level.SEVERE, <span class="literal">"No puedo realizar la entrada."</span>, ex);
    }
  }

  <span class="comment">// PRIVADO
</span>
  <span class="comment">//Usa las facilidades de registro de Java para grabar las excepciones.
</span>  <span class="comment">//El comportamiento del logger se puede configurrar a través de 
</span>  <span class="comment">//un fichero de texto, o mediante programación a través de la IPA de logging.
</span>  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">final</span> Logger fLogger =
    Logger.getLogger(ExerciseSerializable.<span class="keyword">class</span>.getPackage().getName())
  ;
} 
    </pre>
    <br />
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">Vea También :</div>
    <div id="see-also" class="main-body">
      <a href="..\excepciones\excepciones_25.html">Finally y catch</a><br /> 
      <a href="..\entradasalida\entradasalida_42.html">Leer y escribir ficheros de texto</a><br />
      <a href="..\tareascomunes\tareascomunes_43.html">Recuperando recursos</a><br />
    </div>
    <footer id="footer" class="legalese">
      <span id="app_name">Prácticas de Java</span> 
      <span id="app_version_number">3.001</span><br /> © 
      <span id="copyright">2018 Hirondelle Systems</span><br /> 
      <a href="http://www.javapractices.com/source/SourceAction.do">Código Fuente</a> | 
      <a href="mailto:webmaster@javapractices.com" rel="author">Contacto</a> | 
      <a href="http://creativecommons.org/licenses/by-nc-sa/1.0/" rel="license">Licencia</a> | 
      <a href="http://www.javapractices.com/apps/cjp.rss" rel="alternate" type="application/rss+xml">RSS</a>
      <!-- ukey="2AC36CD2" -->
      <!-- ckey="16DF3D87" -->
      <br /> Los trozos de código individual tienen una 
      <a href="http://www.javapractices.com/LICENSE.txt" rel="license">licencia BSD</a><br /> 
      Sobre 1,000,000 de IPs únicas el último año<br /> 
      Última actualización <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time><br />
      - In Memoriam : Bill Dirani -
    </footer>
  </body>
</html>
