<!DOCTYPE html>
<html lang="es">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta name="description"
    content="Prácticas y técnicas de programación en Java.">
<meta name="keywords"
    content="java,programación java,Prácticas de Java,idioma 
        java,estilo java,patrones de diseño java,convenciones de codigo java">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Prácticas Java-&gt;Obtener la conexión a la base de datos</title>
<link id="stylesheet" rel="stylesheet" type="text/css"
    href="../css/stylesheet9.css" media="all">
<link rel="icon" type="image/png" href="../img/favicon.png">
</head>
<body>
    <nav class="menu-bar" id="menu-bar">
        <a href="../index.html" title="Table of Contents"
            style="float: left;">Inicio</a> &nbsp;&nbsp;
        <form method="GET" action="https://www.google.com/search"
            class="search-form" style="float: right;">
            <input name="q" size="15" maxlength="255" placeholder=""
                type="text"> <input name="btnG" value="Search"
                type="submit"> <input name="sitesearch"
                value="www.javapractices.com" type="hidden">
        </form>
    </nav>
    <div class="page-title">Obtener la conexión a la base de datos</div>
    <br>There are two sources of database connections - either a
    <code>
        <a
            href="https://docs.oracle.com/javase/10/docs/api/javax/sql/DataSource.html">DataSource</a>
    </code>
    or a
    <code>
        <a
            href="https://docs.oracle.com/javase/10/docs/api/java/sql/DriverManager.html">DriverManager</a>
    </code>
    .
    <p>
        If available, JNDI and the
        <code>DataSource</code>
        interface should be used to get a
        <code>
            <a
                href="https://docs.oracle.com/javase/10/docs/api/java/sql/Connection.html">Connection</a>
        </code>
        instead of
        <code>DriverManager</code>
        . The JNDI style is typical when using an application server or
        a web container. (For example, the popular <a
            href="http://jakarta.apache.org/tomcat/">Tomcat</a> product
        includes JNDI services and connection pools.)
    </p>
    <p>
        <span class="highlight">Always remember that database
            connections need to be properly released!</span>
    </p>
    <p>Options for specifying the connection parameters include:</p>
    <ul>
        <li>server configuration settings (likely the most common
            style)</li>
        <li>direct user input for user name and password</li>
        <li>a properties file, web.xml file, or <code>
                <a
                    href="https://docs.oracle.com/javase/10/docs/api/java/util/ResourceBundle.html">ResourceBundle</a>
            </code> to keep parameters out of compiled code
        </li>
        <li>the <code>jdbc.drivers</code> property of the <code>
                <a
                    href="https://docs.oracle.com/javase/10/docs/api/java/lang/System.html">System</a>
            </code> class
        </li>
    </ul>
    <b>Example</b>
    <p>
        Here's a reminder of the basics of getting a
        <code>Connection</code>
        . <br>
    </p>
    <pre>
        <span class="keyword">import</span> java.sql.*;
<span class="keyword">import</span> javax.naming.*;
<span class="keyword">import</span> javax.sql.*;

<span class="keyword">final</span> <span class="keyword">class</span> GetConnection {

  <span class="comment">/** Uses JNDI and Datasource (preferred style).   */</span>
  Connection getJNDIConnection(){
    String DATASOURCE_CONTEXT = <span class="literal">"java:comp/env/jdbc/blah"</span>;
    
    Connection result = <span class="keyword">null</span>;
    <span class="keyword">try</span> {
      Context initialContext = <span class="keyword">new</span> InitialContext();
      <span class="keyword">if</span> ( initialContext == <span
            class="keyword">null</span>){
        log(<span class="literal">"JNDI problem. Cannot get InitialContext."</span>);
      }
      DataSource datasource = (DataSource)initialContext.lookup(DATASOURCE_CONTEXT);
      <span class="keyword">if</span> (datasource != <span
            class="keyword">null</span>) {
        result = datasource.getConnection();
      }
      <span class="keyword">else</span> {
        log(<span class="literal">"Failed to lookup datasource."</span>);
      }
    }
    <span class="keyword">catch</span> ( NamingException ex ) {
      log(<span class="literal">"Cannot get connection: "</span> + ex);
    }
    <span class="keyword">catch</span>(SQLException ex){
      log(<span class="literal">"Cannot get connection: "</span> + ex);
    }
    <span class="keyword">return</span> result;
  }

  <span class="comment">/** Uses DriverManager.  */</span>
  Connection getSimpleConnection() {
    <span class="comment">//See your driver documentation for the proper format of this string :
</span>    String DB_CONN_STRING = <span class="literal">"jdbc:mysql://localhost:3306/airplanes"</span>;
    <span class="comment">//Provided by your driver documentation. In this case, a MySql driver is used : 
</span>    String DRIVER_CLASS_NAME = <span class="literal">"org.gjt.mm.mysql.Driver"</span>;
    String USER_NAME = <span class="literal">"juliex"</span>;
    String PASSWORD = <span class="literal">"ui893djf"</span>;
    
    Connection result = <span class="keyword">null</span>;
    <span class="keyword">try</span> {
      Class.forName(DRIVER_CLASS_NAME).newInstance();
    }
    <span class="keyword">catch</span> (Exception ex){
      log(<span class="literal">"Check classpath. Cannot load db driver: "</span> + DRIVER_CLASS_NAME);
    }

    <span class="keyword">try</span> {
      result = DriverManager.getConnection(DB_CONN_STRING, USER_NAME, PASSWORD);
    }
    <span class="keyword">catch</span> (SQLException e){
      log( <span class="literal">"Driver loaded, but cannot connect to db: "</span> + DB_CONN_STRING);
    }
    <span class="keyword">return</span> result;
  }

  <span class="keyword">private</span> <span class="keyword">static</span> <span
            class="keyword">void</span> log(Object aObject){
    System.out.println(aObject);
  }
}
 
</pre>
    <br>
    <p></p>
    <p></p>
    <div class="topic-section" id="see-also-title">See Also :</div>
    <div id="see-also" class="main-body">
        <a href="..\tareascomunes\tareascomunes_43.html">Recuperando
            recursos</a> <br> <a href="..\bbdd\bbdd_75.html">Grupos
            de conexión</a> <br>
    </div>
    <footer id="footer" class="legalese">
        <span id="app_name">Prácticas de Java</span> <span
            id="app_version_number">3.001</span><br> © <span
            id="copyright">2018 Hirondelle Systems</span><br> <a
            href="http://www.javapractices.com/source/SourceAction.do">Código
            Fuente</a> | <a href="mailto:webmaster@javapractices.com"
            rel="author">Contacto</a> | <a
            href="http://creativecommons.org/licenses/by-nc-sa/1.0/"
            rel="license">Licencia</a> | <a
            href="http://www.javapractices.com/apps/cjp.rss"
            rel="alternate" type="application/rss+xml">RSS</a>
        <!-- ukey="2AC36CD2" -->
        <!-- ckey="16DF3D87" -->
        <br> Los trozos de código individual tienen una <a
            href="http://www.javapractices.com/LICENSE.txt"
            rel="license">licencia BSD</a><br> Sobre 1,000,000 de
        IPs únicas el último año<br> Última actualización
        <time id="last_updated_on" datetime="2018-06-03">2018-06-03</time>
        <br> - In Memoriam : Bill Dirani -
    </footer>
</body>
</html>