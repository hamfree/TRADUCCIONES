<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Utilizando Métodos del Secuenciador (Los Tutoriales de Java&trade; &gt; Sonido)
        </title>
        <meta name="description" content="" />
        <meta name="keywords" content="java programming, learn java, java sample code, " />
        <link rel="stylesheet" href="../indice.css" type="text/css"/>
        <script src="../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkAHEAD"><a href="sampled-overview.html">Descripción del Paquete Sampled</a></div>
                <div class="linkAHEAD"><a href="accessing.html">Accediendo a los Recursos del Sistema de Audio</a></div>
                <div class="linkAHEAD"><a href="playing.html">Reproducción de Audio</a></div>
                <div class="linkAHEAD"><a href="capturing.html">Grabando Audio</a></div>
                <div class="linkAHEAD"><a href="controls.html">Procesando Audio con Controles</a></div>
                <div class="linkAHEAD"><a href="converters.html">Usando Ficheros y Convertidores de Formato</a></div>
                <div class="linkAHEAD"><a href="overview-MIDI.html">Descripción del Paquete MIDI</a></div>
                <div class="linkAHEAD"><a href="accessing-MIDI.html">Accediendo a los Recursos del Sistema MIDI</a></div>
                <div class="linkAHEAD"><a href="MIDI-messages.html">Transmitiendo y Recibiendo Mensajes MIDI</a></div>
                <div class="linkAHEAD"><a href="MIDI-seq-intro.html">Introducción a los Secuenciadores</a></div>
                <div class="nolinkAHEAD">Utilizando Métodos del Secuenciador</div>
                <div class="linkAHEAD"><a href="MIDI-seq-adv.html">Usando Características Avanzadas del Secuenciador</a></div>
                <div class="linkAHEAD"><a href="MIDI-synth.html">Sintetizando Sonido</a></div>
                <div class="linkAHEAD"><a href="SPI-intro.html">Introducción a los Interfaces de los Proveedores de Servicio</a></div>
                <div class="linkAHEAD"><a href="SPI-providing-sampled.html">Proporcionando Servicios de Audio Sampleado</a></div>
                <div class="linkAHEAD"><a href="SPI-providing-MIDI.html">Proporcionando Servicios MIDI</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Sonido
            </div>
            <div id="BreadCrumbs">
                <a href="../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="./index.html" target="_top">Sonido</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="MIDI-seq-intro.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="./TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="MIDI-seq-adv.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Utilizando Métodos del Secuenciador</h1>
            </div>
            <div id="PageContent">
                <p>
                    La interfaz 
                    <a class="APILink" target="_blank"
                       href="https://docs.oracle.com/javase/8/docs/api/javax/sound/midi/Sequencer.html">
                        <code>Sequencer</code></a> proporciona métodos en varias categorías:
                </p>
                <ul>
                    <li>
                        Métodos para cargar datos de secuencia desde un archivo MIDI o un objeto <code>Sequence</code>, y para 
                        salvar los datos de secuencia cargados actualmente a un archivo MIDI.
                    </li>
                    <li>
                        Métodos análogos a las funciones de transporte de una grabadora, para parar e iniciar la reproducción y 
                        grabación, habilitar y deshabilitar grabaciones en pistas específicas, y cambiar la posición actual de 
                        reproducción o grabación en una <code>Sequence</code>.
                    </li>
                    <li>
                        Métodos avanzados para consultar y configurar la sincronización y parámetros de tiempo del objeto. Un 
                        <code>Sequencer</code> puede reproducir en tempos diferentes, con algunas <code>Tracks</code> silenciadas, 
                        y en varios estados de sincronización con otros objetos.
                    </li>
                    <li>
                        Métodos avanzados para registrar objetos "listener" que son notificados cuando el <code>Sequencer</code> 
                        procesa ciertas clases de eventos MIDI.
                    </li>
                </ul>
                <p>
                    Independientemente de cuáles métodos de <code>Sequencer</code> vaya a invocar, el primer paso para obtener un 
                    dispositivo <code>Sequencer</code> desde el sistema y reservarlo para el uso de su programa.
                </p>
                <p></p>
                <h2>
                    Obtener un Secuenciador
                </h2>
                <p>
                    Un programa de aplicación no instancia un <code>Sequencer</code>; después de todo, <code>Sequencer</code> es 
                    simplemente una interfaz. En su lugar, como todos los dispositivos del paquete MIDI de la IPA de Sonido de Java,
                    un <code>Sequencer</code> se accede a través de un objeto estático <code>MidiSystem</code>. Como se mencionó 
                    previamente en 
                    <a class="TutorialLink" target="_top" href="accessing-MIDI.html">Accediendo a los Recursos del Sistema MIDI</a>, 
                    el método siguiente de <code>MidiSystem</code> se puede usar para obtener el <code>Sequencer</code> 
                    predeterminado:
                </p>
                <div class="codeblock">
                    <pre>
static Sequencer getSequencer()
                    </pre>
                </div>
                <p>
                    El fragmento de código siguiente obtiene el <code>Sequencer</code> predeterminado, adquiere cualquier recurso 
                    del sistema que necesita, y lo hace operacional:
                </p>
                <div class="codeblock">
                    <pre>
Sequencer sequencer;
// Obtiene el secuenciador predeterminado.
sequencer = MidiSystem.getSequencer(); 
if (sequencer == null) {
    // Error -- el dispositivo secuenciador no se admite.
    // Informar al usuario y volver...
} else {
    // Adquiere los recursos y los hace operacionales.
    sequencer.open();
}
                    </pre>
                </div>
                <p>
                    La invocación de <code>open</code> reserva el dispositivo secuenciador para el uso de su programa. No tiene 
                    mucho sentido imaginar compartir un secuenciador, porque solo puede reproducir una secuencia a la vez. Cuando 
                    ha terminado de usar el secuenciador, puede ponerlo a disposición de otros programas invocando 
                    <code>close</code>.
                </p>
                <p>
                    Los secuenciadores no predeterminados se pueden obtener como se describe en 
                    <a class="TutorialLink" target="_top" href="accessing-MIDI.html">Accediendo a los Recursos del Sistema MIDI</a>.
                </p>
                <p></p>
                <h2>
                    Cargar una Secuencia
                </h2>
                <p>
                    Una vez ha obtenido un secuenciador desde el sistema y lo reservó, necesita cargar los datos que el 
                    secuenciador debe reproducir. Hay tres formas típicas de lograr esto:
                </p>
                <ul>
                    <li>Leer los datos de la secuencia desde un archivo MIDI</li>
                    <li>
                        Grabarlos en tiempo real recibiendo mensajes MIDI desde otro dispositivo, tal como un puerto de entrada MIDI
                    </li>
                    <li>
                        Construirlo de forma programada "desde cero" agregando pistas a una secuencia vacía y agregando objetos 
                        <code>MidiEvent</code> a esas pistas
                    </li>
                </ul>
                <p>
                    Veremos ahora la primera de estas formas de obtener los datos de la secuencia. (Las otras dos formas se 
                    describen debajo en <a href="#124654">Grabar y Salvar Secuencias</a> y 
                    <a href="#124674">Editar una Secuencia</a>, respectivamente). Esta primera forma en realidad abarca dos enfoques 
                    ligeramente diferentes. Un enfoque es alimentar los datos de un archivo MIDI a un <code>InputStream</code> que 
                    usted despues lee directamente al secuenciador mediante <code>Sequencer.setSequence(InputStream)</code>. Con 
                    este enfoque, no crea explícitamente un objeto <code>Sequence</code>. En realidad, la implementación de 
                    <code>Sequencer</code> puede incluso no crear una <code>Sequence</code> entre bastidores, porque algunos 
                    secuenciadores tienen un mecanismo integrado para manejar datos directamente desde un archivo.
                </p>
                <p>
                    El otro enfoque es crear una <code>Sequence</code> explícitamente. Necesitará usar este enfoque si va a editar 
                    los datos de la secuencia antes de reproducirla. Con este enfoque, invoca el método sobrecargado 
                    <code>getSequence</code> de <code>MidiSystem</code>. El método es capaz de obtener la secuencia desde un 
                    <code>InputStream</code>, un <code>File</code>, o una <code>URL</code>. El método devuelve un objeto 
                    <code>Sequence</code> que puede ser cargado en un <code>Sequencer</code> para reproducir. Ampliando el extracto 
                    del código anterior, aquí tiene un ejemplo de obtener un objeto <code>Sequence</code> desde un 
                    <code>File</code> y cargarlo en nuestro <code>sequencer</code>:
                </p>
                <div class="codeblock">
                    <pre>
try {
    File myMidiFile = new File("seq1.mid");
    // Construye un objeto Construct, y 
    // lo carga en mi secuenciaor.
    Sequence mySeq = MidiSystem.getSequence(myMidiFile);
    sequencer.setSequence(mySeq);
} catch (Exception e) {
   // Maneja errores y/o retorna
}
                    </pre>
                </div>
                <p>
                    Como el método <code>getSequence</code> de <code>MidiSystem</code>, <code>setSequence</code> puede lanzar una 
                    <code>InvalidMidiDataException</code> &mdash; y, en el el caso de la variante <code>InputStream</code>, una 
                    <code>IOException</code> &mdash; si tiene algún problema.
                </p>
                <p></p>
                <h2>
                    Reproducir una Secuencia
                </h2>
                <p>
                    Iniciar y parar un <code>Sequencer</code> se consigue usando los métodos siguientes:
                </p>
                <div class="codeblock">
                    <pre>
    void start()
                    </pre>
                </div>
                <p>
                    y
                </p>
                <div class="codeblock">
                    <pre>
    void stop()
                    </pre>
                </div>
                <p>
                    El método <code>Sequencer.start</code> empieza la reproducción de la secuencia. Tenga en cuenta que la 
                    reproducción empieza en la posición actual de la secuencia. Cargar una secuencia existente usando el método 
                    <code>setSequence</code>, descrito arriba, inicializa la posición actual del secuenciador al principio de la 
                    secuencia. El método <code>stop</code> para el secuenciador, pero no rebobina automáticamente la 
                    <code>Sequence</code> actual. Iniciar una <code>Sequence</code> detenida sin restablecer la posición simplemente 
                    reanuda la reproducción de la secuencia desde la posición actual. En este caso, el método <code>stop</code> ha 
                    servidor como una operación de páusa. Sin embargo, hay varios métodos de <code>Sequencer</code> para establecer 
                    la posición actual de la secuencia en un valor arbitrario antes de que la reproducción se inicie. (Describiremos 
                    estos métodos más abajo).
                </p>
                <p>
                    Como se mencionó ante, un <code>Sequencer</code> por lo general tiene uno o más objetos 
                    <code>Transmitter</code>, a traves de los cuales manda <code>MidiMessages</code> a un <code>Receiver</code>.Es a 
                    través de estos <code>Transmitters</code> que un <code>Sequencer</code> reproduce la <code>Sequence</code>, 
                    emitiendo <code>MidiMessages</code> con el tiempo apropiado que corresponden a los <code>MidiEvents</code> 
                    contenidos en la <code>Sequence</code> actual. Por lo tanto, parte del procedimiento de configuración para 
                    reproducir una <code>Sequence</code> es invocar al método <code>setReceiver</code> en el objeto 
                    <code>Transmitter</code> del <code>Sequencer</code>, en efecto, conectando su salida al dispositivo que hará 
                    uso de los datos reproducios. Para más detalles sobre los <code>Transmitters</code> y <code>Receivers</code>, 
                    consulte <a class="TutorialLink" target="_top" href="MIDI-messages.html">Transmitiendo y Recibiendo Mensajes 
                        MIDI</a>.
                </p>
                <p><a id="124654"></a></p>
                <h2>
                    Grabar y Salvar Secuencias
                </h2>

                <p>
                    Para capturar datos MIDI a una <code>Sequence</code>, y posteriormente a un archivo, necesita realizar algunso 
                    pasos adicionales más allá de los descritos arriba. El siguiente esquema muestra los pasos necesarios para 
                    configurar la grabación en <code>Track</code> en una <code>Sequence</code>:
                </p>
                <ol>
                    <li>
                        Use <code>MidiSystem.getSequencer</code> para obtener un nuevo secuenciador que usar para grabación, como 
                        arriba.
                    </li>
                    <li>
                        Configure el "cableado" de las conexiones MIDI. El objeto que está transmitiendo los datos MIDI para ser 
                        grabados debe ser configurado, a través de su método <code>setReceiver</code>, para enviar datos a un 
                        <code>Receiver</code> asociado con la grabación <code>Sequencer</code>.
                    </li>
                    <li>
                        Cree un nuevo objeto <code>Sequence</code>, que almacenará los datos grabados. Cuando cree el objeto 
                        <code>Sequence</code>, debe especificar la información de tiempo principal para la secuencia. Por ejemplo:
                        <div class="codeblock">
                            <pre>
      Sequence mySeq;
      try{
          mySeq = new Sequence(Sequence.PPQ, 10);
      } catch (Exception ex) { 
          ex.printStackTrace(); 
      }
                            </pre>
                        </div>
                        El constructor para <code>Sequence</code> toma como argumentos una <code>divisionType</code> y una 
                        resolución de tiempo. El argumento <code>divisionType</code> especifica las unidades del argumento de 
                        resolución. En este caso, hemos especificado que la resolución de tiempo de la <code>Sequence</code> que 
                        estamos creando será de 10 pulso por negra. Un argumento opcional adicional al constructor de 
                        <code>Sequence</code> es el argumento del número de pistas, que causaría que la secuencia inicial empieze con 
                        el número especificado de (inicialmente vacío) <code>Tracks</code>. De lo contrario, la 
                        <code>Sequence</code> se creará sin <code>Tracks</code> iniciales; se pueden agregar más tarde según sea 
                        necesario.
                    </li>
                    <li>
                        Cree una <code>Track</code> vacía en la <code>Sequence</code>, con <code>Sequence.createTrack</code>.
                        Este paso no es necesario si la <code>Sequence</code> fue creada con <code>Tracks</code> iniciales.
                    </li>
                    <li>
                        Usando <code>Sequencer.setSequence</code>, seleccione nuestra nueva <code>Sequence</code> que recibe la 
                        grabación. El método <code>setSequence</code> une una <code>Sequence</code> existente con el 
                        <code>Sequencer</code>, que es algo análogo a cargar una cinta en una grabadora.
                    </li>
                    <li>
                        Invoque <code>Sequencer.recordEnable</code> para cada <code>Track</code> que se va a grabar. Si es 
                        necesario, obtenga una referencia a las <code>Tracks</code> disponibles en la <code>Sequence</code> 
                        invocando <code>Sequence.getTracks</code>.
                    </li>
                    <li>Invoque <code>startRecording</code> en el <code>Sequencer</code>.</li>
                    <li>
                        Cuando se haya hecho la grabación, invoque <code>Sequencer.stop</code> o 
                        <code>Sequencer.stopRecording</code>.
                    </li>
                    <li>
                        Salve la <code>Sequence</code> grabada a un archivo MIDI con <code>MidiSystem.write</code>. El método 
                        <code>write</code> de <code>MidiSystem</code> toma una <code>Sequence</code> como uno de sus argumentos,
                        Y escribirá esa <code>Sequence</code> a un flujo o archivo.
                    </li>
                </ol>
                <p><a id="124674"></a></p>
                <h2>
                    Editar una Secuencia
                </h2>
                <p>
                    Muchos programas de aplicación permiten que se cree una secuencia cargándola desde un archivo, y algunos también 
                    permiten crear una secuencia capturándola desde una entrada MIDI en vivo (es decir, grabación). Algunos 
                    programas, sin embargo, necesitarán crear secuencias MIDI desde cero, ya sea de forma programada o en resputa a
                    la entrada de usuario. Los programas secuenciadores con todas las funciones permiten al usuario construir 
                    manualmente nuevas secuencias, así como editar las existentes.
                </p>
                <p>
                    Estas operaciones de edición de datos se logran en la IPA de Sonido de Java no por métodos de 
                    <code>Sequencer</code>, si no por métodos de los propios objetos de datos: <code>Sequence</code>, 
                    <code>Track</code>, y <code>MidiEvent</code>. Puede crear una secuencia vacía usando uno de los constructores 
                    de <code>Sequence</code>, y después agregar pistas a esta invocando el siguiente método de 
                    <code>Sequence</code>:
                </p>
                <div class="codeblock">
                    <pre>
    Track createTrack() 
                    </pre>
                </div>
                <p>
                    Si su programa permite al usuario editar secuencias, necesitará este método de <code>Sequence</code> para 
                    eliminar pistas:
                </p>
                <div class="codeblock">
                    <pre>
    boolean deleteTrack(Track track) 
                    </pre>
                </div>
                <p>
                    Una vez que la secuencia contiene pistas, puede modificar el contenido de las pistas invocando métodos de la 
                    clase <code>Track</code>. Los <code>MidiEvents</code> contenidos en <code>Track</code> se almacenan como un 
                    <code>java.util.Vector</code> en el objeto <code>Track</code> y <code>Track</code> proporciona un conjunto de 
                    métodos para acceder, agregar y eliminar los eventos de la lista. Los métodos <code>add</code> y 
                    <code>remove</code> se explican por sí mismos, agregando o quitando un <code>MidiEvent</code> especificado de 
                    una <code>Track</code>. Se proporciona un método <code>get</code>, que toma un índice en la lista de eventos de 
                    <code>Track</code> y devuelve el <code>MidiEvent</code> almacenado allí. Además, existen métodos 
                    <code>size</code> y <code>tick</code>, que devuelven respectivamente el número de <code>MidiEvents</code> en la 
                    pista y la duración de la pista, expresada como un número total de <code>Ticks</code>.
                </p>
                <p>
                    Para crear un nuevo evento antes de agregarlos a la pista, por supuesto usará el constructor de 
                    <code>MidiEvent</code>. Para especificar o modificar el mensaje MIDI embebido en el evento, puede invocar el 
                    método <code>setMessage</code> de la subclase <code>MidiMessage</code> apropiada  (<code>ShortMessage</code>,
                    <code>SysexMessage</code>, o <code>MetaMessage</code>). Para modificar el momento en el que el evento debe 
                    ocurrir, invoque <code>MidiEvent.setTick</code>.
                </p>
                <p>
                    En combinación, estos métodos de bajo nivel proporcionan lo básico para la funcionalidad de edición necesitada 
                    por un progrma de secuenciador con todas las funciones.
                </p>
                <p></p>
            </div>
            <div class="NavBit">
                <a target="_top" href="MIDI-seq-intro.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="./TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="MIDI-seq-adv.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            "Los Tutoriales de Java" está sujeto a estos <a href="../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Introducción a los Secuenciadores<br />
            <b>Página siguiente:</b> Usando Características Avanzadas del Secuenciador
        </div>
    </body>
</html> 
