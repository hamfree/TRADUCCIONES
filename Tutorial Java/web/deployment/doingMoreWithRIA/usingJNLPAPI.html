<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />        
        <title>
            Accediendo al Cliente Usando la IPA de JNLP (Los Tutoriales de Java&trade; &gt; Implantación &gt; Haciendo Más con 
            Aplicaciones Java Ricas de Internet)
        </title>
        <meta name="description"
              content="Este tutorial de implantación de Java describe el desarrollo e implantación de appplets, aplicaciones Java
              Web Star, aplicaciones ricas de Internet, y herramientas JAR relacionadas" />
        <meta name="keywords"
              content="java programming, learn java, java sample code, java applet, java web start, rich internet application,
              RIA, jar, plugin, plug-in" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Haciendo Más con Aplicaciones Java Ricas de Internet</a></div>
                <div class="linkAHEAD"><a href="settingArgsProperties.html">Fijando Argumentos Confiables y Propiedades Seguras</a></div>
                <div class="linkBHEAD"><a href="properties.html">Propiedades del Sistema</a></div>
                <div class="linkAHEAD"><a href="jnlpAPI.html">IPA JNLP</a></div>
                <div class="nolinkBHEAD">Accediendo al Cliente Usando la IPA de JNLP</div>
                <div class="linkAHEAD"><a href="cookies.html">Cookies</a></div>
                <div class="linkBHEAD"><a href="accessingCookies.html">Accediendo a las Cookies</a></div>
                <div class="linkAHEAD"><a href="customizeRIALoadingExperience.html">Personalizando la Experiencia de Carga</a></div>
                <div class="linkAHEAD"><a href="security.html">La Seguridad en Aplicaciones Ricas de Internet</a></div>
                <div class="linkAHEAD"><a href="devGuidelines.html">Directrices para Asegurar Aplicaciones Ricas de Internet</a></div>
                <div class="linkQUESTIONS"><a href="QandE/questions.html">Preguntas y Ejercicios</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Implantación<br />
                <b>Lección:</b> Haciendo Más con Aplicaciones Java Ricas de Internet<br />
                <b>Sección:</b> JNLP IPA
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Implantación</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Haciendo Más con Aplicaciones Java Ricas de Internet</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="jnlpAPI.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="cookies.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Accediendo al Cliente Usando la IPA de JNLP</h1>
            </div>
            <div id="PageContent">
                <p>
                    Cuando son lanzadas usando el Protocolo de Lanzamiento en Red de Java (JNLP), las aplicaciones ricas de
                    Internet (RIAs) pueden acceder al cliente con el permiso del usuario. Considere el ejemplo del applet del
                    Editor de Texto para entender cómo usar los servicios basados en la IPA de JNLP. El Editor de Texto tiene un
                    área de texto y botones etiquetados Abrir, Salvar, Y Salvar Como. El Editor de Texto puede ser usado para
                    abrir un fichero de texto existente, editarlo, y salvarlo de vuelta al disco.
                </p>
                <p>
                    El applet del Editor de Texto es mostrado a continuación.
                </p>
                <script src="https://www.java.com/js/deployJava.js" >
                </script>
                <script >
                    //<![CDATA[
                    var attributes = {code: 'TextEditorApplet.class',
                        archive: 'examples/dist/applet_JNLP_API/applet_JNLP_API.jar',
                        width: 500, height: 300};
                    var parameters = {jnlp_href: 'examples/dist/applet_JNLP_API/texteditor_applet.jnlp'};
                    deployJava.runApplet(attributes, parameters, '1.6');
                    //]]>
                </script>
                <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
                <div class="note">
                    <hr /><strong>Nota:</strong> &nbsp;Si no ve el applet ejecutándose, necesita instalar al menos la versión
                    <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java SE Development Kit (KDJ) 6
                        update 10</a>.
                    <hr />
                </div>
                <div class="note">
                    <hr /><strong>Nota:</strong> &nbsp;Si no ve el ejemplo ejecutándose, es posible que necesite habilitar el
                    intérprete de JavaScript en su navegador de forma que el script de las Herramientas de Despliegue pueda
                    funcionar adecuadamente.
                    <hr />
                </div>
                <p>
                    Las clases
                    <a class="SourceLink" target="_blank"
                       href="examples/applet_JNLP_API/src/TextEditor.java"
                       onclick="showCode('../../displayCode.html', 'examples/applet_JNLP_API/src/TextEditor.java'); return false;">
                        <code>TextEditor</code></a> y
                    <a class="SourceLink" target="_blank"
                       href="examples/applet_JNLP_API/src/TextEditor.java"
                       onclick="showCode('../../displayCode.html', 'examples/applet_JNLP_API/src/TextEditor.java'); return false;">
                        <code>TextEditorApplet</code></a> diseñan la interfaz de usuario y la muestran como un applet. La clase
                    <a class="SourceLink" target="_blank" href="examples/applet_JNLP_API/src/FileHandler.java" 
                       onclick="showCode('../../displayCode.html', 'examples/applet_JNLP_API/src/FileHandler.java'); return false;">
                        <code>FileHandler</code></a> contiene la funcionalidad principal con respecto al uso de la IPA de JNLP
                    basada en servicios.
                </p>
                <p>
                    Recuerde, las técnicas descritas en este tema se aplican también a las aplicaciones Java Web Start.
                </p>
                <p>
                    Para hacer uso de un servicio JNLP, recupere primero una referencia al servicio. El método
                    <code>initialize</code> de la clase <code>FileHandler</code> recupera referencias a los servicios JNLP como es
                    mostrado en el trozo siguiente de código:
                </p>
                <div class="codeblock">
                    <pre>
private static synchronized void initialize() {
    ...
    try {
        <b>fos = (FileOpenService)
            ServiceManager.lookup("javax.jnlp.FileOpenService");
        fss = (FileSaveService)
            ServiceManager.lookup("javax.jnlp.FileSaveService");</b>
    } catch (UnavailableServiceException e) {
        ...
    }
}
                    </pre>
                </div>
                <p>
                    Después de que tenga una referencia a los servicios requeridos, invoque los métodos del servicio para realizar
                    las operaciones necesarias. El método <code>open</code> de la clase <code>FileHandler</code> invoca el método
                    <code>openFileDialog</code> de la clase
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/jre/api/javaws/jnlp/javax/jnlp/FileOpenService.html">
                        <code>FileOpenService</code></a> para visualizar un selector de ficheros. El método <code>open</code>
                    devuelve los contenidos del fichero seleccionado.
                </p>
                <div class="codeblock">
                    <pre>
public static String open() {
    initialize();
    try {
        <b>fc = fos.openFileDialog(null, null);</b>
        return readFromFile(fc);
    } catch (IOException ioe) {
        ioe.printStackTrace(System.out);
        return null;
    }
}
                    </pre>
                </div>
                <p>
                    Del mismo modo, los métodos <code>save</code> y <code>saveAs</code> de la clase <code>FileHandler</code>
                    invocan los métodos correspondientes de la clase
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/jre/api/javaws/jnlp/javax/jnlp/FileSaveService.html">
                        <code>FileSaveService</code></a> para habilitar al usuario a seleccionar el nombre de fichero y salvar los
                    contenidos del área de texto al disco.
                </p>
                <div class="codeblock">
                    <pre>
public static void saveAs(String txt) {
    initialize();
    try {
        if (fc == null) {
            // Si aun no se salvó.
            // Salvar-como es como salvar
            save(txt);
        } else {
            <b>fc = fss.saveAsFileDialog(null, null,
                                         fc);</b>
            save(txt);
        }
    } catch (IOException ioe) {
        ioe.printStackTrace(System.out);
    }
}
                    </pre>
                </div>
                <p>
                    En ejecución, cuando la RIA intenta abrir o salvar un fichero, los usuarios verán un diálogo de seguridad
                    preguntándoles si quieren permitir la acción. La operación continuará solo si los usuarios permiten que la RIA
                    acceda a su entorno.
                </p>
                <p>
                    Los fuentes completos de la clase
                    <a class="SourceLink" target="_blank" href="examples/applet_JNLP_API/src/FileHandler.java"
                       onclick="showCode('../../displayCode.html', 'examples/applet_JNLP_API/src/FileHandler.java'); return false;">
                        <code>FileHandler</code></a> son mostrados a continuación.
                </p>
                <div class="codeblock">
                    <pre>

// agregue javaws.jar al classpath durante la compilación
import javax.jnlp.FileOpenService;
import javax.jnlp.FileSaveService;
import javax.jnlp.FileContents;
import javax.jnlp.ServiceManager;
import javax.jnlp.UnavailableServiceException;
import java.io.*;

public class FileHandler {

    static private FileOpenService fos = null;
    static private FileSaveService fss = null;
    static private FileContents fc = null;

    // recupera una referencia a los servicios JNLP
    private static synchronized void initialize() {
        if (fss != null) {
            return;
        }
        try {
            fos = (FileOpenService) ServiceManager.lookup(&quot;javax.jnlp.FileOpenService&quot;);
            fss = (FileSaveService) ServiceManager.lookup(&quot;javax.jnlp.FileSaveService&quot;);
        } catch (UnavailableServiceException e) {
            fos = null;
            fss = null;
        }
    }

    // visualiza el diálogo de abrir fichero y lee el fichero seleccionado usando FileOpenService
    public static String open() {
        initialize();
        try {
            fc = fos.openFileDialog(null, null);
            return readFromFile(fc);
        } catch (IOException ioe) {
            ioe.printStackTrace(System.out);
            return null;
        }
    }

    // visualiza saveFileDialog y salva el fichero usando FileSaveService
    public static void save(String txt) {
        initialize();
        try {
            // Muestra el dialogo de Salvar si no se ha dado aún un nombre
            if (fc == null) {
                fc = fss.saveFileDialog(null, null,
                        new ByteArrayInputStream(txt.getBytes()), null);
                // fichero salvado, hecho
                return;
            }
            // use esto sólo cuando el nombre del fichero es conocido
            if (fc != null) {
                writeToFile(txt, fc);
            }
        } catch (IOException ioe) {
            ioe.printStackTrace(System.out);
        }
    }

    // visualiza saveAsFileDialog y salva el fichero usando FileSaveService
    public static void saveAs(String txt) {
        initialize();
        try {
            if (fc == null) {
                // Si no se ha salvado aún. Salvar-como es como salvar
                save(txt);
            } else {
                fc = fss.saveAsFileDialog(null, null, fc);
                save(txt);
            }
        } catch (IOException ioe) {
            ioe.printStackTrace(System.out);
        }
    }

    private static void writeToFile(String txt, FileContents fc) throws IOException {
        int sizeNeeded = txt.length() * 2;
        if (sizeNeeded &gt; fc.getMaxLength()) {
            fc.setMaxLength(sizeNeeded);
        }
        BufferedWriter os = new BufferedWriter(new OutputStreamWriter(fc.getOutputStream(true)));
        os.write(txt);
        os.close();
    }

    private static String readFromFile(FileContents fc) throws IOException {
        if (fc == null) {
            return null;
        }
        BufferedReader br = new BufferedReader(new InputStreamReader(fc.getInputStream()));
        StringBuffer sb = new StringBuffer((int) fc.getLength());
        String line = br.readLine();
        while (line != null) {
            sb.append(line);
            sb.append(&quot;\n&quot;);
            line = br.readLine();
        }
        br.close();
        return sb.toString();
    }
}
                    </pre>
                </div>
                <div class="note">
                    <hr /><strong>Nota:</strong>&nbsp;Para compilar el código Java que tiene una referencia a las clases en el
                    paquete <code>javax.jnlp</code>, incluya <code>&lt;su ruta al KDJ&gt;/jre/lib/javaws.jar</code> en su
                    classpath. En ejecución, el software del Entorno de Ejecución de Java automáticamente hace que estas clases
                    estén disponibles para las RIAs.
                    <hr />
                </div>
                <p>
                    <a class="TutorialLink" target="_top" href="examplesIndex.html#AppletJNLPAPI">Descargue el código fuente</a>
                    para el ejemplo <em>Applet del Editor de Texto</em> para experimentar más.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="jnlpAPI.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="cookies.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos
                            <a href="../../information/cpyr.html">avisos legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs</a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias?
                            <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> IPA JNLP<br />
            <b>Página siguiente:</b> Cookies
        </div>
    </body>
</html> 
