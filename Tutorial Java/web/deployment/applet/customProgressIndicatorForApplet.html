<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />        
        <title>
            Visualizando un Indicador de Progreso de Carga Personalizado (Los Tutoriales de Java&trade; &gt; Implantación &gt; 
            Applets de Java)
        </title>
        <meta name="description"
              content="Este tutorial de implantación de Java describe el desarrollo e implantación de appplets, aplicaciones Java
              Web Star, aplicaciones ricas de Internet, y herramientas JAR relacionadas" />
        <meta name="keywords"
              content="java programming, learn java, java sample code, java applet, java web start, rich internet application,
              RIA, jar, plugin, plug-in" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Applets de Java</a></div>
                <div class="linkAHEAD"><a href="getStarted.html">Empezando Con los Applets</a></div>
                <div class="linkBHEAD"><a href="subclass.html">Definiendo una Subclase de un Applet</a></div>
                <div class="linkBHEAD"><a href="appletMethods.html">Métodos para las Etapas</a></div>
                <div class="linkBHEAD"><a href="lifeCycle.html">Ciclo de Vida de un Applet</a></div>
                <div class="linkBHEAD"><a href="appletExecutionEnv.html">Entorno de Ejecución de un Applet</a></div>
                <div class="linkBHEAD"><a href="developingApplet.html">Desarrollando un Applet</a></div>
                <div class="linkBHEAD"><a href="deployingApplet.html">Implantando un Applet</a></div>
                <div class="linkCHEAD"><a href="html.html">Implantando Con la Etiqueta Applet</a></div>
                <div class="linkAHEAD"><a href="doingMoreWithApplets.html">Haciendo Más Con Applets</a></div>
                <div class="linkBHEAD"><a href="data.html">Buscando y Cargando Ficheros de Datos</a></div>
                <div class="linkBHEAD"><a href="param.html">Definiendo y Usando Parámetros del Applet</a></div>
                <div class="linkBHEAD"><a href="showStatus.html">Visualizando Pequeñas Cadenas de Estado</a></div>
                <div class="linkBHEAD"><a href="browser.html">Visualizando Documentos en el Navegador</a></div>
                <div class="linkBHEAD"><a href="invokingJavaScriptFromApplet.html">Invocando Código JavaScript Desde un Applet</a></div>
                <div class="linkBHEAD"><a href="invokingAppletMethodsFromJavaScript.html">Invocando Métodos del Applet Desde Código JavaScript</a></div>
                <div class="linkBHEAD"><a href="appletStatus.html">Gestionando el Estado de la Inicialización Con Manejadores de Eventos</a></div>
                <div class="linkBHEAD"><a href="manipulatingDOMFromApplet.html">Manipulando el DOM de la Página Web del Applet</a></div>
                <div class="nolinkBHEAD">Visualizando un Indicador de Progreso de Carga Personalizado</div>
                <div class="linkBHEAD"><a href="stdout.html">Escribiendo Diágnosticos a los Flujos de la Salida Estándar y Error</a></div>
                <div class="linkBHEAD"><a href="draggableApplet.html">Desarrollando Applets Arrastrables</a></div>
                <div class="linkBHEAD"><a href="iac.html">Comunicando Con Otros Applets</a></div>
                <div class="linkBHEAD"><a href="server.html">Trabajando Con Aplicación del Lado del Servidor</a></div>
                <div class="linkCHEAD"><a href="clientExample.html">Ejemplo de Applet de Cliente de Red</a></div>
                <div class="linkBHEAD"><a href="security.html">Qué Pueden Hacer los Applets y Qué No</a></div>
                <div class="linkAHEAD"><a href="problemsindex.html">Resolviendo Problemas Comunes de los Applets</a></div>
                <div class="linkQUESTIONS"><a href="QandE/questions.html">Preguntas y Ejercicios</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Implantación<br />
                <b>Lección:</b> Applets de Java<br />
                <b>Sección:</b> Haciendo Más Con Applets
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Implantación</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Applets de Java</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="manipulatingDOMFromApplet.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="stdout.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Visualizando un Indicador de Progreso de Carga Personalizado</h1>
            </div>
            <div id="PageContent">
                <p>
                    Un applet de Java puede visualizar un indicador de progreso de carga personalizado que muestr el progreso de la
                    descarga de los recursos del applet así como otros datos específicos del applet.
                </p>
                <p>
                    Conisere el applet Weather y la clase <code>CustomProgress</code> para entender cómo implementar un indicador
                    de progreso de carga personalizado para un applet de Java. Con el fin de demostrar una gran y prolongada
                    descarga, el archivo JAR de este applet ha sido inflado artificialmente y el fichero
                    <code>customprogress_applet.jnlp</code> especifica ficheros JAR adicionales como recursos.
                </p>
                <h2>
                    Desarrollar un Indicador de Progreso de Carga Personalizado
                </h2>
                <p>
                    Para desarrollar un indicador de progreso de carga personalizado para su applet, cree una clase que implemente
                    el interfaz
                    <a class="APILink" target="_blank"
                       href="https://docs.oracle.com/javase/8/docs/jre/api/javaws/jnlp/javax/jnlp/DownloadServiceListener.html">
                        <code>DownloadServiceListener</code></a>.
                </p>
                <p>
                    El constructor de la clase del indicador de progreso de carga variará dependiendo de cómo se debe mostrar la
                    interfaz de usuario y las capacidades que necesita la clase. Se deben aplicar las siguientes pautas:
                </p>
                <ul>
                    <li>
                        Para visualizar el indicador de progreso de carga en una ventana de nivel superior separada, cree un
                        constructor que no tenga ningún parametro.
                    </li>
                    <li>
                        Para visualizar el indicador de progreso de carga de un applet en el contenedor del applet, cree un
                        constructor que toma un <code>Object</code> como parámetro. El argumento <code>Object</code> puede ser
                        cambiado de tipo a una instancia de la clase
                        <a class="APILink" target="_blank"
                           href="https://docs.oracle.com/javase/8/docs/api/java/awt/Container.html">
                            <code>java.awt.Container</code></a>.
                    </li>
                    <li>
                        Si la clase del indicador de progreso de carga necesita acceder a los parámetros del apllet, cree dos
                        constructores como sigue:
                        <ul>
                            <li>
                                Cree un constructor que tome un <code>Object</code> como un parámetro como se describió
                                anteriormente.
                            </li>
                            <li>
                                Cree un constructor que tome dos parámetros del tipo <code>Object</code>- El primer argumento
                                puede ser cambiado de tipo a una instancia de la clase
                                <a class="APILink" target="_blank"
                                   href="https://docs.oracle.com/javase/8/docs/api/java/awt/Container.html">
                                    <code>java.awt.Container</code></a> y el segundo argumento puede ser cambiado de tipo a una
                                instancia de la clase
                                <a class="APILink" target="_blank"
                                   href="https://docs.oracle.com/javase/8/docs/api/java/applet/AppletStub.html">
                                    <code>java.applet.AppletStub</code></a>.
                            </li>
                        </ul>
                        <p>
                            El software del Complemento de Java invocará el constructor apropiado dependiendo de las capacidades
                            del software del EEJ de la máquina cliente.
                        </p>
                    </li>
                </ul>
                <div class="codeblock">
                    <pre>
import javax.jnlp.DownloadServiceListener;
import java.awt.Container;
import java.applet.AppletStub;
import netscape.javascript.*;

// ...

public class <b>CustomProgress implements DownloadServiceListener</b> {   
    Container surfaceContainer = null;
    AppletStub appletStub = null;
    JProgressBar progressBar = null;
    JLabel statusLabel = null;
    boolean uiCreated = false;

    <b>public CustomProgress(Object surface)</b> {
       init(surface, null);
    }

    <b>public CustomProgress(Object surface, Object stub)</b> {
        init(surface, stub);
    }

    public void init(Object surface, Object stub) {
        try {
            <b>surfaceContainer = (Container) surface;
            appletStub = (AppletStub) stub;</b>
        } catch (ClassCastException cce) {
            // ...
        }
    }
// ...
}    
                    </pre>
                </div>
                <p>
                    El trozo de código siguiente muestra cómo construir el interfaz de usuario para el indicador de progreso de
                    carga. Use la instancia de la clase
                    <a class="APILink" target="_blank"
                       href="https://docs.oracle.com/javase/8/docs/api/java/applet/AppletStub.html">
                        <code>java.applet.AppletStub</code></a> para recuperar los parámetros del applet. Invoque el método
                    <code>JSObject.getWindow(null)</code> para obtener una referencia a la página web padre del applet e invocar
                    código JavaScript en esa página.
                </p>
                <div class="codeblock">
                    <pre>
private void create() {
    JPanel top = createComponents();
    if (surfaceContainer != null) {
        // Dibujamos el interfaz de usuario del progreso de la carga en el
        // contenedor dado.
        surfaceContainer.add(top, BorderLayout.NORTH);
        surfaceContainer.invalidate();
        surfaceContainer.validate();
    }     
}
private JPanel createComponents() {
    JPanel top = new JPanel();
    // ...
    // obtenemos un parámetro del applet usando una instancia de la
    // clase AppletStub, el parámetro "tagLine" especificado
    // en el fichero JNLP del applet
    String tagLine = "";
    if (appletStub != null) {
        <b>tagLine = appletStub.getParameter("tagLine");</b>
    }
    String lblText = "&lt;html&gt;&lt;font color=red size=+2&gt;KDJ
        Documentation&lt;/font&gt;&lt;br/&gt;" +
        tagLine + " &lt;br/&gt;&lt;/html&gt;";
    JLabel lbl = new JLabel(lblText);
    top.add(lbl, BorderLayout.NORTH);

    // use el método JSObject.getWindow(null) para recuperar
    // una referencia a la página web y hacer llamadas
    // JavaScript. El logo de Duke será visualizado si la variable displayLogo
    // se establece a "true" en la página web
    String displayLogo = "false";    
    <b>JSObject window = JSObject.getWindow(null);        
    if (window != null) {
        displayLogo = (String)window.getMember("displayLogo");
    }</b>
    if (displayLogo.equals("true")) {
        lbl = new JLabel();
        ImageIcon logo = createImageIcon("images/DukeWave.gif", "logo");
        lbl.setIcon(logo);
        top.add(lbl, BorderLayout.EAST);
    }

    statusLabel = new JLabel(
        "html&gt;&lt;font color=green size=-2&gt;" +
        "Cargando el applet...&lt;/font&gt;&lt;/html&gt;");
    top.add(statusLabel, BorderLayout.CENTER);

    // la barra de progreso muestra el progreso
    <b>progressBar = new JProgressBar(0, 100);</b>
    progressBar.setValue(0);
    progressBar.setStringPainted(true);
    top.add(progressBar, BorderLayout.SOUTH);

    return top;
}
                    </pre>
                </div>
                <p>
                    Cree y actualize el indicador de progreso en los siguientes métodos basados en el argumento 
                    <code>overallPercent</code>.
                    Estos métodos son invocados regularmente por el software del Complemento de Java para comunicar el progreso
                    de la descarga del applet. El software del Complemento de Java siempre enviará un mensaje cuando la descarga
                    y validación de los recursos esté completa al 100%.
                </p>
                <div class="codeblock">
                    <pre>
public void <b>progress</b>(URL url, String version,
                     long readSoFar, long total,
                     int overallPercent) {        
    // compruebe el progreso de la descarga y actualiza la pantalla
    updateProgressUI(overallPercent);
}

public void <b>upgradingArchive</b>(java.net.URL url,
                  java.lang.String version,
                  int patchPercent,
                  int overallPercent) {
    updateProgressUI(overallPercent);
}

public void <b>validating</b>(java.net.URL url,
            java.lang.String version,
            long entry,
            long total,
            int overallPercent) {
    updateProgressUI(overallPercent);
}

private void <b>updateProgressUI</b>(int overallPercent) {
    if (!uiCreated &amp;&amp; overallPercent > 0
        &amp;&amp; overallPercent &lt; 100) {
        // crea el interfaz de usuario del
        // indicador de progreso personalizado
        // sólo si hay más trabajo que hacer,
        // dando a entender que si overallPercent &gt; 0
        // y &lt; 100 se previene el parpadeo cuando
        // la aplicación es cargada desde caché
        create(); 
        uiCreated = true;            
    }
    if (uiCreated) {
        progressBar.setValue(overallPercent);
    }
}
                    </pre>
                </div>
                <p>
                    Compile la clase del indicador de progreso de carga y construya un fichero JAR con todos los recursos
                    necesitados para visualizar el indicador de progreso de carga. Incluya los siguientes ficheros JAR en su
                    <code>classpath</code> para habilitar la compilación:
                </p>
                <ul>
                    <li>
                        <code>&lt;su directorio EEJ&gt;/lib/javaws.jar</code>
                    </li>
                    <li>
                        <code>&lt;su directorio EEJ&gt;/lib/plugin.jar</code> &ndash; Este fichero JAR es requerido sólo si su
                        clase del indicador de progreso de carga usa el método <code>JSObject.getWindow</code> para invocar código
                        de JavaScript en la página web padre del applet.
                    </li>
                </ul>
                <p>
                    La clase del indicador de progreso de carga está ahora lista para su uso. El paso siguiente es especificar el
                    fichero JAR del indicador de progreso de carga como su indicador de progreso de carga de su applet.
                </p>
                <h2>
                    Especificar un Indicador de Progreso de Carga para un Applet
                </h2>
                <p>
                    Para especificar un indicador de progreso de carga personalizado para un un applet, incluya la información
                    siguiente en el fichero JNLP del applet:
                </p>
                <ul>
                    <li>
                        etiqueta <code>jar</code> con el atributo <code>download=&quot;progress&quot;</code>
                    </li>
                    <li>
                        atributo <code>progress-class</code> con el nombre completamente cualificado de la clase del progreso de
                        carga.
                    </li>
                </ul>
                <p>
                    El trozo de código siguiente del fichero
                    <a class="SourceLink" target="_blank"
                       href="examples/applet_AppletWithCustomProgressIndicator/src/customprogress_applet.jnlp"
                       onclick="showCode('../../displayCode.html', 
                                   'examples/applet_AppletWithCustomProgressIndicator/src/customprogress_applet.jnlp');
                           return false;">
                        <code>customprogress_applet.jnlp</code></a> muestra el uso de los atributos
                    <code>download=&quot;progress&quot;</code> and <code>progress-class</code>.
                </p>
                <div class="codeblock">
                    <pre>
&lt;jnlp spec=&quot;1.0+&quot;
  codebase=&quot;https://docs.oracle.com/javase/tutorial/deployment&quot;
  href=&quot;&quot;&gt;
  &lt;!-- ... --&gt;
  &lt;resources&gt;
    &lt;!-- ... --&gt;
    &lt;jar
      href=&quot;applet/examples/dist/applet_AppletWithCustomProgressIndicator&quot;
      main=&quot;true&quot; /&gt;    
    &lt;jar
      href=&quot;applet/examples/dist/applet_CustomProgressIndicator/applet_CustomProgressIndicator.jar&quot; 
     <b>download=&quot;progress&quot;</b> /&gt;
  &lt;/resources&gt;
  &lt;applet-desc
     name=&quot;customprogressindicatordemo.WeatherApplet&quot;
     main-class=&quot;customprogressindicatordemo.WeatherApplet&quot;
     <b>progress-class</b>=&quot;customprogressindicator.CustomProgress&quot;
     width=&quot;600&quot;
     height=&quot;200&quot;&gt;
     &lt;param
       name=&quot;tagLine&quot;
       value=&quot;Information straight from the horse's mouth!&quot;/&gt;
  &lt;/applet-desc&gt;
&lt;!-- ... --&gt;
&lt;/jnlp&gt;
                    </pre>
                </div>
                <p>
                    Despliegue el applet en una página web. Abra
                    <a class="SourceLink" target="_blank"
                       href="examples/dist/applet_AppletWithCustomProgressIndicator/AppletPage.html"
                       onclick="showCode('../../displayCode.html',
                           'examples/dist/applet_AppletWithCustomProgressIndicator/AppletPage.html'); return false;">
                        <code>AppletPage.html</code></a> en un navegador web para ver el indicador de progreso de carga del applet
                    Weather.
                </p>
                <div class="note">
                    <hr />
                    <strong>Nota:</strong> &nbsp;Si no ve el applet ejecutarse, necesita instalar al menos la versión
                    <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">Java SE Development Kit (KDJ) 6
                        update 21</a>.
                    <hr />
                </div>
                <div class="note">
                    <hr />
                    <strong>Nota:</strong>&nbsp;Si ha visto este applet antes, borre su caché usando el Panel de Control de Java
                    antes de ver el applet de nuevo. No será capaz de ver un indicador de progreso para un applet previamente
                    cacheado.
                    <hr />
                </div>
                <div class="note">
                    <hr />
                    <strong>Nota:</strong> &nbsp;Si no ve el ejemplo ejecutándose, podría necesitar habilitar el intérprete de
                    JavaScript en su navegador de forma que el script de las Herramientas de Despliegue pueda funcionar
                    adecuadamente.
                    <hr />
                </div>
                <h2>
                    <a id="integratedpi"></a>Integra el Indicador de Progreso de Carga Con el IU del Applet
                </h2>
                <p>
                    Puede también integra el indicador de progreso de carga en el IU del applet. Abra
                    <a class="SourceLink" target="_blank" 
                       href="examples/dist/applet_AppletWithIntegratedProgressIndicator/AppletPage.html"
                       onclick="showCode('../../displayCode.html',
                           'examples/dist/applet_AppletWithIntegratedProgressIndicator/AppletPage.html'); return false;">
                        <code>AppletPage.html</code></a> en un navegador web para ver el indicador de progreso de carga integrado
                    en la IU del applet Weather. Vea la clase
                    <a class="SourceLink" target="_blank"
                       href="examples/applet_AppletWithIntegratedProgressIndicator/src/integratedprogressdemo/IntegratedProgressIndicator.java"
                       onclick="showCode('../../displayCode.html', 
                           'examples/applet_AppletWithIntegratedProgressIndicator/src/integratedprogressdemo/IntegratedProgressIndicator.java');
                            return false;">
                        <code>IntegratedProgressIndicator.java</code></a> y los comentarios en línea para más información.
                </p>
                <p>
                    Descargue el código fuente para los ejemplos siguientes para experimentar más:
                </p>
                <ul>
                    <li>
                        <a class="TutorialLink" target="_top"
                           href="examplesIndex.html#AppletWithCustomProgressIndicator">
                            <em>Applet Con un Indicador de Progreso de Carga Personalizado</em></a>
                    </li>
                    <li>
                        <a class="TutorialLink" target="_top"
                           href="examplesIndex.html#AppletWithIntegratedProgressIndicator">
                            <em>Applet Con un Indicador de Progreso Integrado</em></a>
                    </li>
                </ul>
                <p>
                    Vea el tema
                    <a class="TutorialLink" target="_top"
                       href="../doingMoreWithRIA/customizeRIALoadingExperience.html">Personalizando la Experiencia de Carga</a> para
                    obtener más información sobre la personalización de la experiencia de carga de las aplicaciónes ricas de
                    Internet (RIA, en inglés).
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="manipulatingDOMFromApplet.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="stdout.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos
                            <a href="../../information/cpyr.html">avisos legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs</a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias?
                            <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Manipulating DOM of Applet's Web Page<br />
            <b>Página siguiente:</b> Writing Diagnostics to Standard Output and Error Streams
        </div>
    </body>
</html> 
