<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Bloqueos Intrínsecos y Sincronización (Los Tutoriales de Java&trade; &gt; Clases Esenciales &gt; Concurrencia)
        </title>
        <meta name="description" content="Este tutorial de Java describe las excepciones, la entrada/salida básica, concurrencia,
              expresiones regulares, y el entorno de la plataforma" />
        <meta name="keywords" content="java programming, learn java, java sample code, java exception, java input output, java
              threads, java regex, regular expressions, path, classpath, environment variable" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper  clearfix">       
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div> 
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div> 
                        </div> 
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Concurrencia</a></div>
                <div class="linkAHEAD"><a href="procthread.html">Procesos e Hilos</a></div>
                <div class="linkAHEAD"><a href="threads.html">Objetos Hilo</a></div>
                <div class="linkBHEAD"><a href="runthread.html">Definiendo e Iniciando un Hilo</a></div>
                <div class="linkBHEAD"><a href="sleep.html">Pausando la Ejecución con Sleep</a></div>
                <div class="linkBHEAD"><a href="interrupt.html">Interrupciones</a></div>
                <div class="linkBHEAD"><a href="join.html">Uniones</a></div>
                <div class="linkBHEAD"><a href="simple.html">El Ejemplo SimpleThreads</a></div>
                <div class="linkAHEAD"><a href="sync.html">Sincronización</a></div>
                <div class="linkBHEAD"><a href="interfere.html">Interferencias entre Hilos</a></div>
                <div class="linkBHEAD"><a href="memconsist.html">Errores de Consistencia en Memoria</a></div>
                <div class="linkBHEAD"><a href="syncmeth.html">Métodos Sincronizados</a></div>
                <div class="nolinkBHEAD">Bloqueos Intrínsecos y Sincronización</div>
                <div class="linkBHEAD"><a href="atomic.html">Acceso Atómico</a></div>
                <div class="linkAHEAD"><a href="liveness.html">Tiempo de vida</a></div>
                <div class="linkBHEAD"><a href="deadlock.html">Bloqueo Mutuo</a></div>
                <div class="linkBHEAD"><a href="starvelive.html">Inanición y Livelock</a></div>
                <div class="linkAHEAD"><a href="guardmeth.html">Bloques Vigilados</a></div>
                <div class="linkAHEAD"><a href="immutable.html">Objetos Inmutables</a></div>
                <div class="linkBHEAD"><a href="syncrgb.html">Un Ejemplo de Clase Sincronizada</a></div>
                <div class="linkBHEAD"><a href="imstrat.html">Una Estrategia para Definir Objetos Inmutables</a></div>
                <div class="linkAHEAD"><a href="highlevel.html">Objetos con Alto Nivel de Concurrencia</a></div>
                <div class="linkBHEAD"><a href="newlocks.html">Objetos de Bloqueo</a></div>
                <div class="linkBHEAD"><a href="executors.html">Ejecutores</a></div>
                <div class="linkCHEAD"><a href="exinter.html">Interfaces del Ejecutor</a></div>
                <div class="linkCHEAD"><a href="pools.html">Agrupaciones de Hilos</a></div>
                <div class="linkCHEAD"><a href="forkjoin.html">Fork/Join</a></div>
                <div class="linkBHEAD"><a href="collections.html">Colecciones Concurrentes</a></div>
                <div class="linkBHEAD"><a href="atomicvars.html">Variables Atómicas</a></div>
                <div class="linkBHEAD"><a href="threadlocalrandom.html">Números Aleatorios Concurrentes</a></div>
                <div class="linkAHEAD"><a href="further.html">Lecturas Adicionales</a></div>
                <div class="linkQUESTIONS"><a href="QandE/questions.html">Preguntas y Ejercicios</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Clases Esenciales<br />
                <b>Lección:</b> Concurrencia<br />
                <b>Sección:</b> Sincronización
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Clases Esenciales</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Concurrencia</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="syncmeth.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="atomic.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Bloqueos Intrínsecos y Sincronización</h1>
            </div>
            <div id="PageContent">
                <p>
                    La sincronización es construída alrededor de una entidad interna conocida como el <i>bloqueo intrínseco</i> o
                    <i>bloqueo monitor</i>.
                    (La especificación del IPA a menudos se refiere a esta entidad siemplemente como un &quot;monitor.&quot;) Los
                    bloqueos intrínsecos juegan un rol en ambos aspectos de la sincronización:
                    in both aspects of synchronization: imponiendo el acceso exclusivo al estado de un objeto y estableciendo
                    relaciones suceden-antes que son esenciales para la visibilidad.
                </p>
                <p>
                    Cada objeto tiene un bloqueo intrínseco asociado con él. Por convención, un hilo que necesita acceso exclusivo y
                    consistente a los campos de un objeto tiene que <i>adquirir</i> el bloqueo intrínseco del objeto antes de
                    accederlos, y entonces <i>liberar</i> el bloque intrínseco cuando haya terminado con ellos. Se dice que Un hilo
                    <i>posee</i> el bloqueo intrínseco entre el tiempo que lo ha adquirido y lo ha liberado. Siempre y cuando un hilo
                    posea un bloqueo intrínseco, ningún otro hilo podrá adquirir el mismo bloqueo. El otro hilo se bloqueará cuando
                    intente adquirir el bloqueo.
                </p>
                <p>
                    Cuando un hilo libera un bloqueo intrínseco, una relación sucede-antes es establecida entre esa acción y
                    cualquier adquisición posterior del mismo bloqueo.
                </p>
                <h2>Bloqueos en Métodos Sincronizados</h2>
                <p>
                    Cuando un hilo invoca un método sincronizado, automáticamente adquiere el bloque intrínseco para el objeto del
                    método y lo libera cuando el método retorna. La liberación del bloqueo ocurre incluso si el retorno fue causado
                    por una excepción no capturada.
                </p>
                <p>
                    Podría preguntarse qué sucede cuando se invoca un método sincronizado estático, ya que un método estático está
                    asociado con una clase, no con un objeto. En este caso, el hilo adquiere el bloqueo intrínseco para el objeto
                    <code>Class</code> asociado con la clase. Así acceder a los campos estáticos de la clase es controlado por un
                    bloqueo que es distinto del bloqueo para cualquier instancia de la clase.
                </p>
                <h2>Sentencias Sincronizadas</h2>
                <p>
                    Otra forma de crear código sincronixado es con las <i>sentencias sincronizadas</i>. A diferencia de los métodos
                    sincronizados, las sentencias sincronizadas deben especificar el objeto que establece el bloque intrínseco:

                </p>
                <div class="codeblock">
                    <pre>
public void insertaNombre(String nombre) {
    synchronized(this) {
        apellidos = nombre;
        contadorNombres++;
    }
    listaNombres.add(nombre);
}
                    </pre>
                </div>
                <p>
                    En este ejemplo, el método <code>insertaNombre</code> necesita sincronizar los cambios a <code>apellidos</code>
                    y <code>contadorNombres</code>, pero también necesita evitar las invocaciones de sincronización de otros métodos
                    del objeto.
                    (Invocar otros métodos del objeto desde código sincronizado puede crear problemas que son descritos en la 
                    sección sobre <a href="liveness.html">Tiempo de Vida</a>.) Sin sentencias sincronizadas,
                    Without synchronized statements, tendría que haber un método separado, no sincronizado con el único propósito de
                    invocar <code>listaNombres.add</code>.
                </p>
                <p>
                    Las sentencias sincronizadas son también útiles para mejorar la concurrencia con sincronización de grano-fino. 
                    Suponga, por ejemplo que la clase <code>MsLunch</code> tiene dos campos de instancia, <code>c1</code> y
                    <code>c2</code>, que no son usados nunca juntos. Todas las actualizaciones de estos campos deben ser
                    sincronizadas, pero no hay razón para prevenir que una actualización de cq de ser solapada con una actualización
                    de c2 &mdash; y hacer eso reduce la concurrencia creando bloqueos innecesarios. En vez de usar métodos
                    sincronizados o usar el bloqueo asociado con <code>this</code>, Creamos dos objetos únicamente para proporcionar
                    bloqueos.
                </p>
                <div class="codeblock">
                    <pre>
public class MsLunch {
    private long c1 = 0;
    private long c2 = 0;
    private Object lock1 = new Object();
    private Object lock2 = new Object();

    public void inc1() {
        synchronized(lock1) {
            c1++;
        }
    }

    public void inc2() {
        synchronized(lock2) {
            c2++;
        }
    }
}
                    </pre>
                </div>
                <p>
                    Use este idioma con extremo cuidado. Debe estar absolutamente seguro de que es realmente seguro el acceso
                    solapado de los campos afectados.
                </p>
                <h2>Sincronización Reentrante</h2>
                <p>
                    Recuerde que un hilo no puede adquirir un bloqueo poseído por otro hilo. Pero un hilo <i>puede</i> adquirir un
                    bloqueo que ya posee. Permitir a un hilo adquirir el mismo bloqueo más de una vez habilita la
                    <i>sincronización reentrante</i>. Esta describe una situación donde el código sincronizado, directa o
                    indirectamente, invoca un método que también contiene código sincronizado, y ambos conjuntos de código usan el
                    mismo bloqueo. Sin la sincronización reentrante, el código sincronizado tendría que tomar muchas precauciones
                    adicionales para evitar que un hilo puede bloquearse a sí mismo.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="syncmeth.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="atomic.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">
                                Su uso de ésta
                            </a>
                            página y todo el material en las páginas bajo el anuncio &quot;Los Tutoriales de Java&quot; está sujeto
                            a estos
                            <a href="../../information/cpyr.html">
                                avisos legales
                            </a>
                            .
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs
                            </a>
                            .
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias?
                            <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión
                            </a>
                            .
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página Anterior:</b> Métodos Sincronizados<br />
            <b>Página Siguiente:</b> Acceso Atómico
        </div>
    </body>
</html>