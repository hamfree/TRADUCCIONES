<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Utilizando Objetos JoinRowSet (Los Tutoriales de Java&trade; &gt; Acceso a Bases de Datos JDBC(TM) &gt; 
            Lo Básico de JDBC)
        </title>
        <meta name="description" content="Este tutorial de Java JDBC describe cómo usar la IPA JDBC para crear, insertar, 
              actualizar y consultar tablas. También aprenderá cómo usar declaraciones simples y preparadas, procedimientos 
              almacenados y realizar transacciones" />
        <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Lo Básico de JDBC</a></div>
                <div class="linkAHEAD"><a href="gettingstarted.html">Empezando</a></div>
                <div class="linkAHEAD"><a href="processingsqlstatements.html">Procesando Sentencias SQL con JDBC</a></div>
                <div class="linkAHEAD"><a href="connecting.html">Estableciendo una Conexión</a></div>
                <div class="linkAHEAD"><a href="sqldatasources.html">Conectando con Objetos DataSource</a></div>
                <div class="linkAHEAD"><a href="sqlexception.html">Manejando SQLExceptions</a></div>
                <div class="linkAHEAD"><a href="tables.html">Configurando Tablas</a></div>
                <div class="linkAHEAD"><a href="retrieving.html">Recuperando y Modificando Valores de los Result Sets</a></div>
                <div class="linkAHEAD"><a href="prepared.html">Usando Prepared Statements</a></div>
                <div class="linkAHEAD"><a href="transactions.html">Usando Transacciones</a></div>
                <div class="linkAHEAD"><a href="rowset.html">Usando Objetos RowSet</a></div>
                <div class="linkAHEAD"><a href="jdbcrowset.html">Utilizando Objetos JdbcRowSet</a></div>
                <div class="linkAHEAD"><a href="cachedrowset.html">Utilizando CachedRowSetObjects</a></div>
                <div class="nolinkAHEAD">Utilizando Objetos JoinRowSet</div>
                <div class="linkAHEAD"><a href="filteredrowset.html">Utilizando Objetos FilteredRowSet</a></div>
                <div class="linkAHEAD"><a href="webrowset.html">Utilizando Objetos WebRowSet</a></div>
                <div class="linkAHEAD"><a href="sqltypes.html">Usando Tipos de Datos Avanzados</a></div>
                <div class="linkAHEAD"><a href="blob.html">Utilizando Objetos Grandes</a></div>
                <div class="linkAHEAD"><a href="sqlxml.html">Utilizando Objetos SQLXML</a></div>
                <div class="linkAHEAD"><a href="array.html">Utilizando Objetos Array</a></div>
                <div class="linkAHEAD"><a href="distinct.html">Usando el Tipo de Datos DISTINCT</a></div>
                <div class="linkAHEAD"><a href="sqlstructured.html">Utilizando Objetos Estructurados</a></div>
                <div class="linkAHEAD"><a href="sqlcustommapping.html">Usando Mapeados de Tipos Personalizados</a></div>
                <div class="linkAHEAD"><a href="sqldatalink.html">Utilizando Objetos Datalink</a></div>
                <div class="linkAHEAD"><a href="sqlrowid.html">Utilizando Objetos RowId</a></div>
                <div class="linkAHEAD"><a href="storedprocedures.html">Usando Procedimientos Almacenados</a></div>
                <div class="linkAHEAD"><a href="jdbcswing.html">Usando JDBC con una IPA de IGU</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Acceso a Bases de Datos JDBC(TM)<br />
                <b>Lección:</b> Lo Básico de JDBC
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Acceso a Bases de Datos JDBC(TM)</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Lo Básico de JDBC</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="cachedrowset.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="filteredrowset.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Utilizando Objetos JoinRowSet</h1>
            </div>
            <div id="PageContent">
                <p>
                    Una implementación <code>JoinRowSet</code> le permite crear una <code>JOIN</code> de SQL entre objetos 
                    <code>RowSet</code> cuando no están conectados a una fuente de datos. Esto es importante porque ahorra la 
                    sobrecarga de tener que crear una o más conexiones.
                    
                </p>
                <p>
                    Los siguientes temas están cubiertos:
                </p>
                <ul>
                    <li>
                        <a href="#creating-joinrowset-object">Crear Objetos JoinRowSet</a>
                    </li>
                    <li>
                        <a href="#adding-rowset-objects">Agregar Objetos RowSet</a>
                    </li>
                    <li>
                        <a href="#managing-match-columns">Administrar Columnas de Coincidencia</a>
                    </li>
                </ul>
                <p>
                    La interfaz <code>JoinRowSet</code> es una subinterfaz de la interfaz <code>CachedRowSet</code> y por lo tanto 
                    hereda las capacidades de un objeto <code>CachedRowSet</code>. Esto significa que un objeto 
                    <code>JoinRowSet</code>  es un objeto <code>RowSet</code> desconectado y puede operar sin estar siempre 
                    conectado a una fuente de datos.
                </p>
                <h2>
                    <a id="creating-joinrowset-object">Crear Objetos JoinRowSet</a>
                </h2>
                <p>
                    Un objeto <code>JoinRowSet</code> sirve como el contenedor de una <code>JOIN</code> de SQL. La siguiente línea 
                    de código muestra cómo crear un objeto <code>JoinRowSet</code>:
                </p>
                <div class="codeblock">
                    <pre>
JoinRowSet jrs = new JoinRowSetImpl();
                    </pre>
                </div>
                <p>
                    La variable <code>jrs</code> no contiene nada hasta que se le agregan los objetos <code>RowSet</code>.
                </p>
                <p>
                    <strong>Nota</strong>: Alternativamente, puede usar el constructor de la implementación de 
                    <code>JoinRowSet</code> de su controlador JDBC. Sin embargo, las implementaciones de la interfaz 
                    <code>RowSet</code> diferirán de la implementación de referencia. Estas implementaciones tendrán diferentes 
                    nombres y constructores. Por ejemplo, la implementación de la interfaz <code>JoinRowSet</code> del controlador 
                    JDBC de Oracle se llama <code>oracle.jdbc.rowset.OracleJoinRowSet</code>.
                </p>
                <h2>
                    <a id="adding-rowset-objects">Agregar Objetos RowSet</a>
                </h2>
                <p>
                    Cualquier objeto <code>RowSet</code> puede agregarse a un objeto <code>JoinRowSet</code> siempre que pueda ser 
                    parte de una <code>JOIN</code> de SQL. Un objeto <code>JdbcRowSet</code>, el cual está siempre conectado a su 
                    fuente de datos, puede ser agregado, pero habitualmente forma parte de un <code>JOIN</code> operando con la 
                    fuente de datos directamente en lugar de convertirse en parte de un <code>JOIN</code> al ser agregado a un 
                    objeto <code>JoinRowSet</code>. El objetivo de proporcionar una implementación de <code>JoinRowSet</code> es 
                    hacer posible que los objetos <code>RowSet</code> desconectados se conviertan en parte de una relación 
                    <code>JOIN</code>.
                </p>
                <p>
                    El propietario de la cadena de cafeterías The Coffe Break quiere obtener una lista de los cafés que compra de 
                    Acme, Inc. Para poder hacer esto, el propietario tendrá que obtener información de dos tablas, 
                    <code>COFFEES</code> y <code>SUPPLIERS</code>. En el mundo de las bases de datos antes de la tecnología 
                    <code>RowSet</code>, los programadores enviarían la siguiente consulta a la base de datos:
                </p>
                <div class="codeblock">
                    <pre>
String query =
    "SELECT COFFEES.COF_NAME " +
    "FROM COFFEES, SUPPLIERS " +
    "WHERE SUPPLIERS.SUP_NAME = Acme.Inc. " +
    "and " +
    "SUPPLIERS.SUP_ID = COFFEES.SUP_ID";
                    </pre>
                </div>
                <p>
                    En el mundo de la tecnología <code>RowSet</code>, puede lograr el mismo resultado sin tener que enviar una 
                    consulta a la fuente de datos. Puede agregar objetos <code>RowSet</code> que contienen los datos en las dos 
                    tablas a un objeto <code>JoinRowSet</code>. Luego, debido a que todos los datos pertinentes están en el objeto 
                    <code>JoinRowSet</code>, puede realizar una consulta para obtener los datos deseados.
                </p>
                <p>
                    El fragmento de código siguiente de <a href="gettingstarted.html"><code>JoinSample.testJoinRowSet</code></a> 
                    crea dos objetos <code>CachedRowSet</code> , <code>coffees</code> rellenos con los datos de la tabla 
                    <code>COFFEES</code>, y <code>suppliers</code> rellenos con los datos de la tabla <code>SUPPLIERS</code>. Los 
                    objetos <code>coffees</code> y <code>suppliers</code> tienen que hacer una conexión a la base de datos para 
                    ejecutar sus comandos y ser poblados con los datos, pero una vez hecho esto, no tienen que reconectar de 
                    nuevo para formar un <code>JOIN</code>.
                </p>
                <div class="codeblock">
                    <pre>
coffees = new CachedRowSetImpl();
coffees.setCommand("SELECT * FROM COFFEES");
coffees.setUsername(settings.userName);
coffees.setPassword(settings.password);
coffees.setUrl(settings.urlString);
coffees.execute();

suppliers = new CachedRowSetImpl();
suppliers.setCommand("SELECT * FROM SUPPLIERS");
suppliers.setUsername(settings.userName);
suppliers.setPassword(settings.password);
suppliers.setUrl(settings.urlString);
suppliers.execute(); 
                    </pre>
                </div>
                <h2>
                    <a id="managing-match-columns">Administrar Columnas de Coincidencia</a>
                </h2>
                <p>
                    Mirando la tabla <code>SUPPLIERS</code>, puede ver que Acme, Inc. tiene un número de identificación de 101. Los 
                    cafés en la tabla <code>COFFEES</code> con el número de identificación de proveedor de 101 son Colombian y 
                    Colombian_Decaf. La unión de la información de ambas tablas es posible porque las dos tablas tienen la columna  
                    <code>SUP_ID en común</code>. En la tecnología <code>RowSet</code> de JDBC, <code>SUP_ID</code>, la columna en 
                    la cual se base el <code>JOIN</code>, se llama la <i>columna de coincidencia</i>.
                </p>
                <p>
                    Cada objeto <code>RowSet</code> agregado a un objeto <code>JoinRowSet</code> debe tener una columna de 
                    coincidencia, la columna en la cual se basa el <code>JOIN</code>. Hay dos formas de establecer la columna de 
                    coincidencia para un objeto <code>RowSet</code>. La primera forma es pasar la columna de coincidencia al método 
                    <code>addRowSet</code> de <code>JoinRowSet</code> como se muestra en la siguiente línea de código:
                </p>
                <div class="codeblock">
                    <pre>
jrs.addRowSet(coffees, 2);
                    </pre>
                </div>
                <p>
                    Esta línea de código agrega <code>coffees</code> de tipo <code>CachedRowSet</code> al objeto <code>jrs</code> y 
                    establece la segunda columna de <code>coffees</code> (<code>SUP_ID</code>) como la columna de coincidencia. La 
                    línea de código podría también haber usado el nombre de la columna en vez del número de columna.
                </p>
                <div class="codeblock">
                    <pre>
jrs.addRowSet(coffees, "SUP_ID");
                    </pre>
                </div>
                <p>
                    En este punto, <code>jrs</code> sólo contiene <code>coffees</code>. El próximo objeto <code>RowSet</code> 
                    agregado a <code>jrs</code> tendrá que ser capaz de formar un <code>JOIN</code> con <code>coffees</code>, lo 
                    que es verdad para <code>suppliers</code> porque ambasd tablas tienen la columna SUP_ID. La línea de código 
                    siguiente agrega <code>suppliers</code> a <code>jrs</code> y establece la columna SUP_ID como la columna de 
                    coincidencia.
                </p>
                <div class="codeblock">
                    <pre>
jrs.addRowSet(suppliers, 1);
                    </pre>
                </div>
                <p>
                    Ahora <code>jrs</code> contiene un <code>JOIN</code> entre <code>coffees</code> y <code>suppliers</code> del que 
                    el propietario puede obtener los nombres de los cafés suministrados por Acme, Inc. Ya que el código no 
                    estableció el tipo de <code>JOIN</code>, <code>jrs</code> contiene un JOIN interno, que es el predeterminado. 
                    En otras palabras, una fila en <code>jrs</code> combina una fila <code>coffees</code> y una fila en 
                    <code>suppliers</code>. Contiene las columnas de <code>coffees</code> más las columnas de 
                    <code>suppliers</code> para las filas en las que el valor de la columna <code>COFFEES.SUP_ID</code> coincide 
                    con el valor de <code>SUPPLIERS.SUP_ID</code>. El código siguiente imprime los nombres de los cafés 
                    suministrados por Acme, Inc., donde <code>providerName</code> de tipo <code>String</code> es igual a 
                    <code>Acme, Inc.</code>. Tenga en cuenta que esto es posible porque la columna <code>SUP_NAME</code>, que es de 
                    <code>suppliers</code>, y <code>COF_NAME</code>, que es de <code>coffees</code> , ahora están ambas incluidas 
                    en el objeto <code>jrs</code> de tipo <code>JoinRowSet</code>.
                </p>
                <div class="codeblock">
                    <pre>
System.out.println("Coffees bought from " + supplierName + ": ");

while (jrs.next()) {
    if (jrs.getString("SUP_NAME").equals(supplierName)) {
        String coffeeName = jrs.getString(1);
        System.out.println("     " + coffeeName);
    }
}
                    </pre>
                </div>
                <p>
                    Esto producirá una salida similar a la siguiente:
                </p>
                <div class="codeblock">
                    <pre>
Coffees bought from Acme, Inc.:
     Colombian
     Colombian_Decaf
                    </pre>
                </div>
                <p>
                    La interfaz <code>JoinRowSet</code> proporciona constantes para establecer el tipo de <code>JOIN</code> que 
                    será formado, pero actualmente el único tipo que está implementado es <code>JoinRowSet.INNER_JOIN</code>.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="cachedrowset.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="filteredrowset.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Utilizando CachedRowSetObjects<br />
            <b>Página siguiente:</b> Utilizando Objetos FilteredRowSet
        </div>
    </body>
</html> 
