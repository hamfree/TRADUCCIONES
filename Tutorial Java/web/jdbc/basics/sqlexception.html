<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Manejando SQLExceptions (Los Tutoriales de Java&trade; &gt; Acceso a Bases de Datos JDBC(TM) &gt; Lo Básico de JDBC)
        </title>
        <meta name="description" content="Este tutorial de Java JDBC describe cómo usar la IPA JDBC para crear, insertar, 
              actualizar y consultar tablas. También aprenderá cómo usar declaraciones simples y preparadas, procedimientos 
              almacenados y realizar transacciones" />
        <meta name="keywords" content="java programming, learn java, java sample code, jdbc, prepared statement, result set" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Lo Básico de JDBC</a></div>
                <div class="linkAHEAD"><a href="gettingstarted.html">Empezando</a></div>
                <div class="linkAHEAD"><a href="processingsqlstatements.html">Procesando Sentencias SQL con JDBC</a></div>
                <div class="linkAHEAD"><a href="connecting.html">Estableciendo una Conexión</a></div>
                <div class="linkAHEAD"><a href="sqldatasources.html">Conectando con Objetos DataSource</a></div>
                <div class="nolinkAHEAD">Manejando SQLExceptions</div>
                <div class="linkAHEAD"><a href="tables.html">Configurando Tablas</a></div>
                <div class="linkAHEAD"><a href="retrieving.html">Recuperando y Modificando Valores de los Result Sets</a></div>
                <div class="linkAHEAD"><a href="prepared.html">Usando Prepared Statements</a></div>
                <div class="linkAHEAD"><a href="transactions.html">Usando Transacciones</a></div>
                <div class="linkAHEAD"><a href="rowset.html">Usando Objetos RowSet</a></div>
                <div class="linkAHEAD"><a href="jdbcrowset.html">Utilizando Objetos JdbcRowSet</a></div>
                <div class="linkAHEAD"><a href="cachedrowset.html">Utilizando CachedRowSetObjects</a></div>
                <div class="linkAHEAD"><a href="joinrowset.html">Utilizando Objetos JoinRowSet</a></div>
                <div class="linkAHEAD"><a href="filteredrowset.html">Utilizando Objetos FilteredRowSet</a></div>
                <div class="linkAHEAD"><a href="webrowset.html">Utilizando Objetos WebRowSet</a></div>
                <div class="linkAHEAD"><a href="sqltypes.html">Usando Tipos de Datos Avanzados</a></div>
                <div class="linkAHEAD"><a href="blob.html">Utilizando Objetos Grandes</a></div>
                <div class="linkAHEAD"><a href="sqlxml.html">Utilizando Objetos SQLXML</a></div>
                <div class="linkAHEAD"><a href="array.html">Utilizando Objetos Array</a></div>
                <div class="linkAHEAD"><a href="distinct.html">Usando el Tipo de Datos DISTINCT</a></div>
                <div class="linkAHEAD"><a href="sqlstructured.html">Utilizando Objetos Estructurados</a></div>
                <div class="linkAHEAD"><a href="sqlcustommapping.html">Usando Mapeados de Tipos Personalizados</a></div>
                <div class="linkAHEAD"><a href="sqldatalink.html">Utilizando Objetos Datalink</a></div>
                <div class="linkAHEAD"><a href="sqlrowid.html">Utilizando Objetos RowId</a></div>
                <div class="linkAHEAD"><a href="storedprocedures.html">Usando Procedimientos Almacenados</a></div>
                <div class="linkAHEAD"><a href="jdbcswing.html">Usando JDBC con una IPA de IGU</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Acceso a Bases de Datos JDBC(TM)<br />
                <b>Lección:</b> Lo Básico de JDBC
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Acceso a Bases de Datos JDBC(TM)</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Lo Básico de JDBC</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="sqldatasources.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="tables.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Manejando SQLExceptions</h1>
            </div>
            <div id="PageContent">
                <p>
                    Esta página cubre los temas siguientes:
                </p>
                <ul>
                    <li>
                        <a href="#overview_sqlexception">Descripción General de SQLException</a>
                    </li>
                    <li>
                        <a href="#retrieving_exceptions">Recuperar Excepciones</a>
                    </li>
                    <li>
                        <a href="#retrieving_warnings">Recuperar Advertencias</a>
                    </li>
                    <li>
                        <a href="#categorized_sqlexceptions">SQLExceptions Categorizadas</a>
                    </li>
                    <li>
                        <a href="#subclasses_sqlexception">Otras Subclases de SQLException</a>
                    </li>
                </ul>
                <h2>
                    <a id="overview_sqlexception">Descripción General de SQLException</a>
                </h2>
                <p>
                    Cuando JDBC encuentra un error durante una interacción con una fuente de datos, lanza una instancia de 
                    <code>SQLException</code> en lugar de una <code>Exception</code>. (Una fuente de datos en este contexto 
                    representa la base de datos a la cual un objeto <code>Connection</code> está conectado). La instancia de 
                    <code>SQLException</code> contiene la información siguiente que puede ayudarle a determinar la causa del error:
                </p>
                <ul>
                    <li>
                        <p>
                            Una descripción del error. Recupere el objeto <code>String</code> que contiene esta descripción 
                            llamando al método <code>SQLException.getMessage</code>.
                        </p>
                    </li>
                    <li>
                        <p>
                            Un código SQLState. Estos códigos y sus respectivos significados han sido estandarizados por ISO/ANSI 
                            y el Open Group (X/Open), aunque algunos códigos han sido reservados para los fabricantes de bases de 
                            datos para que los definan ellos mismos. Este objeto <code>String</code> consiste de cinco caracteres 
                            alfanuméricos. Recupere este código llamando al método <code>SQLException.getSQLState</code>.
                        </p>
                    </li>
                    <li>
                        <p>
                            Un código de error. Este es un valor entero que identifica el error que causó que se lanzara la 
                            instancia de <code>SQLException</code>. Su valor y significado son específicos de la implementación y 
                            podría ser el código de error real devuelto por la fuente de datos subyacente. Recupere el error 
                            llamando al método <code>SQLException.getErrorCode</code>.
                        </p>
                    </li>
                    <li>
                        <p>
                            Una causa. Una instancia <code>SQLException</code> puede tener una relación causal, la cual consiste 
                            de uno o más objetos <code>Throwable</code> que causaron que se lanzara la instancia de  
                            <code>SQLException</code>. Para navegar por esta cadena de causas, llame recursivamente al método 
                            <code>SQLException.getCause</code> hasta que se devuelva un valor <code>null</code>.
                        </p>
                    </li>
                    <li>
                        <p>
                            Una referencia a cualquier excepción <em>encadenada</em>. Si más de un error ocurre, se hace referencia 
                            a las excepciones a través de esta cadena. Recupere estas excepciones llamando al método 
                            <code>SQLException.getNextException</code> sobre la excepción que fue lanzada.
                        </p>
                    </li>
                </ul>
                <h2>
                    <a id="retrieving_exceptions">Recuperar Excepciones</a>
                </h2>
                <p>
                    El método siguiente, <code>JDBCTutorialUtilities.printSQLException</code> muestra el SQLState, el código de 
                    error, la descripción del error, y la causa (si hay una) contenidos en la <code>SQLException</code> como 
                    también cualquier otra excepción encadenada a ella:
                </p>
                <div class="codeblock">
                    <pre>
public static void printSQLException(SQLException ex) {

    for (Throwable e : ex) {
        if (e instanceof SQLException) {
            <strong>if (ignoreSQLException(
                ((SQLException)e).
                getSQLState()) == false)</strong> {

                e.printStackTrace(System.err);
                System.err.println("SQLState: " +
                    ((SQLException)e).getSQLState());

                System.err.println("Error Code: " +
                    ((SQLException)e).getErrorCode());

                System.err.println("Message: " + e.getMessage());

                Throwable t = ex.getCause();
                while(t != null) {
                    System.out.println("Cause: " + t);
                    t = t.getCause();
                }
            }
        }
    }
}
                    </pre>
                </div>
                <p>
                    Por ejemplo, si llama al método <code>CoffeesTable.dropTable</code> con Java DB como su DBMS, la tabla 
                    <code>COFFEES</code> no existe, <em>y</em> elimina la llamada a 
                    <code>JDBCTutorialUtilities.ignoreSQLException</code>, la salida será similar a la siguiente:
                </p>
                <div class="codeblock">
                    <pre>
SQLState: 42Y55
Error Code: 30000
Message: 'DROP TABLE' cannot be performed on
'TESTDB.COFFEES' because it does not exist.
                    </pre>
                </div>
                <p>
                    En lugar de generar información de <code>SQLException</code>, primero podría recuperar el <code>SQLState</code> 
                    y luego procesar la <code>SQLException</code> en consecuencia. Por ejemplo, el método 
                    <code>JDBCTutorialUtilities.ignoreSQLException</code> devuelve <code>true</code> si el <code>SQLState</code> es
                    igual al código <code>42Y55</code> (y está usando Java DB como su DBMS), lo que causa que 
                    <code>JDBCTutorialUtilities.printSQLException</code> ignore la <code>SQLException</code>:
                </p>
                <div class="codeblock">
                    <pre>
public static boolean ignoreSQLException(String sqlState) {

    if (sqlState == null) {
        System.out.println("The SQL state is not defined!");
        return false;
    }

    // X0Y32: Jar file already exists in schema
    if (sqlState.equalsIgnoreCase("X0Y32"))
        return true;

    // 42Y55: Table already exists in schema
    if (sqlState.equalsIgnoreCase("42Y55"))
        return true;

    return false;
}
                    </pre>
                </div>
                <h2>
                    <a id="retrieving_warnings">Recuperar Advertencias</a>
                </h2>
                <p>
                    Los objetos <code>SQLWarning</code> son una subclase de <code>SQLException</code> que tratan con las 
                    advertencias de acceso a la base de datos. Las advertencias no paran la ejecución de una aplicación, como hacen 
                    las excepciones; simplemente alertan al usuario que algo no ha ocurrido como se planeó. Por ejemplo, una 
                    advertencia podría permitirle saber que un privilegio que intentó revocar no fue revocado. O una advertencia 
                    podría decirle que ocurrió un error durante una desconexión solicitada.
                </p>
                <p>
                    Una advertencia puede ser informada sobre un objeto <code>Connection</code>, un objeto <code>Statement</code> 
                    (incluyendo los objetos <code>PreparedStatement</code> y <code>CallableStatement</code>), o un objeto 
                    <code>ResultSet</code>. Cada una de estas clases tiene un método <code>getWarnings</code>, el cual debe invocar 
                    para ver la primera advertencia informada sobre el objeto que realiza la llamada. Si <code>getWarnings</code> 
                    devuelve uan advertencia, puede llamar al método <code>getNextWarning</code> de <code>SQLWarning</code> sobre 
                    él para obtener cualquier advertencia adicional. Ejecutar una sentencia borra automáticamente las advertencias 
                    de una sentencia anterior, por lo que no se acumulan. Esto significa, sin embargo, que si quiere recuperar las 
                    advertencias informadas en una sentencia, debe hacerlo antes de que ejecute otra sentencia.
                </p>
                <p>
                    Los métodos siguientes de <code><a href="gettingstarted.html">JDBCTutorialUtilities</a></code> ilustran cómo 
                    obtener la información completa sobre cualquier advertencia informada sobre los objetos <code>Statement</code> 
                    o <code>ResultSet</code>:
                </p>
                <div class="codeblock">
                    <pre>
public static void getWarningsFromResultSet(ResultSet rs)
    throws SQLException {
    JDBCTutorialUtilities.printWarnings(rs.getWarnings());
}

public static void getWarningsFromStatement(Statement stmt)
    throws SQLException {
    JDBCTutorialUtilities.printWarnings(stmt.getWarnings());
}

public static void printWarnings(SQLWarning warning)
    throws SQLException {

    if (warning != null) {
        System.out.println("\n---Warning---\n");

    while (warning != null) {
        System.out.println("Message: " + warning.getMessage());
        System.out.println("SQLState: " + warning.getSQLState());
        System.out.print("Vendor error code: ");
        System.out.println(warning.getErrorCode());
        System.out.println("");
        warning = warning.getNextWarning();
    }
}
                    </pre>
                </div>
                <p>
                    La advertencia más común es una advertencia <code>DataTruncation</code>, una subclase de 
                    <code>SQLWarning</code>. Todos los objetos <code>DataTruncation</code> tienen un SQLState de 
                    <code>01004</code>, indicando que había un problema con la lectura o escritura de datos. Los métodos de 
                    <code>DataTruncation</code> le permiten encontrar en cual columna o parámetro se truncaron los datos, si el 
                    truncamiento fue en una operación de lectura o escritura, cuántos bytes deberían haberse transferido, y cuántos 
                    bytes se transfirieron realmente.
                </p>
                <h2>
                    <a id="categorized_sqlexceptions">SQLExceptions Categorizadas</a>
                </h2>
                <p>
                    Su controlador JDBC podría lanzar una subclase de <code>SQLException</code> que corresponde a un SQLState común 
                    o un estado de error común que no está asociado con un valor de clase SQLState especifico. Esto le permite 
                    escribir código de manejo de errores más portable. Estas excepciones son subclases de una de las clases 
                    siguientes:
                </p>
                <ul>
                    <li>
                        <code>SQLNonTransientException</code>
                    </li>
                    <li>
                        <code>SQLTransientException</code>
                    </li>
                    <li>
                        <code>SQLRecoverableException</code>
                    </li>
                </ul>
                <p>
                    Vea la última documentación Java del paquete <code>java.sql</code> o la documentación de su controlador JDBC 
                    para más información sobre estas subclases.
                </p>
                <h2>
                    <a id="subclasses_sqlexception">Otras Subclases de SQLException</a>
                </h2>
                <p>
                    También se pueden lanzar las subclases siguientes de <code>SQLException</code>:
                </p>
                <ul>
                    <li>
                        Se lanza una <code>BatchUpdateException</code> cuando ocurre un error durante una operación de 
                        actualización por lotes. Además de la información proporcionada por <code>SQLException</code>, 
                        <code>BatchUpdateException</code> proporciona los recuentos de actualizaciones para todas las declaraciones 
                        que se ejecutaron antes de que ocurriera el error.
                    </li>
                    <li>
                        Se lanza una <code>SQLClientInfoException</code> cuando una o más propiedades de información del cliente no 
                        se pueden establecer en una Connection. Además de la información proporcionada por 
                        <code>SQLException</code>, <code>SQLClientInfoException</code> proporciona una lista de las propiedades 
                        de información del cliente que no fueron establecidas.
                    </li>
                </ul>
            </div>
            <div class="NavBit">
                <a target="_top" href="sqldatasources.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="tables.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Conectando con Objetos DataSource<br />
            <b>Página siguiente:</b> Configurando Tablas
        </div>
    </body>
</html> 
