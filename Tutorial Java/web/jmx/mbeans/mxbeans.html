<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            MXBeans (Los Tutoriales de Java&trade; &gt; Extensiones de Gestión de Java (JMX) &gt; Presentación de MBeans)
        </title>
        <meta name="description" content="Este tutorial de JMX Java describe la tecnología de Extensiones de Gestión de Java (JMX): 
              mbeans, notificaciones y gestión remota" />
        <meta name="keywords" content="java programming, learn java, java sample code, jmx, java management extension, mbeans,
              mxbeans" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Presentación de MBeans</a></div>
                <div class="linkAHEAD"><a href="standard.html">MBeans estándar</a></div>
                <div class="nolinkAHEAD">MXBeans</div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Extensiones de Gestión de Java (JMX)<br />
                <b>Lección:</b> Presentación de MBeans
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Extensiones de Gestión de Java (JMX)</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Presentación de MBeans</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="standard.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../notifs/index.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>MXBeans</h1>
            </div>
            <div id="PageContent">
                <p>
                    Esta sección explica un tipo especial de MBean, llamado <i>MXBeans</i>.
                </p>
                <p>
                    Un <i>MXBean</i> es un tipo de MBean que referencia sólo un conjunto predefinido de tipos de datos. En esta 
                    forma, puede estar seguro que su MBean será utilizable por cualquier cliente, incluyendo clientes remotos, sin 
                    ningún requisito de que el cliente tenga acceso a clases específicas del modelo que representan los tipos de 
                    sus MBeans. MXBeans proporciona un forma conveniente de empaquetar valores relacionados juntos, sin requerir 
                    que los clientes estén especialmente configurados para gestionar los paquetes.
                </p>
                <p>
                    En la misma forma que para los MBeans estándar, un MXBean se define escribiendo una interfaz Java llamada 
                    <code>AlgoMXBean</code> y una clase Java que implementa esa interfaz. Sin embargo, a diferencia de los MBeans 
                    estándar, los MXBeans no requieren que la clase Java sea llamada <code>Algo</code>. Cada método en la interfaz 
                    define un atributo o una operación en el MXBean. La anotación <code>@MXBean</code> puede también ser usada para 
                    anotar la interfaz Java, en vez de requerir que el nombre de la interfaz vaya seguido del sufijo MXBean.
                </p>
                <p>
                    Los MXBeans existían en el software de la Plataforma de Java 2, Edición Estándar (J2SE) 5.0, en el paquete 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/lang/management/package-summary.html">
                        <code>java.lang.management</code></a>. Sin embargo, los usuarios pueden ahora definir sus propios MXBeans, 
                    además del conjunto estándar que está definido en <code>java.lang.management</code>.
                </p>
                <p>
                    La idea principal detrás de MXBeans es que los tipos tales como 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/lang/management/MemoryUsage.html">
                        <code>java.lang.management.MemoryUsage</code></a> que se referencian en la interfaz MXBean,
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/lang/management/MemoryMXBean.html">
                        <code>java.lang.management.MemoryMXBean</code></a> en este caso, están mapeados en un conjunto estándar de 
                    tipos, los así llamados <i>Tipos Abiertos</i> que se definen en el paquete 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/management/openmbean/package-summary.html">
                        <code>javax.management.openmbean</code></a>. Las reglas de mapeo exactas aparecen en la especificación 
                    MXBean. Sin embargo, el principio general es que para tipos simples como un int o String permanecen sin 
                    cambios, mientras que los tipos complejos tales como <code>MemoryUsage</code> se asignan al tipo estándar 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/management/openmbean/CompositeDataSupport.html">
                        <code>CompositeDataSupport</code></a>.
                </p>
                <p>
                    El ejemplo MXBean consiste de los siguientes ficheros, los cuales se encuentran en 
                    <a class="SourceLink" target="_blank" href="../examples/jmx_examples.zip" 
                       onclick="showCode('../../displayCode.html', '../examples/jmx_examples.zip'); return false;">
                        <code>jmx_examples.zip</code></a>:
                </p>
                <ul>
                    <li>
                        Interfaz <code>QueueSamplerMXBean</code>
                    </li>
                    <li>
                        Clase <code>QueueSampler</code> que implementa la interfaz MXBean
                    </li>
                    <li>
                        Tipo de Java <code>QueueSample</code> devuelto por el método <code>getQueueSample()</code> en la interfaz 
                        MXBean
                    </li>
                    <li>
                        <code>Main</code>, el programa que configura y ejecuta el ejemplo
                    </li>
                </ul>
                <p>
                    El ejemplo MXBean usa estas clases para realizar las siguientes acciones:
                </p>
                <ul>
                    <li>
                        Define un simple MXBean que gestiona un recurso de tipo <code>Queue&lt;String&gt;</code>
                    </li>
                    <li>
                        Declara un getter, <code>getQueueSample</code>, en el MXBean que toma una captura de la cola cuando se 
                        invoca y devuelve una clase Java <code>QueueSample</code> que empaqueta los valores siguientes juntos:
                        <ul>
                            <li>
                                La hora a la que se tomó la instantánea
                            </li>
                            <li>
                                El tamaño de la cola
                            </li>
                            <li>
                                La cabeza de la cola en ese momento dado
                            </li>
                        </ul>
                    </li>
                    <li>
                        Registra el MXBean en un servidor MBean
                    </li>
                </ul>
                <h2>
                    Interfaz MXBean
                </h2>
                <p>
                    El código siguiente muestra el ejemplo de la interfaz MXBean
                    <a class="SourceLink" target="_blank" href="../examples/QueueSamplerMXBean.java" 
                       onclick="showCode('../../displayCode.html', '../examples/QueueSamplerMXBean.java'); return false;">
                        <code>QueueSamplerMXBean</code></a>:
                </p>
                <div class="codeblock">
                    <pre>
package com.example; 
 
public interface QueueSamplerMXBean { 
    public QueueSample getQueueSample(); 
    public void clearQueue(); 
} 

                    </pre>
                </div>
                <p>
                    Dese cuenta de que usted declara una interfaz MXBean exactamente de la misma forma que declara una interfaz 
                    estándar MBean. La interfaz <code>QueueSamplerMXBean</code> declara un getter, <code>getQueueSample</code> y 
                    una operación, <code>clearQueue</code>.
                </p>
                <h2>
                    Definir Operaciones MXBean
                </h2>
                <p>
                    Las operaciones MXBean se declaran en la clase de ejemplo 
                    The MXBean operations are declared in the
                    <a class="SourceLink" target="_blank" href="../examples/QueueSampler.java" 
                       onclick="showCode('../../displayCode.html', '../examples/QueueSampler.java'); return false;">
                        <code>QueueSampler</code></a>, como sigue:
                </p>
                <div class="codeblock">
                    <pre>
package com.example; 
 
import java.util.Date; 
import java.util.Queue; 
 
public class QueueSampler 
                implements QueueSamplerMXBean { 
     
    private Queue&lt;String&gt; queue; 
         
    public QueueSampler (Queue&lt;String&gt; queue) { 
        this.queue = queue; 
    } 
         
    public QueueSample getQueueSample() { 
        synchronized (queue) { 
            return new QueueSample(new Date(), 
                           queue.size(), queue.peek()); 
        } 
    } 
         
    public void clearQueue() { 
        synchronized (queue) { 
            queue.clear(); 
        } 
    } 
} 
                    </pre>
                </div>
                <p>
                    <code>QueueSampler</code> define el getter <code>getQueueSample()</code> y la operación 
                    <code>clearQueue()</code> que fue declarada por la interfaz MXBean. La operación <code>getQueueSample()</code> 
                    devuelve una instancia del tipo Java <code>QueueSample</code> el cual fue creado con los valores devueltos por 
                    los métodos 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/util/Queue.html"><code>java.util.Queue</code></a> 
                    <code>peek()</code> y <code>size()</code>, y una instancia de 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/util/Date.html"><code>java.util.Date</code></a>.
                </p>
                <h2>
                    Definir el Tipo Java Devuelto por la Interfaz MXBean
                </h2>
                <p>
                    La instancia <code>QueueSample</code> devuelta por <code>QueueSampler</code> se define en la clase 
                    <a class="SourceLink" target="_blank" href="../examples/QueueSample.java" 
                       onclick="showCode('../../displayCode.html', '../examples/QueueSample.java'); return false;">
                        <code>QueueSample</code></a>, como sigue:
                </p>
                <div class="codeblock">
                    <pre>
package com.example; 
 
import java.beans.ConstructorProperties; 
import java.util.Date; 
 
public class QueueSample { 
     
    private final Date date; 
    private final int size; 
    private final String head; 
         
    @ConstructorProperties({"date", "size", "head"}) 
    public QueueSample(Date date, int size, 
                        String head) { 
        this.date = date; 
        this.size = size; 
        this.head = head; 
    } 
         
    public Date getDate() { 
        return date; 
    } 
         
    public int getSize() { 
        return size; 
    } 
         
    public String getHead() { 
        return head; 
    } 
}   
                    </pre>
                </div>
                <p>
                    En la clase <code>QueueSample</code>, el marco de trabajo MXBean llama a todos los getters en 
                    <code>QueueSample</code> para convertir la instancia dada en una instancia 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/management/openmbean/CompositeData.html">
                        <code>CompositeData</code></a> y usa la anotación <code>@ConstructorProperties</code> para reconstruir una 
                    instancia <code>QueueSample</code> desde una instancia <code>CompositeData</code>.
                </p>
                <h2>
                    Crear y Registrar el MXBean en el Servidor MBean
                </h2>
                <p>
                    Hasta ahora, ha sido definido lo siguiente: una interfaz MXBean y la clase que la implementa, como también el 
                    tipo de Java que se devuelve. A continuación, el MXBean debe ser creado y registrado en un servidor MBean. 
                    Estas acciones se realizan por el mismo ejemplo 
                    <a class="SourceLink" target="_blank" href="../examples/Main.java" 
                       onclick="showCode('../../displayCode.html', '../examples/Main.java'); return false;">
                        <code>Main</code></a> de agente JMX que fue usado en el ejemplo estándar MBean, pero el código relevante no 
                        fue mostrado en la lección 
                    <a class="TutorialLink" target="_top" href="standard.html">MBean Estándar</a>.
                </p>
                <div class="codeblock">
                    <pre>

package com.example; 
 
import java.lang.management.ManagementFactory; 
import java.util.Queue; 
import java.util.concurrent.ArrayBlockingQueue; 
import javax.management.MBeanServer; 
import javax.management.ObjectName; 
 
public class Main { 
 
    public static void main(String[] args) throws Exception { 
        MBeanServer mbs = 
            ManagementFactory.getPlatformMBeanServer(); 
                
        ...  
        ObjectName mxbeanName = new ObjectName("com.example:type=QueueSampler");
        
        Queue&lt;String&gt; queue = new ArrayBlockingQueue&lt;String&gt;(10);
        queue.add("Request-1");
        queue.add("Request-2");
        queue.add("Request-3");
        QueueSampler mxbean = new QueueSampler(queue);
        
        mbs.registerMBean(mxbean, mxbeanName);
                 
        System.out.println("Waiting..."); 
        Thread.sleep(Long.MAX_VALUE); 
    } 
} 
 

                    </pre>
                </div>
                <p>
                    La clase <code>Main</code> realiza las siguientes acciones:
                </p>
                <ul>
                    <li>
                        Obtiene el servidor de plataforma MBean.
                    </li>
                    <li>
                        Crea un objeto de nombre para el MXBean <code>QueueSampler.</code>
                    </li>
                    <li>
                        Crea una instancia de <code>Queue</code> para que lo procese el MXBean <code>QueueSampler</code>.
                    </li>
                    <li>
                        Alimenta la instancia <code>Queue</code> a un MXBean <code>QueueSampler</code> recién creado.
                    </li>
                    <li>
                        Registra el MXBean en el servidor MBean exactamente de la misma forma que un MBean estándar.
                    </li>
                </ul>
                <h2>
                    Ejecutar el Ejemplo MXBean
                </h2>
                <p>
                    El ejemplo MXBean usa clases del paquete 
                    The MXBean example uses classes from the
                    <a class="SourceLink" target="_blank" 
                       href="../examples/jmx_examples.zip" 
                       onclick="showCode('../../displayCode.html', '../examples/jmx_examples.zip'); return false;">
                        <code>jmx_examples.zip</code></a> que usó en la sección 
                    <a class="TutorialLink" target="_top" href="standard.html">MBeans estándar</a>. Este ejemplo requiere la 
                    versión 6 de la plataforma Java SE. Para ejecutar el ejemplo MXBeans sigua estos pasos:
                </p>
                <ol>
                    <li>
                        Si no lo ha hecho aún, salve 
                        <a class="SourceLink" target="_blank" href="../examples/jmx_examples.zip" 
                           onclick="showCode('../../displayCode.html', '../examples/jmx_examples.zip'); return false;">
                            <code>jmx_examples.zip</code></a> dentro de su directorio <code>work_dir</code>.
                    </li>
                    <li>
                        Descomprima el paquete de clases de ejemplo usando el comando siguiente en una ventana terminal.
                        <div class="codeblock">
                            <pre>
unzip jmx_examples.zip
                            </pre>
                        </div>
                    </li>
                    <li>
                        Compile las clases de Java de ejemplo desde dentro del directorio <code>work_dir</code>.
                        <div class="codeblock">
                            <pre>
javac com/example/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        Inicie la aplicación <code>Main</code>. Se genera una confirmación de que <code>Main</code> está esperando 
                        a que ocurra algo.
                        <div class="codeblock">
                            <pre>
java com.example.Main
                            </pre>
                        </div>
                    </li>
                    <li>
                        Inicie JConsole en una ventana terminal diferente en la misma máquina. El cuadro de diálogo Nueva Conexión 
                        se visualiza, presentando una lista de agentes JMX en ejecución a los que puede conectar.
                        <div class="codeblock">
                            <pre>
jconsole
                            </pre>
                        </div>
                    </li>
                    <li>
                        En el cuadro de diálogo Nueva Conexión, seleccione <code>com.example.Main</code> desde la lista y pulse 
                        Conectar. 
                        <p>
                            Se visualiza un resumen de su actividad actual de la plataforma.
                        </p>
                    </li>
                    <li>
                        Pulse la pestaña MBeans.
                        <p>
                            Este panel muestra todos los MBeans que están actualmente registrados en el servidor MBean.
                        </p>
                    </li>
                    <li>
                        En el marco izquierdo, expanda el nodo <code>com.example</code> en el árbol MBean.
                        <p>
                            Verá el ejemplo de MBean <code>QueueSampler</code> qu fue creado y registrado por <code>Main</code>. Si 
                            pulsa <code>QueueSampler</code>, verá sus Atributos asociados y nodos de Operación en el árbol MBean.
                        </p>
                    </li>
                    <li>
                        Expanda el nodo Atributos.
                        <p>
                            Verá el atributo <code>QueueSample</code> aparecer en el panel derecho, con su valor de 
                            <code>javax.management.openmbean.CompositeDataSupport</code>.
                        </p>
                    </li>
                    <li>
                        Haga doble clic en el valor <code>CompositeDataSupport</code>.
                        <p>
                            Verá los valores <code>QueueSample</code> <code>date</code>, <code>head</code>, y  
                            <code>size</code> porque el marco de trabajo de MXBean ha convertido la instancia 
                            <code>QueueSample</code> en <code>CompositeData</code>. Si hubiera definido <code>QueueSampler</code> 
                            como un MBean estándar en vez de como un MXBean, Jconsole no habría encontrado la clase 
                            <code>QueueSample</code> porque no estaría en su ruta de clases. Si <code>QueueSampler</code> hubiera 
                            sido un MBean estándar, habría recibido un mensaje <code>ClassNotFoundException</code> cuando recupera 
                            el valor de atributo <code>QueueSample</code>. El hecho de que JConsole encuentre 
                            <code>QueueSampler</code> demuestra la utilidad de usar MXBeans cuando conecta a agentes JMX a través 
                            de clientes JMX genéricos tales como JConsole.
                        </p>
                    </li>
                    <li>
                        Expanda el nodo Operaciones.
                        <p>
                            Se visualiza un botón para invocar la operación <code>clearQueue</code>
                        </p>
                    </li>
                    <li>
                        Pulse el botón <code>clearQueue</code>.
                        <p>
                            Se visualiza una confirmación de que el método fue invocado con éxito.
                        </p>
                    </li>
                    <li>
                        Expanda el nodo de Atrbutos de neuvo, y haga doble clic sobre el valor <code>CompositeDataSupport</code>.
                        <p>
                            Los valores de <code>head</code> y <code>size</code> han sido restaurados.
                        </p>
                    </li>
                    <li>
                        Para cerrar JConsole, seleccione Conexión -&gt; Salir.
                    </li>
                </ol>
            </div>
            <div class="NavBit">
                <a target="_top" href="standard.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../notifs/index.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> MBeans estándar<br />
            <b>Página siguiente:</b> Notifications
        </div>
    </body>
</html> 
