<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Agrupación (Pooling) (Los Tutoriales de Java&trade; &gt; Nombrado en Java e Interfaz de Directorio &gt; Temas Avanzados
            para los Usuarios LDAP)
        </title>
        <meta name="description" content="Este tutorial de Java JNDI describe la tecnología de Nombrado en Java e Interfaz de 
              Directorio (JNDI), operaciones de nombre y directorio, y LDAP" />
        <meta name="keywords" content="java programming, learn java, java sample code, jndi, ldap, jndi service provider" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Temas Avanzados para los Usuarios LDAP</a></div>
                <div class="linkAHEAD"><a href="ldap.html">LDAP v3</a></div>
                <div class="linkAHEAD"><a href="jndi.html">JNDI como una IPA de LDAP</a></div>
                <div class="linkBHEAD"><a href="operations.html">Cómo las Operaciones LDAP se Mapean a las IPAs de JNDI</a></div>
                <div class="linkBHEAD"><a href="exceptions.html">Cómo los Códigos de Error LDAP se Mapean a las Excepciones de JNDI</a></div>
                <div class="linkAHEAD"><a href="security.html">Seguridad</a></div>
                <div class="linkBHEAD"><a href="authentication.html">Modos de Autenticación en LDAP</a></div>
                <div class="linkBHEAD"><a href="auth_mechs.html">Mecanismos de Autenticación</a></div>
                <div class="linkBHEAD"><a href="anonymous.html">Anónimo</a></div>
                <div class="linkBHEAD"><a href="simple.html">Simple</a></div>
                <div class="linkBHEAD"><a href="sasl.html">SASL</a></div>
                <div class="linkBHEAD"><a href="digest.html">Digest-MD5</a></div>
                <div class="linkBHEAD"><a href="ssl.html">SSL y Sockets Personalizados</a></div>
                <div class="linkAHEAD"><a href="rename.html">Más Operaciones LDAP</a></div>
                <div class="linkBHEAD"><a href="compare.html">Comparación LDAP</a></div>
                <div class="linkBHEAD"><a href="result.html">Resultados de la Búsqueda</a></div>
                <div class="linkBHEAD"><a href="unsol.html"> Notificaciones no Solicitadas de LDAP</a></div>
                <div class="linkAHEAD"><a href="connect.html">Gestión de Conexiones</a></div>
                <div class="linkBHEAD"><a href="create.html">Creación</a></div>
                <div class="linkBHEAD"><a href="close.html"> Cierre</a></div>
                <div class="nolinkBHEAD">Agrupación (Pooling)</div>
                <div class="linkBHEAD"><a href="config.html">Configuración</a></div>
                <div class="linkAHEAD"><a href="faq.html">Preguntas Frecuentes</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Nombrado en Java e Interfaz de Directorio<br />
                <b>Lección:</b> Temas Avanzados para los Usuarios LDAP<br />
                <b>Sección:</b> Gestión de Conexiones
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Nombrado en Java e Interfaz de Directorio</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Temas Avanzados para los Usuarios LDAP</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="close.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="config.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Agrupación (Pooling)</h1>
            </div>
            <div id="PageContent">
                <p>
                    La sección 
                    <a class="TutorialLink" target="_top" href="create.html">Creación</a> describía cuándo se crean las 
                    conexiones. Describía cómo varias instancias <code>Context</code> pueden compartir la misma conexión.
                </p>
                <p>
                    Otro tipo de conexiones compartidas admitidas por el proveedor de servicio LDAP se llama 
                    <em>agrupación de conexiones</em>. En este tipo de uso compartido, el proveedor de servicio LDAP mantiene una 
                    agrupación de (posiblemente) conexiones usadas previamente y las asigna a una instancia <code>Context</code> 
                    según sea necesario. Cuando una instancia <code>Context</code> ha terminado con una conexión (cerrada o 
                    recolectada para basura), la conexión se devuelve a la agrupación para uso futuro. Tenga en cuenta que esta 
                    forma de compartir es secuencial: una conexión se recupera del grupo, se usa, se devuelve al grupo y luego se 
                    recupera nuevamente del grupo para otra instancia de <code>Context</code>. 
                </p>
                <p>
                    La agrupación de conexiones es mantenida por el sistema de tiempo de ejecución de Java. Para algunas 
                    situaciones, la agrupación de conexiones puede mejorar el rendimiento significativamente. Por ejemplo, se 
                    requiere sólo una conexión para procesar una respuesta de búsqueda que contiene cuatro referencias que 
                    referencia al mismo servidor LDAP si se usa la agrupación de conexiones. Sin la agrupación de conexiones, 
                    tal escenario requeriría cuatro conexiones separadas.
                </p>
                <p>
                    El resto de esta lección describe en más detalle cómo usar la agrupación de conexiones.
                </p>
                <h2>
                    Cómo Usar la Agrupación de Conexiones
                </h2>
                <p>
                    Usted pide la agrupación de conexiones agregando la propiedad, 
                    <code>&quot;com.sun.jndi.ldap.connect.pool&quot;</code> a las propiedades de entorno pasadas al constructor 
                    del contexto inicial. Aquí tiene 
                    <a class="SourceLink" target="_blank" href="examples/UsePool.java"
                       onclick="showCode('../../displayCode.html', 'examples/UsePool.java'); return false;">
                        <code>un ejemplo</code></a>.
                </p>
                <div class="codeblock">
                    <pre>
// Set up environment for creating initial context
Hashtable env = new Hashtable(11);
env.put(Context.INITIAL_CONTEXT_FACTORY, "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Enable connection pooling
env.put("com.sun.jndi.ldap.connect.pool", "true");

// Create one initial context (Get connection from pool)
DirContext ctx = new InitialDirContext(env);

// do something useful with ctx

// Close the context when we're done
ctx.close();   // Return connection to pool

// Create another initial context (Get connection from pool)
DirContext ctx2 = new InitialDirContext(env);

// do something useful with ctx2

// Close the context when we're done
ctx2.close();   // Return connection to pool
                    </pre>
                </div>
                <p>
                    Este ejemplo crea dos contextos iniciales en sucesión. El segundo contexto inicial reusará la conexión usada 
                    por la primera. Para ejecutar este programa y observar cómo las conexiones son recuperadas y devueltas a la 
                    agrupación, use la siguiente línea de comando.
                </p>
                <div class="codeblock">
                    <pre>
#java -Dcom.sun.jndi.ldap.connect.pool.debug=fine UsePool
                    </pre>
                </div>
                <p>
                    Esto debería producir una salida con el siguiente aspecto.
                </p>
                <div class="codeblock">
                    <pre>
Create com.sun.jndi.ldap.LdapClient@5d173[localhost:389]
Use com.sun.jndi.ldap.LdapClient@5d173
{ou=ou: NewHires, objectclass=objectClass: top, organizationalUnit}
Release com.sun.jndi.ldap.LdapClient@5d173
Use com.sun.jndi.ldap.LdapClient@5d173
{ou=ou: People, objectclass=objectClass: top, organizationalunit}
Release com.sun.jndi.ldap.LdapClient@5d173
                    </pre>
                </div>
                <p>
                    Puede decidir cuándo y dónde usar la agrupación incluyendo u omitiendo la propiedad 
                    <code>&quot;com.sun.jndi.ldap.connect.pool&quot;</code>, y así controlar la agrupación <em>por contexto</em>. 
                    En el ejemplo previo, si eliminó esta propiedad de las propiedades de entorno antes de crear el segundo 
                    contexto inicial, el segundo contexto inicial no usaría una agrupación de conexión.
                </p>
                <p>
                    El proveedor de LDAP realiza un seguimiento de si se está utilizando una conexión a través de las indicaciones 
                    de la aplicación. Se supone que una aplicación que mantiene un identificador de contexto abierto está 
                    utilizando la conexión. Por lo tanto, para que el proveedor LDAP gestione apropiadamente la agrupación de 
                    conexiones, debe ser diligente al invocar <code>Context.close()</code> en contextos que ya no necesita.
                </p>
                <p>
                    Las malas conexiones son automáticamente detectadas y eliminadas desde la agrupación por el proveedor LDAP. La 
                    probabilidad de que un contexto termine con una mala conexión es la misma independientemente de si se utiliza 
                    la agrupación de conexiones.
                </p>
                <h2>
                    <a id="TIMEOUT">Tiempo de espera de creación</a>
                </h2>
                <p>
                    La agrupación de conexiones mantenida por el proveedor de servicio LDAP puede ser limitada en tamaño; esto se 
                    describe en detalle en la sección 
                    <a class="TutorialLink" target="_top" href="config.html">Configuración de Agrupación de Conexiones</a>. Cuando 
                    la agrupación de conexiones ha sido habilitada y no hay conexión agrupada disponible, la aplicación cliente
                    se bloqueará, esperando por una conexión disponible. Puede usar la propiedad de entorno 
                    <code>&quot;com.sun.jndi.ldap.connect.timeout&quot;</code> para especificar cuanto tiempo esperar por una 
                    conexión agrupada. Si omite esta propiedad, la aplicación esperará indefinidamente. 
                </p>
                <p>
                    Esa misma propiedad se usa también para especificar un período de tiempo de espera para el establecimiento de 
                    la conexión LDAP, como se describe en la sección 
                    <a class="TutorialLink" target="_top" href="create.html#TIMEOUT">Creación</a>.
                </p>
                <h2>
                    ¡Cuándo no usar la agrupación!
                </h2>
                <p>
                    Las conexiones agrupadas están destinadas a ser reutilizadas. Por lo tanto, si su plan para realizar 
                    operaciones sobre una instancia <code>Context</code> que podría alterar el estado de la conexión subyacente, 
                    entonces no debería usar la agrupación de conexiones para esa instancia <code>Context</code>. Por ejemplo, 
                    si su plan es invocar la operación extendida Start TLS sobre una instancia <code>Context</code>, o planea 
                    cambiar las propiedades relacionadas con la seguridad (tales como 
                    <code>&quot;java.naming.security.principal&quot;</code> o
                    <code>&quot;java.naming.security.protocol&quot;</code>) después del contexto inicial ha sido creado, no 
                    debería usar la agrupación de conexión para esa instancia <code>Context</code> porque el proveedor LDAP no 
                    realiza un seguimiento de dichos cambios de estado. Si usa agrupación de conexiones en tales situaciones, 
                    podría estar comprometiendo la seguridad de su aplicación.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="close.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="config.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b>  Closing<br />
            <b>Página siguiente:</b> Configuración
        </div>
    </body>
</html> 
