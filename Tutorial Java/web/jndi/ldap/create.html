<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Creación (Los Tutoriales de Java&trade; &gt; Nombrado en Java e Interfaz de Directorio &gt; 
            Temas Avanzados para los Usuarios LDAP)
        </title>
        <meta name="description" content="Este tutorial de Java JNDI describe la tecnología de Nombrado en Java e Interfaz de 
              Directorio (JNDI), operaciones de nombre y directorio, y LDAP" />
        <meta name="keywords" content="java programming, learn java, java sample code, jndi, ldap, jndi service provider" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Temas Avanzados para los Usuarios LDAP</a></div>
                <div class="linkAHEAD"><a href="ldap.html">LDAP v3</a></div>
                <div class="linkAHEAD"><a href="jndi.html">JNDI como una IPA de LDAP</a></div>
                <div class="linkBHEAD"><a href="operations.html">Cómo las Operaciones LDAP se Mapean a las IPAs de JNDI</a></div>
                <div class="linkBHEAD"><a href="exceptions.html">Cómo los Códigos de Error LDAP se Mapean a las Excepciones de JNDI</a></div>
                <div class="linkAHEAD"><a href="security.html">Seguridad</a></div>
                <div class="linkBHEAD"><a href="authentication.html">Modos de Autenticación en LDAP</a></div>
                <div class="linkBHEAD"><a href="auth_mechs.html">Mecanismos de Autenticación</a></div>
                <div class="linkBHEAD"><a href="anonymous.html">Anónimo</a></div>
                <div class="linkBHEAD"><a href="simple.html">Simple</a></div>
                <div class="linkBHEAD"><a href="sasl.html">SASL</a></div>
                <div class="linkBHEAD"><a href="digest.html">Digest-MD5</a></div>
                <div class="linkBHEAD"><a href="ssl.html">SSL y Sockets Personalizados</a></div>
                <div class="linkAHEAD"><a href="rename.html">Más Operaciones LDAP</a></div>
                <div class="linkBHEAD"><a href="compare.html">Comparación LDAP</a></div>
                <div class="linkBHEAD"><a href="result.html">Resultados de la Búsqueda</a></div>
                <div class="linkBHEAD"><a href="unsol.html"> Notificaciones no Solicitadas de LDAP</a></div>
                <div class="linkAHEAD"><a href="connect.html">Gestión de Conexiones</a></div>
                <div class="nolinkBHEAD">Creación</div>
                <div class="linkBHEAD"><a href="close.html"> Cierre</a></div>
                <div class="linkBHEAD"><a href="pool.html">Agrupación (Pooling)</a></div>
                <div class="linkBHEAD"><a href="config.html">Configuración</a></div>
                <div class="linkAHEAD"><a href="faq.html">Preguntas Frecuentes</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Nombrado en Java e Interfaz de Directorio<br />
                <b>Lección:</b> Temas Avanzados para los Usuarios LDAP<br />
                <b>Sección:</b> Gestión de Conexiones
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Nombrado en Java e Interfaz de Directorio</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Temas Avanzados para los Usuarios LDAP</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="connect.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="close.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Creación</h1>
            </div>
            <div id="PageContent">
                <p>
                    Hay varias formas en las cuales se crean una conexión. La forma más común es desde la creación de un contexto 
                    inicial. Cuando crea un 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/InitialContext.html"><code>InitialContext</code>
                    </a>,
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/directory/InitialDirContext.html">
                        <code>InitialDirContext</code></a>, o un 
                    <a class="APILink" target="_blank"
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/ldap/InitialLdapContext.html">
                        <code>InitialLdapContext</code></a> usando el proveedor de servicio LDAP, se configura una conexión 
                    inmediatamente con el servidor LDAP objeto nombrado en la propiedad 
                    <a class="APILink" target="_blank"
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/Context.html#PROVIDER_URL">
                        <code>Context.PROVIDER_URL</code></a>. Cada vez que se crea un contexto inicial, se crea una nueva conexión 
                    LDAP. Vea la sección 
                    <a class="TutorialLink" target="_top" href="pool.html">Agrupación (Pooling)</a> para obtener información de 
                    cómo cambiar este comportamiento.
                </p>
                <p>
                    Si el valor de la propiedad contiene más de una URL, entonces cada URL se prueba sucesivamente hasta que se 
                    utilice una para crear una conexión exitosa. El valor de la propiedad se actualiza entonces para que sea la 
                    URL correcta. Vea el 
                    <a class="OutsideLink" target="_blank" 
                       href="https://docs.oracle.com/javase/jndi/tutorial/ldap/misc/url.html#MULTI">Tutorial JNDI</a> para un 
                    ejemplo de cómo crear un contexto inicial usando una lista de URLs.
                </p>
                <p>
                    Hay otras tres formas directas en las que se crea una conexión.
                </p>
                <ol>
                    <li>
                        Al pasar una URL como el argumento nombre al contexto inicial. Cuando una URL LDAP o LDAPS se pasa como un 
                        parámetro nombre al contexto inicial, la información en la URL se usa para crear una nueva conexión al 
                        servidor LDAP, independientemente de si la instancia del contexto inicial en sí misma tiene una conexión a 
                        un servidor LDAP. En realidad, el contexto inicial podría no estar conectado a ningún servidor. Vea el 
                        <a class="OutsideLink" target="_blank" 
                           href="https://docs.oracle.com/javase/jndi/tutorial/beyond/url/initctx.html">Tutorial JNDI</a> para más 
                        información sobre cómo se usan las URLs como nombres.
                    </li>
                    <li>
                        Otra forma en la que se crea una conexión es por el uso de una <code>Reference</code>. Cuando una 
                        <a class="APILink" target="_blank" 
                           href="https://docs.oracle.com/javase/8/docs/api/javax/naming/Reference.html"><code>Reference</code></a> 
                        contiene una URL LDAP o LDAPS se pasa a 
                        <a class="APILink" target="_blank" 
                           href="https://docs.oracle.com/javase/8/docs/api/javax/naming/spi/NamingManager.html#getObjectInstance-java.lang.Object-javax.naming.Name-javax.naming.Context-java.util.Hashtable-">
                            <code>NamingManager.getObjectInstance()</code></a> o a 
                        <a class="APILink" target="_blank" href="https://docs.oracle.com/javase/8/docs/api/javax/naming/spi/DirectoryManager.html#getObjectInstance-java.lang.Object-javax.naming.Name-javax.naming.Context-java.util.Hashtable-javax.naming.directory.Attributes-">
                            <code>DirectoryManager.getObjectInstance()</code></a>, se crea una nueva conexión usando la información 
                        especificada en la URL.
                    </li>
                    <li>
                        Finalmente, cuando una referencia se sigue manualmente o automáticamente, la información en la referencia 
                        se usa para crear una nueva conexión. Vea el 
                        <a class="OutsideLink" target="_blank" 
                           href="https://docs.oracle.com/javase/jndi/tutorial/ldap/referral/index.html">Tutorial JNDI</a> para 
                        obtener información sobre las referencias.
                    </li>
                </ol>
                <p>
                    <a id="SHARE"></a>
                </p>
                <h2>
                    Conexiones compartidas
                </h2>
                <p>
                    Las instancias <code>Context</code> y 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/NamingEnumeration.html">
                        <code>NamingEnumeration</code>s</a> que son derivadas desde una instancia <code>Context</code> comparten la 
                    misma conexión hasta que los cambios a una de las instancias <code>Context</code> hacen que el intercambio 
                    ya no sea posible. Por ejemplo, si invoca 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/Context.html#lookup-javax.naming.Name-">
                        <code>Context.lookup()</code></a>,
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/Context.html#listBindings-javax.naming.Name-">
                        <code>Context.listBindings()</code></a> o
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/directory/DirContext.html#search-javax.naming.Name-java.lang.String-javax.naming.directory.SearchControls-">
                        <code>DirContext.search()</code></a> desde el contexto inicial y obtiene de vuelta otras instancias 
                    <code>Context</code> , entonces todas aquellas instancias <code>Context</code> compartirán la misma 
                    conexión.
                </p>
                <p>
                    Aquí tiene 
                    <a class="SourceLink" target="_blank" 
                       href="examples/Shared.java" 
                       onclick="showCode('../../displayCode.html', 'examples/Shared.java'); return false;">
                        <code>un ejemplo</code></a>.
                </p>
                <div class="codeblock">
                    <pre>
// Create initial context
DirContext ctx = new InitialDirContext(env);

// Get a copy of the same context
Context ctx2 = (Context)ctx.lookup("");

// Get a child context
Context ctx3 = (Context) ctx.lookup("ou=NewHires");
                    </pre>
                </div>
                <p>
                    En este ejemplo, <code>ctx</code>, <code>ctx2</code>, y <code>ctx3</code> compartirán la misma conexión.
                </p>
                <p>
                    El uso compartido se realiza independientemente de cómo surgió la instancia <code>Context</code>. Por ejemplo, 
                    una instancia <code>Context</code> obtenida al seguir una referencia compartirá la misma conexión que la 
                    referencia.
                </p>
                <p>
                    Cuando cambia las propiedades de entorno de una instancia <code>Context</code> que están relacionadas con una 
                    conexión, tales como el nombre principal o las credenciales dle usuario, la instancia <code>Context</code> en 
                    la cual hace estos cambios obtendrá su propia conexión (si la conexión es compartida). Las instancias 
                    <code>Context</code> que se derivan de esta instancia <code>Context</code> en el futuro compartirán esta nueva 
                    conexión. Las instancias <code>Context</code> que previamente compartieron la conexión antigua no son afectadas 
                    (es decir, continúan usando la conexión antigua).
                </p>
                <p>
                    Aquí tiene 
                    <a class="SourceLink" target="_blank" 
                       href="examples/NewConn.java" 
                       onclick="showCode('../../displayCode.html', 'examples/NewConn.java'); return false;">
                        <code>un ejemplo</code></a> que usa dos conexiones.
                </p>
                <div class="codeblock">
                    <pre>
// Create initial context (first connection)
DirContext ctx = new InitialDirContext(env);

// Get a copy of the same context
DirContext ctx2 = (DirContext)ctx.lookup("");

// Change authentication properties in ctx2
ctx2.addToEnvironment(Context.SECURITY_PRINCIPAL, 
    "cn=C. User, ou=NewHires, o=JNDITutorial");
ctx2.addToEnvironment(Context.SECURITY_CREDENTIALS, "mysecret");

// Method on ctx2 will use new connection
System.out.println(ctx2.getAttributes("ou=NewHires"));
                    </pre>
                </div>
                <p>
                    <code>ctx2</code> inicialmente comparte la misma conexión con <code>ctx</code>. Pero cuando sus 
                    propiedades principal y contraseña se cambian, ya no puede usar más la conexión de <code>ctx</code>. El 
                    proveedor LDAP creará automáticamente una nueva conexión para <code>ctx2</code>.
                </p>
                <p>
                    Del mismo modo, si usa 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/javax/naming/ldap/LdapContext.html#reconnect-javax.naming.ldap.Control:A-">
                        <code>LdapContext.reconnect()</code></a> para cambiar los controles de la conexion de la instancia 
                    <code>Context</code>, la instancia <code>Context</code> obtendrá su propia conexión si la conexión estaba 
                    siendo compartida.
                </p>
                <p>
                    Si la conexión de la instancia <code>Context</code> no estaba siendo compartida (p.e., no se han derivado 
                    <code>Context</code>s de ella), entonces los cambios a su entorno o controles de conexión no causarán que se 
                    cree una nueva conexión. En vez de eso, cualquier cambio relevante a la conexión será aplicado a la conexión
                    existente.
                </p>
                <h2>
                    <a id="TIMEOUT">Tiempos de Espera de Creación</a>
                </h2>
                <p>
                    No todas las creaciones de conexión tienen éxito. Si el proveedor LDAP no puede establecer una conexión dentro 
                    de un cierto período de tiempo de espera, aborta el intento de conexión. De forma predeterminada, este período 
                    de tiempo de espera es el valor de tiempo de espera de la red (TCP), el cual está en el orden de unos pocos 
                    minutos. Para cambiar el período del tiempo de espera, use la propiedad de entorno 
                    <code>&quot;com.sun.jndi.ldap.connect.timeout&quot;</code>. El valor de esta propiedad es la representación en 
                    cadena de un entero que representa el tiempo en espera de la conexión en milisegundos.
                </p>
                <p>
                    Aquí tiene 
                    <a class="SourceLink" target="_blank" 
                       href="examples/Timeout.java" 
                       onclick="showCode('../../displayCode.html', 'examples/Timeout.java'); return false;">
                        <code>un ejemplo</code></a>.
                </p>
                <div class="codeblock">
                    <pre>
// Set up environment for creating initial context
Hashtable env = new Hashtable(11);
env.put(Context.INITIAL_CONTEXT_FACTORY, 
    "com.sun.jndi.ldap.LdapCtxFactory");
env.put(Context.PROVIDER_URL, "ldap://localhost:389/o=JNDITutorial");

// Specify timeout to be 5 seconds
env.put("com.sun.jndi.ldap.connect.timeout", "5000");

// Create initial context
DirContext ctx = new InitialDirContext(env);

// do something useful with ctx
                    </pre>
                </div>
                <p>
                    En este ejemplo, si una conexión no se puede crear en 5 segundos, se lanzará una excepción.
                </p>
                <p>
                    Si la propiedad <code>Context.PROVIDER_URL</code> contiene más de una URL, el proveedor usará el tiempo de 
                    espera para cada URL. Por ejemplo, si hay 3 URLs y el tiempo de espera ha sido especificado que sea 5 segundos, 
                    entonces el proveedor esperará por un máximo de 15 segundos en total.
                </p>
                <p>
                    Vea la sección 
                    <a class="TutorialLink" target="_top" href="pool.html#TIMEOUT">Agrupación de Conexiones</a> para obtener 
                    información de cómo esta propiedad afecta a la agrupación de conexiones.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="connect.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="close.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Gestión de Conexiones<br />
            <b>Página siguiente:</b>  Cierre
        </div>
    </body>
</html> 
