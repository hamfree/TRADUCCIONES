<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Leyendo de y Escribiendo a un Socket (Los Tutoriales de Java&trade; &gt; Personalizando la Red &gt; Todo Sobre Sockets)
        </title>
        <meta name="description" content="Este tutorial de Java sobre redes describe las capacidades de red de la plataforma Java, 
              trabajando con URL, sockets, datagramas y cookies." />
        <meta name="keywords" content="java programming, learn java, java sample code, java networking, java url, java socket,
              datagram, java cookie" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Todo Sobre Sockets</a></div>
                <div class="linkAHEAD"><a href="definition.html">¿Qué es un Socket?</a></div>
                <div class="nolinkAHEAD">Leyendo de y Escribiendo a un Socket</div>
                <div class="linkAHEAD"><a href="clientServer.html">Escribiendo el Lado del Servidor de un Socket</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Personalizando la Red<br />
                <b>Lección:</b> Todo Sobre Sockets
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Personalizando la Red</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Todo Sobre Sockets</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="definition.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="clientServer.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Leyendo de y Escribiendo a un Socket</h1>
            </div>
            <div id="PageContent">
                <p>
                    Veamos un ejemplo simple que ilustra cómo un programa puede establecer una conexión a un programa servidor 
                    usando la clase <code>Socket</code> y entonces, cómo el cliente puede enviar datos y recibir datos desde el 
                    servidor a través del socket.
                </p>
                <p>
                    El programa de ejemplo implementa un cliente, 
                    <a class="SourceLink" target="_blank" href="examples/EchoClient.java" 
                       onclick="showCode('../../displayCode.html', 'examples/EchoClient.java'); return false;">
                        <code>EchoClient</code></a>, que conecta a un servidor de eco. El servidor de eco recibe datos desde su 
                    cliente y los devuelve. El ejemplo 
                    <a class="SourceLink" target="_blank" href="examples/EchoServer.java" 
                       onclick="showCode('../../displayCode.html', 'examples/EchoServer.java'); return false;">
                        <code>EchoServer</code></a> implementa un servidor eco. (Alternativamente, el cliente puede conectar a 
                    cualquier máquina que soporte el <a href="http://tools.ietf.org/html/rfc862">Protocolo Echo</a>).
                </p>
                <p>
                    El ejemplo <code>EchoClient</code> crea un socket, obteniendo así una conexión al servidor de eco. Lee la 
                    entrada del usuario en el flujo de entrada estándar, y entonces reenvía ese texto al servidor de eco 
                    escribiendo el texto al socket. El servidor devuelve la entrada de vuelta a través del socket al cliente. El 
                    programa cliente lee y visualiza los datos que se le devuelven desde el servidor.
                </p>
                <p>
                    Note que el ejemplo <code>EchoClient</code> lee y escribe en su socket, enviando así datos y recibiendo datos 
                    del servidor de eco.
                </p>
                <p>
                    Repasemos el programa e investiguemos las partes interesantes. Las sentencias siguientes en la sentencia 
                    <a class="TutorialLink" target="_top" href="../../essential/exceptions/tryResourceClose.html">
                        <code>try</code>-with-resources</a> en el ejemplo <code>EchoClient</code> son críticas. Estas líneas 
                    establecen la conexión del socket entre el cliente y el servidor y abre un 
                    <a class="APILink" target="_blank" href="https://docs.oracle.com/javase/8/docs/api/java/io/PrintWriter.html">
                        <code>PrintWriter</code></a> y un 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/io/BufferedReader.html"><code>BufferedReader</code></a> 
                    en el socket:
                </p>
                <div class="codeblock">
                    <pre>
String hostName = args[0];
int portNumber = Integer.parseInt(args[1]);

try (
    Socket echoSocket = new Socket(hostName, portNumber);
    PrintWriter out =
        new PrintWriter(echoSocket.getOutputStream(), true);
    BufferedReader in =
        new BufferedReader(
            new InputStreamReader(echoSocket.getInputStream()));
    BufferedReader stdIn =
        new BufferedReader(
            new InputStreamReader(System.in))
)
                    </pre>
                </div>
                <p>
                    La primera sentencia en la sentencia <code>try</code>-with resources crea un nuevo objeto 
                    <a class="APILink" target="_blank" 
                       href="https://docs.oracle.com/javase/8/docs/api/java/net/Socket.html"><code>Socket</code></a> y lo nombra 
                    <code>echoSocket</code>. El constructor de <code>Socket</code> usado aquí requiere el nombre de la 
                    computadora y el número de puerto al cual quiere conectarse. El programa de ejemplo usa el primer 
                    <a class="TutorialLink" target="_top" 
                       href="../../essential/environment/cmdLineArgs.html">argumento de la línea de comandos</a> como el nombre de 
                    la computadora (el nombre del anfitrión) y el segundo argumento de la línea de comandos como el número de 
                    puerto. Cuando ejecuta este programa en su computadora, asegúrese de que el nombre de anfitrión que usa es el 
                    nombre IP completamente cualificado de la computadora a la cual quiere conectarse. Por ejemplo, si su 
                    servidor eco se está ejecutando en la computadora <code>echoserver.example.com</code> y está escuchando en 
                    el puerto número 7, primero ejecute el siguiente comando desde la computadora 
                    <code>echoserver.example.com</code> si quiere usar el ejemplo <code>EchoServer</code> como su servidor eco:
                </p>
                <div class="codeblock">
                    <pre>
java EchoServer 7
                    </pre>
                </div>
                <p>
                    Después, ejecute el ejemplo <code>EchoClient</code> con el comando siguiente:
                </p>
                <div class="codeblock">
                    <pre>
java EchoClient echoserver.example.com 7
                    </pre>
                </div>
                <p>
                    La segunda sentencia en la sentencia <code>try</code>-with resources obtiene el flujo de salida del socket y 
                    abre un <code>PrintWriter</code> en él. Del mismo modo, la tercera sentencia obtiene el flujo de entrada del 
                    socket y abre un <code>BufferedReader</code> en él. El ejemplo usa readers y writers de forma que puede escribir 
                    caracteres Unicode a través del socket.
                </p>
                <p>
                    Para enviar datos a través del socket al servidor, el ejemplo <code>EchoClient</code> necesita escribir al 
                    <code>PrintWriter</code>. Para obtener la respuesta del servidor, <code>EchoClient</code> lee desde el objeto 
                    <code>stdIn</code> de tipo <code>BufferedReader</code>, el cual es creado en la cuarta sentencia en la 
                    sentencia <code>try</code>-with resources. Si aún no está familiarizado con las clases de E/S de la plataforma 
                    Java, es posible que desee leer 
                    <a class="TutorialLink" target="_top" href="../../essential/io/index.html">E/S Básica</a>.
                </p>
                <p>
                    La siguiente parte interesante del programa es el bucle <code>while</code>. El bucle lee una línea cada vez 
                    desde el flujo de entrada estándar e inmediatamente lo manda al servidor escribiéndola en el 
                    <code>PrintWriter</code> conectado al socket:
                </p>
                <div class="codeblock">
                    <pre>
String userInput;
while ((userInput = stdIn.readLine()) != null) {
    out.println(userInput);
    System.out.println("echo: " + in.readLine());
}
                    </pre>
                </div>
                <p>
                    La última sentencia en el bucle <code>while</code> lee una línea de información del <code>BufferedReader</code> 
                    conectado al socket. El método <code>readLine</code> espera hasta que el servidor devuelve la información de 
                    vuelta a <code>EchoClient</code>. Cuando retorna <code>readline</code>, <code>EchoClient</code> imprime la 
                    información a la salida estándar.
                </p>
                <p>
                    El bucle <code>while</code> continúa hasta que el usuario teclea un carácter de fin-de-entrada. Esto es, el 
                    ejemplo <code>EchoClient</code> lee la entrada del usuario, la envía al servidor de eco, obtiene una respuesta 
                    desde el servidor, y la visualiza, hasta que alcance el fin-de-entrada. (Puede teclear un carácter 
                    fin-de-entrada al presionar <strong>Ctrl-C</strong>). El bucle <code>while</code> termina entonces, y el 
                    entorno de ejecución de Java automáticamente cierra los readers y writers conectados al socket y al flujo de 
                    entrada estándar, y cierra la conexión del socket al servidor. El entorno de ejecución de Java cierra estos 
                    recursos automáticamente porque fueron creados en la sentencia <code>try</code>-with-resources. El entorno de 
                    ejecución de Java cierra estos recursos en el orden inverso al que fueron creados. (Esto es bueno porque los 
                    flujos conectados a un socket deberían ser cerrados antes de que el propio socket se cierre).
                </p>
                <p>
                    Este programa cliente es sencillo y simple porque el servidor de eco implementa un protocolo simple. El cliente 
                    envía texto al servidor, y el servidor se lo devuelve. Cuando sus programas cliente están hablando a un 
                    servidor más complicado tal como un servidor HTTP, su programa cliente serán también más complicado. Sin 
                    embargo, los conceptos básicos son muy parecidos a los de este programa:
                </p>
                <ol>
                    <li>
                        Abra un socket.
                    </li>
                    <li>
                        Abra un flujo de entrada y un flujo de salida al socket.
                    </li>
                    <li>
                        Lea y escriba en el flujo de acuerdo con el protocolo del servidor.
                    </li>
                    <li>
                        Cierre los flujos.
                    </li>
                    <li>
                        Cierre el socket.
                    </li>
                </ol>
                <p>
                    Sólo el paso 3 difiere de cliente en cliente, dependiendo del servidor. Los otros pasos siguen siendo 
                    básicamente los mismos.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="definition.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="clientServer.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> ¿Qué es un Socket?<br />
            <b>Página siguiente:</b> Escribiendo el Lado del Servidor de un Socket
        </div>
    </body>
</html> 
