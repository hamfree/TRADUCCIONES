<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Código de Ejemplo (Los Tutoriales de Java&trade; &gt; IPA de Java para Procesado de XML (JAXP) &gt; 
            IPA de Transmisión para XML)
        </title>
        <meta name="description" content="Este tutorial de Java JAXP describe la IPA de Java para el procesado de XML (jaxp), XSLT, 
              SAX, y tópicos de XML relacionados" />
        <meta name="keywords" content="java programming, learn java, java sample code, jaxp, xml, xslt, sax" />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">IPA de Transmisión para XML</a></div>
                <div class="linkAHEAD"><a href="why.html">¿Porqué StAX?</a></div>
                <div class="linkAHEAD"><a href="api.html">IPA de StAX</a></div>
                <div class="linkAHEAD"><a href="using.html">Utilizando StAX</a></div>
                <div class="linkAHEAD"><a href="parser.html">Implementación del Analizador de Flujos XML de Oracle</a></div>
                <div class="nolinkAHEAD">Código de Ejemplo</div>
                <div class="linkAHEAD"><a href="info.html">Información Adicional</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> IPA de Java para Procesado de XML (JAXP)<br />
                <b>Lección:</b> IPA de Transmisión para XML
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">IPA de Java para Procesado de XML (JAXP)</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">IPA de Transmisión para XML</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="parser.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="info.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Código de Ejemplo</h1>
            </div>
            <div id="PageContent">
                <p>
                    <a id="indexterm-48"></a><a id="indexterm-49"></a>
                </p>
                <p>
                    Esta sección describe paso a paso el código StAX de ejemplo incluído en el paquete implementación de referencia 
                    de JAXP. Todos los directorios del ejemplo usado en esta sección están ubicados en el directorio 
                    <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax</code>.
                </p>
                <p>
                    Los temas cubiertos en esta sección son los siguientes:
                </p>
                <ul>
                    <li>
                        <p>
                            <a href="#bnbfm">Organización del Código de Ejemplo</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbfn">Ejemplo de Documento XML</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbfo">Ejemplo de Cursor</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbft">Ejemplo Cursor-a-Evento</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbfz">Ejemplo Evento</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbgh">Ejemplo Filtro</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbgq">Ejemplo Leer-Y-Escribir</a>
                        </p>
                    </li>
                    <li>
                        <p>
                            <a href="#bnbgx">Ejemplo Writer</a>
                        </p>
                    </li>
                </ul>
                <p>
                    <a id="bnbfm"></a>
                </p>
                <h2>
                    Organización del Código de Ejemplo
                </h2>
                <p>
                    El directorio <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax</code> contiene los seis 
                    directorios de ejemplos de StAX:
                </p>
                <ul>
                    <li>
                        <p>
                            <b>Ejemplo Cursor</b>: El directorio <code>cursor</code> contiene <code>CursorParse.java</code>, que 
                            ilustra cómo usar la IPA de <code>XMLStreamReader</code> (cursor) para leer un fichero XML.
                        </p>
                    </li>
                    <li>
                        <p>
                            <b>Ejemplo Cursor-a-Evento</b>: El directorio <code>cursor2event</code> contiene 
                            <code>CursorApproachEventObject.java</code>, que ilustra cómo una aplicación puede obtener información 
                            como un objeto <code>XMLEvent</code> cuando se usa la IPA de cursor.
                        </p>
                    </li>
                    <li>
                        <p>
                            <b>Ejemplo Evento</b>: El directorio <code>event</code> contiene <code>EventParse.java</code>, que 
                            ilustra cómo usar la IPA de <code>XMLEventReader</code> (iterador de eventos) para leer un fichero XML.
                        </p>
                    </li>
                    <li>
                        <p>
                            <b>Ejemplo Filtro</b>: El directorio <code>filter</code> contiene <code>MyStreamFilter.java</code>, 
                            que ilustra cómo usar las IPAs de Filtro de Flujo de StAX. En este ejemplo, el filtro acepta sólo los 
                            eventos <code>StartElement</code> y <code>EndElement</code>, y filtra el resto de eventos.
                        </p>
                    </li>
                    <li>
                        <p>
                            <b>Ejemplo Leer-y-Escribir</b>: El directorio <code>readnwrite</code> contiene 
                            <code>EventProducerConsumer.java</code>, que ilustra cómo puede usarse el mecanismo productor/consumidor 
                            de StAX para leer y escribir simultáneamente flujos XML.
                        </p>
                    </li>
                    <li>
                        <p>
                            <b>Ejemplo Writer</b>: El directorio <code>writer</code> contiene <code>CursorWriter.java</code>, que 
                            ilustra cómo usar <code>XMLStreamWriter</code> para escribir un fichero XML mediante programación.
                        </p>
                    </li>
                </ul>
                <p>
                    Todos los ejemplos de StAX excepto el ejemplo Writer usan un documento XML de ejemplo, 
                    <code>BookCatalog.xml</code>.
                </p>
                <p>
                    <a id="bnbfn"></a>
                </p>
                <h2>
                    Ejemplo de Documento XML
                </h2>
                <p>
                    El ejemplo de documento XML, <code>BookCatalog.xml</code>,  usando por la mayoría de las clases de ejemplo de 
                    StAX, es un catálogo de libros simple basado en el espacio de nombres común <code>BookCatalogue</code>. Los 
                    contenidos de <code>BookCatalog.xml</code> se listan debajo:
                </p>
                <div class="codeblock">
                    <pre>
&lt;?xml version="1.0" encoding="UTF-8"?>
&lt;BookCatalogue xmlns="http://www.publishing.org">
&lt;Book>
    &lt;Title>Yogasana Vijnana: the Science of Yoga&lt;/Title>
    &lt;author>Dhirendra Brahmachari&lt;/Author>
    &lt;Date>1966&lt;/Date>
    &lt;ISBN>81-40-34319-4&lt;/ISBN>
    &lt;Publisher>Dhirendra Yoga Publications&lt;/Publisher>
    &lt;Cost currency="INR">11.50&lt;/Cost>
&lt;/Book>
&lt;Book>
    &lt;Title>The First and Last Freedom&lt;/Title>
    &lt;Author>J. Krishnamurti&lt;/Author>
    &lt;Date>1954&lt;/Date>
    &lt;ISBN>0-06-064831-7&lt;/ISBN>
    &lt;Publisher>Harper &amp;amp; Row&lt;/Publisher>
    &lt;Cost currency="USD">2.95&lt;/Cost>
&lt;/Book>
&lt;/BookCatalogue>
                    </pre>
                </div>
                <p>
                    <a id="bnbfo"></a>
                </p>
                <h2>
                    Ejemplo de Cursor
                </h2>
                <p>
                    <a id="indexterm-50"></a><a id="indexterm-51"></a>
                </p>
                <p>
                    Ubicado en el directorio <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax/cursor/</code>, 
                    <code>CursorParse.java</code> demuestra el uso de la IPA de cursor de StAX para leer un documento XML. En el 
                    ejemplo Cursor, la aplicación instruye al analizador para que lea el siguiente evento en el flujo de entrada 
                    XML llamando a <code>next()</code>.
                </p>
                <p>
                    Tenga en cuenta que <code>next()</code> simplemente devuelve una constante entera correspondiente a un evento 
                    subyacente donde se posiciona el analizador. La aplicación necesita llamar a la función relevante para obtener 
                    más información relacionada con el evento subyaciente.
                </p>
                <p>
                    Puede imaginar este enfoque como un cursor virtual que se mueve a través del flujo de entrada XML. Hay varios 
                    métodos de acceso que se pueden llamar cuando ese cursor virtual está en un evento en particular.
                </p>
                <p>
                    <a id="bnbfp"></a>
                </p>
                <h3>
                    Pasando por Eventos
                </h3>
                <p>
                    En este ejemplo, la aplicación cliente extrae el evento siguiente en el flujo XML llamando al método 
                    <code>next</code> en el analizador, por ejemplo:
                </p>
                <div class="codeblock">
                    <pre>
try {
    for (int i = 0 ; i &lt; count ; i++) {
        // pass the file name.. all relative entity
        // references will be resolved against this 
        // as base URI.
        XMLStreamReader xmlr = xmlif.createXMLStreamReader(filename,
                                   new FileInputStream(filename));

        // when XMLStreamReader is created, 
        // it is positioned at START_DOCUMENT event.
        int eventType = xmlr.getEventType();
        printEventType(eventType);
        printStartDocument(xmlr);

        // check if there are more events 
        // in the input stream
        while(xmlr.hasNext()) {
            eventType = xmlr.next();
            printEventType(eventType);

            // these functions print the information 
            // about the particular event by calling 
            // the relevant function
            printStartElement(xmlr);
            printEndElement(xmlr);
            printText(xmlr);
            printPIData(xmlr);
            printComment(xmlr);
        }
    }
}
                    </pre>
                </div>
                <p>
                    Tenga en cuenta que <code>next()</code> simplemente devuelve una constante entera correspondiente a un evento 
                    subyacente donde se posiciona el analizador. La aplicación necesita llamar a la función relevante para obtener 
                    más información relacionada con el evento subyaciente.
                </p>
                <p>
                    <a id="bnbfq"></a>
                </p>
                <h3>
                    Devolución de Representaciones de Cadenas
                </h3>
                <p>
                    Ya que el método <code>next</code> sólo devuelve enteros correspondientes a los tipos de eventos subyacentes, 
                    habitualmente necesita asignar estos enteros a representaciones de cadena de los eventos, por ejemplo:
                </p>
                <div class="codeblock">
                    <pre>
public final static String getEventTypeString(int eventType) {
    switch (eventType) {
        case XMLEvent.START_ELEMENT:
            return "START_ELEMENT";

        case XMLEvent.END_ELEMENT:
            return "END_ELEMENT";

        case XMLEvent.PROCESSING_INSTRUCTION:
            return "PROCESSING_INSTRUCTION";

        case XMLEvent.CHARACTERS:
            return "CHARACTERS";

        case XMLEvent.COMMENT:
            return "COMMENT";

        case XMLEvent.START_DOCUMENT:
            return "START_DOCUMENT";

        case XMLEvent.END_DOCUMENT:
            return "END_DOCUMENT";

        case XMLEvent.ENTITY_REFERENCE:
            return "ENTITY_REFERENCE";

        case XMLEvent.ATTRIBUTE:
            return "ATTRIBUTE";

        case XMLEvent.DTD:
            return "DTD";

        case XMLEvent.CDATA:
            return "CDATA";

        case XMLEvent.SPACE:
            return "SPACE";
    }
    return "UNKNOWN_EVENT_TYPE , " + eventType;
}
                    </pre>
                </div>
                <p>
                    <a id="gfyfg"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo Cursor
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo del cursor, en una ventana terminal, vaya al directorio 
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee lo siguiente:
                        </b>
                        <div class="codeblock">
                            <pre>
javac stax/cursor/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>CursorParse</code> sobre el fichero <code>BookCatalogue.xml</code>, con el 
                            siguiente comando.</b>
                        <p>
                            <code>CursorParse</code> imprimirá cada elemento del fichero <code>BookCatalogue.xml</code>.
                        </p>
                    </li>
                </ol>
                <div class="codeblock">
                    <pre>
java stax/event/CursorParse stax/data/BookCatalogue.xml
                    </pre>
                </div>
                <p>
                    <a id="bnbft"></a>
                </p>
                <h2>
                    Ejemplo Cursor-a-Evento
                </h2>
                <p>
                    <a id="indexterm-52"></a><a id="indexterm-53"></a>
                </p>
                <p>
                    Ubicada en el directorio <i>tut-install</i><code>/javaeetutorial5/examples/stax/cursor2event/</code>, 
                    <code>CursorApproachEventObject.java</code> demuestra cómo obtener información devuelta por un objeto 
                    <code>XMLEvent</code> incluso cuando usa la IPA de cursor.
                </p>
                <p>
                    La idea aquí es que <code>XMLStreamReader</code> de la IPA de cursor devuelve constantes enteras que se 
                    corresponden con eventos particulares, mientras que <code>XMLEventReader</code> de la IPA de iterador de 
                    eventos devuelve objetos evento inmutables y persistentes. <code>XMLStreamReader</code> es más eficiente, pero 
                    <code>XMLEventReader</code> es más fácil de usar, porque toda la información relacionada con un evento 
                    particular está encapsulada en un objeto <code>XMLEvent</code> devuelto. Sin embargo, la desventaja del enfoque 
                    de eventos es la sobrecarga extra de crear objetos para cada evento, lo que consume tiempo y memoria.
                </p>
                <p>
                    Con esto en mente, se puede usar <code>XMLEventAllocator</code> para obtener información del evento como un 
                    objeto <code>XMLEvent</code>, incluso cuando se usa la IPA de cursor.
                </p>
                <p>
                    <a id="bnbfu"></a>
                </p>
                <h3>
                    Instanciar un XMLEventAllocator
                </h3>
                <p>
                    <a id="indexterm-54"></a>
                </p>
                <p>
                    El primer paso es crear una nueva <code>XMLInputFactory</code> e instanciar un <code>XMLEventAllocator</code>:
                </p>
                <div class="codeblock">
                    <pre>
XMLInputFactory xmlif = XMLInputFactory.newInstance();
System.out.println("FACTORY: " + xmlif);
xmlif.setEventAllocator(new XMLEventAllocatorImpl());
allocator = xmlif.getEventAllocator();
XMLStreamReader xmlr = xmlif.createXMLStreamReader(filename,
                           new FileInputStream(filename));
                    </pre>
                </div>
                <p>
                    <a id="bnbfv"></a>
                </p>
                <h3>
                    Crear un Evento Iterador (Iterator)
                </h3>
                <p>
                    El siguiente paso es crear un iterador de eventos:
                </p>
                <div class="codeblock">
                    <pre>
int eventType = xmlr.getEventType();

while (xmlr.hasNext()) {
    eventType = xmlr.next();
    // Get all "Book" elements as XMLEvent object
    if (eventType == XMLStreamConstants.START_ELEMENT 
        &amp;&amp; xmlr.getLocalName().equals("Book")) {
        // get immutable XMLEvent
        StartElement event = getXMLEvent(xmlr).asStartElement();
        System.out.println ("EVENT: " + event.toString());
    }
}
                    </pre>
                </div>
                <p>
                    <a id="bnbfw"></a>
                </p>
                <h3>
                    Crear el Método Allocator
                </h3>
                <p>
                    El paso final es crear el método <code>XMLEventAllocator</code>:
                </p>
                <div class="codeblock">
                    <pre>
private static XMLEvent getXMLEvent(XMLStreamReader reader)
    throws XMLStreamException {
    return allocator.allocate(reader);
}
                    </pre>
                </div>
                <p>
                    <a id="gfyeb"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo Cursor-a-Evento
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo cursor-a-evento, en una ventana terminal, vaya al directorio 
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee lo siguiente:</b>
                        <div class="codeblock">
                            <pre>
javac -classpath ../lib/jaxp-ri.jar stax/cursor2event/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>CursorApproachEventObject</code> sobre el fichero 
                            <code>BookCatalogue.xml</code>, con el siguiente comando.</b>
                        <div class="codeblock">
                            <pre>
java stax/cursor2event/CursorApproachEventObject stax/data/BookCatalogue.xml
                            </pre>
                        </div>
                        <p>
                            <code>CursorApproachEventObject</code> imprimirá la lista de eventos definidos por el fichero 
                            <code>BookCatalogue.xml</code>.
                        </p>
                    </li>
                </ol>
                <p>
                    <a id="bnbfz"></a>
                </p>
                <h2>
                    Ejemplo Evento
                </h2>
                <p>
                    <a id="indexterm-55"></a><a id="indexterm-56"></a>
                </p>
                <p>
                    Ubicado en el directorio <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax/event/</code>, 
                    <code>EventParse.java</code> demuestra como usar la IPA de evento de StAX para leer un documento XML.
                </p>
                <p>
                    <a id="bnbga"></a>
                </p>
                <h3>
                    Crear una Factoría de Entrada
                </h3>
                <p>
                    El primer paso es crear una nueva instancia de <code>XMLInputFactory</code>:
                </p>
                <div class="codeblock">
                    <pre>
XMLInputFactory factory = XMLInputFactory.newInstance();
System.out.println("FACTORY: " + factory);
                    </pre>
                </div>
                <p>
                    <a id="bnbgb"></a>
                </p>
                <h3>
                    Crear un Lector de Eventos
                </h3>
                <p>
                    El siguiente paso es crear una instancia de <code>XMLEventReader</code>:
                </p>
                <div class="codeblock">
                    <pre>
XMLEventReader r = factory.createXMLEventReader
                       (filename, new FileInputStream(filename));
                    </pre>
                </div>
                <p>
                    <a id="bnbgc"></a>
                </p>
                <h3>
                    Crear un Iterador de Eventos
                </h3>
                <p>
                    El tercer paso es crear un iterador de eventos:
                </p>
                <div class="codeblock">
                    <pre>
XMLEventReader r = factory.createXMLEventReader
                       (filename, new FileInputStream(filename));
while (r.hasNext()) {
    XMLEvent e = r.nextEvent();
    System.out.println(e.toString());
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgd"></a>
                </p>
                <h3>
                    Obtener el Flujo de Eventos
                </h3>
                <p>
                    El paso final es obtener el flujo de eventos subyacente:
                </p>
                <div class="codeblock">
                    <pre>
public final static String getEventTypeString(int eventType) {
    switch (eventType) {
        case XMLEvent.START_ELEMENT:
            return "START_ELEMENT";

        case XMLEvent.END_ELEMENT:
            return "END_ELEMENT";

        case XMLEvent.PROCESSING_INSTRUCTION:
            return "PROCESSING_INSTRUCTION";

        case XMLEvent.CHARACTERS:
            return "CHARACTERS";

        case XMLEvent.COMMENT:
            return "COMMENT";

        case XMLEvent.START_DOCUMENT:
            return "START_DOCUMENT";

        case XMLEvent.END_DOCUMENT:
            return "END_DOCUMENT";

        case XMLEvent.ENTITY_REFERENCE:
            return "ENTITY_REFERENCE";

        case XMLEvent.ATTRIBUTE:
            return "ATTRIBUTE";

        case XMLEvent.DTD:
            return "DTD";

        case XMLEvent.CDATA:
            return "CDATA";

        case XMLEvent.SPACE:
            return "SPACE";
    }
    return "UNKNOWN_EVENT_TYPE," + eventType;
}
                    </pre>
                </div>
                <p>
                    <a id="bnbge"></a>
                </p>
                <h3>
                    Devolver la Salida
                </h3>
                <p>
                    Cuando ejecuta el ejemplo Evento, la clase <code>EventParse</code> se compila, y el flujo XML es analizado 
                    como eventos y devueltos a <code>STDOUT</code>. Por ejemplo, una instancia de elemento <code>Author</code> se 
                    devuelve como:
                </p>
                <div class="codeblock">
                    <pre>
&lt;[&rsquo;http://www.publishing.org&rsquo;]::Author>
    Dhirendra Brahmachari
&lt;/[&rsquo;http://www.publishing.org&rsquo;]::Author>
                    </pre>
                </div>
                <p>
                    Tenga en cuenta que en este ejemplo que el evento comprende una etiqueta de apertura y cierre, las cuales 
                    incluyen el espacio de nombres. El contenido del elemento se devuelve como una cadena dentro de las etiquetas.
                </p>
                <p>
                    De maner similar, una instancia del elemento <code>Cost</code> se devuelve como:
                </p>
                <div class="codeblock">
                    <pre>
&lt;[&rsquo;http://www.publishing.org&rsquo;]::Cost currency=&rsquo;INR&rsquo;>
    11.50
&lt;/[&rsquo;http://www.publishing.org&rsquo;]::Cost
                    </pre>
                </div>
                <p>
                    En este caso, el atributo <code>currency</code> y el valor son devueltos en la etiqueta de apertura para el 
                    evento.
                </p>
                <p>
                    <a id="gfyek"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo de Evento
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo evento, en una ventana terminal, vaya al directorio 
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee lo siguiente:</b>
                        <div class="codeblock">
                            <pre>
javac -classpath ../lib/jaxp-ri.jar stax/event/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>EventParse</code> sobre el fichero <code>BookCatalogue.xml</code>, con el 
                            comando siguiente.</b>
                        <div class="codeblock">
                            <pre>
java stax/event/EventParse stax/data/BookCatalogue.xml
                            </pre>
                        </div>
                        <p>
                            <code>EventParse</code> imprimirá los deatos de todos los elementos definidos por el fichero 
                            <code>BookCatalogue.xml</code>.
                        </p>
                    </li>
                </ol>
                <p>
                    <a id="bnbgh"></a>
                </p>
                <h2>
                    Ejemplo Filtro
                </h2>
                <p>
                    <a id="indexterm-57"></a><a id="indexterm-58"></a>
                </p>
                <p>
                    Ubicado en el directorio <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax/filter/</code>, 
                    <code>MyStreamFilter.java</code> demuestra cómo usar la IPA de filtro de flujo de StAX para filtrar eventos no 
                    necesitados por su aplicación. En este ejemplo, el analizador filtra todos los eventos excepto 
                    <code>StartElement</code> y <code>EndElement</code>.
                </p>
                <p>
                    <a id="bnbgi"></a>
                </p>
                <h3>
                    Implementar la Clase StreamFilter
                </h3>
                <p>
                    La clase <code>MyStreamFilter</code> implementa <code>javax.xml.stream.StreamFilter</code>:
                </p>
                <div class="codeblock">
                    <pre>
public class MyStreamFilter implements javax.xml.stream.StreamFilter {
    // ...
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgj"></a>
                </p>
                <h3>
                    Crear una Factoría de Entrada
                </h3>
                <p>
                    El siguiente paso es crear una instancia de <code>XMLInputFactory</code>. En este caso, varias propiedades son 
                    también establecidas en la factoría:
                </p>
                <div class="codeblock">
                    <pre>
XMLInputFactory xmlif = null ;

try {
    xmlif = XMLInputFactory.newInstance();
    xmlif.setProperty(
        XMLInputFactory.IS_REPLACING_ENTITY_REFERENCES,
        Boolean.TRUE);

    xmlif.setProperty(
        XMLInputFactory.IS_SUPPORTING_EXTERNAL_ENTITIES,
        Boolean.FALSE);

    xmlif.setProperty(
        XMLInputFactory.IS_NAMESPACE_AWARE,
        Boolean.TRUE);

    xmlif.setProperty(
        XMLInputFactory.IS_COALESCING,
        Boolean.TRUE);
} 
catch (Exception ex) {
    ex.printStackTrace();
}

System.out.println("FACTORY: " + xmlif);
System.out.println("filename = "+ filename);
                    </pre>
                </div>
                <p>
                    <a id="bnbgk"></a>
                </p>
                <h3>
                    Crear el Filtro
                </h3>
                <p>
                    El siguiente paso es instanciar un flujo de entrada de fichero y crear el filtro de flujo:
                </p>
                <div class="codeblock">
                    <pre>
FileInputStream fis = new FileInputStream(filename);
XMLStreamReader xmlr = xmlif.createFilteredReader(
                           xmlif.createXMLStreamReader(fis), 
                           new MyStreamFilter());

int eventType = xmlr.getEventType();
printEventType(eventType);

while (xmlr.hasNext()) {
    eventType = xmlr.next();
    printEventType(eventType);
    printName(xmlr,eventType);
    printText(xmlr);

    if (xmlr.isStartElement()) {
        printAttributes(xmlr);
    }
    printPIData(xmlr);
    System.out.println("-----------------------");
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgl"></a>
                </p>
                <h3>
                    Capturar el Flujo de Eventos
                </h3>
                <p>
                    El siguiente paso es capturar el flujo de evnetos. Esto se hace básicamente de la misma forma que en el ejemplo 
                    Evento.
                </p>
                <p>
                    <a id="bnbgm"></a>
                </p>
                <h3>
                    Filtrar el Flujo
                </h3>
                <p>
                    El paso final es filtrar el flujo:
                </p>
                <div class="codeblock">
                    <pre>
public boolean accept(XMLStreamReader reader) {
    if (!reader.isStartElement() &amp;&amp; !reader.isEndElement())
        return false;
    else
        return true;
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgn"></a>
                </p>
                <h3>
                    Devolver la Salida
                </h3>
                <p>
                    Cuando ejecuta el ejemplo Filtro, la clase <code>MyStreamFilter</code> se compila, y el flujo XML se analiza 
                    como eventos y devueltos a <code>STDOUT</code>. Por ejemplo, un evento <code>Author</code> se devuelve como 
                    sigue:
                </p>
                <div class="codeblock">
                    <pre>
EVENT TYPE(1):START_ELEMENT
HAS NAME: Author
HAS NO TEXT
HAS NO ATTRIBUTES
-----------------------------
EVENT TYPE(2):END_ELEMENT
HAS NAME: Author
HAS NO TEXT
-----------------------------
                    </pre>
                </div>
                <p>
                    Del mismo modo, un evento <code>Cost</code> se devuelve como sigue:
                </p>
                <div class="codeblock">
                    <pre>
EVENT TYPE(1):START_ELEMENT
HAS NAME: Cost
HAS NO TEXT

HAS ATTRIBUTES:
 ATTRIBUTE-PREFIX:
 ATTRIBUTE-NAMESP: null
ATTRIBUTE-NAME:   currency
ATTRIBUTE-VALUE: USD
ATTRIBUTE-TYPE:  CDATA

-----------------------------
EVENT TYPE(2):END_ELEMENT
HAS NAME: Cost
HAS NO TEXT
-----------------------------
                    </pre>
                </div>
                <p>
                    Vea 
                    <a class="TutorialLink" target="_top" href="api.html#bnbee">IPA del Iterador</a> y 
                    <a class="TutorialLink" target="_top" href="using.html#bnbew">Leer Flujos XML</a> para una descripción más 
                    detallada del análisis de eventos de StAX.
                </p>
                <p>
                    <a id="gfygs"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo Filtro
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo evento, en una ventana terminal, vaya al directorio 
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee lo siguiente:</b>
                        <div class="codeblock">
                            <pre>
javac -classpath ../lib/jaxp-ri.jar stax/filter/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>MyStreamFilter</code> sobre el fichero <code>BookCatalogue.xml</code>, con el 
                            comando siguiente. Este ejemplo requiere que se establezca la propiedad del sistema 
                            <code>java.endorsed.dirs</code> para que apunte al directorio <code>samples/lib</code>.</b>
                        <div class="codeblock">
                            <pre>
java -Djava.endorsed.dirs=../lib stax/filter/MyStreamFilter -f stax/data/BookCatalogue.xml
                            </pre>
                        </div>
                        <p>
                            <code>MyStreamFilter</code> imprimirá los eventos definidos por el fichero 
                            <code>BookCatalogue.xml</code> como un flujo XML.
                        </p>
                    </li>
                </ol>
                <p>
                    <a id="bnbgq"></a>
                </p>
                <h2>
                    Ejemplo Leer-Y-Escribir
                </h2>
                <p>
                    <a id="indexterm-59"></a><a id="indexterm-60"></a>
                </p>
                <p>
                    Ubicado en el directorio 
                    <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax/readnwrite/</code>, 
                    <code>EventProducerConsumer.java</code> demuestra cómo usar un analizador StAX simultáneamente como productor y 
                    consumidor.
                </p>
                <p>
                    La IPA de <code>XMLEventWriter</code> de StAX se extiende desde la interfaz <code>XMLEventConsumer</code>, y 
                    se denomina <b>consumidor de eventos</b>. Por contraste, <code>XMLEventReader</code> es un 
                    <b>productor de eventos</b>. StAX admite lectura y escritura simultáneas, de modo que es posible leer de un 
                    flujo XML de forma secuencial y escribir simultáneamente en otro flujo.
                </p>
                <p>
                    El ejemplo Leer-y-Escribir muestra como se puede usar el mecanismo productor/consumidor de StAX para leer y 
                    escribir simultáneamente. Este ejemplo también muestra cómo se puede modificar un flujo y cómo se pueden 
                    agregar nuevos eventos de forma dinámica y luego escribirlos a un flujo diferente.
                </p>
                <p>
                    <a id="bnbgr"></a>
                </p>
                <h3>
                    Crear un Evento Productor/Consumidor
                </h3>
                <p>
                    El primer paso es instanciar una factoría de eventos y luego crear una instancia de un productor/consumidor de 
                    eventos:
                </p>
                <div class="codeblock">
                    <pre>
XMLEventFactory m_eventFactory = XMLEventFactory.newInstance();

public EventProducerConsumer() {
    // ...
    try {
        EventProducerConsumer ms = new EventProducerConsumer();
    
        XMLEventReader reader = XMLInputFactory.newInstance().
        createXMLEventReader(new java.io.FileInputStream(args[0]));
    
        XMLEventWriter writer = 
            XMLOutputFactory.newInstance().createXMLEventWriter(System.out);
    }
    // ...
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgs"></a>
                </p>
                <h3>
                    Crear un Iterador
                </h3>
                <p>
                    El siguiente paso es crear un iterador para analizar el flujo:
                </p>
                <div class="codeblock">
                    <pre>
while (reader.hasNext()) {
    XMLEvent event = (XMLEvent)reader.next();
    if (event.getEventType() == event.CHARACTERS) {
        writer.add(ms.getNewCharactersEvent(event.asCharacters()));
    }
    else {
        writer.add(event);
    }
}
writer.flush();
                    </pre>
                </div>
                <p>
                    <a id="bnbgt"></a>
                </p>
                <h3>
                    Crear un Escritor (Writer)
                </h3>
                <p>
                    El paso final es crear un escritor de flujo en la forma de un nuevo evento <code>Character</code>:
                </p>
                <div class="codeblock">
                    <pre>
Characters getNewCharactersEvent(Characters event) {
    if (event.getData().equalsIgnoreCase("Name1")) {
        return m_eventFactory.createCharacters(
                   Calendar.getInstance().getTime().toString());
    }
    // else return the same event
    else {
        return event;
    }
}
                    </pre>
                </div>
                <p>
                    <a id="bnbgu"></a>
                </p>
                <h3>
                    Devolver la Salida
                </h3>
                <p>
                    Cuando ejecuta el ejemplo Leer-y-Escribir, la clase <code>EventProducerConsumer</code> se compila, y el flujo 
                    XML es analizado como eventos y escritos de vuelta a <code>STDOUT</code>. La salida son los contenidos del 
                    fichero <code>BookCatalog.xml</code> descrito en <a href="#bnbfn">Documento de Ejemplo XML</a>.
                </p>
                <p>
                    <a id="gfyfk"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo Leer-y-Escribir
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo Leer-y-Escribir, en una ventana terminal, vaya al directorio 
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee el siguiente 
                            comando:</b>
                        <div class="codeblock">
                            <pre>
javac -classpath ../lib/jaxp-ri.jar stax/readnwrite/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>EventProducerConsumer</code> sobre el fichero <code>BookCatalogue.xml</code>, 
                            con el comando siguiente.</b>
                        <div class="codeblock">
                            <pre>
java stax/readnwrite/EventProducerConsumer stax/data/BookCatalogue.xml
                            </pre>
                        </div>
                        <p>
                            <code>EventProducerConsumer</code> imprimirá el contenido del fichero <code>BookCatalogue.xml</code>.
                        </p>
                    </li>
                </ol>
                <p>
                    <a id="bnbgx"></a>
                </p>
                <h2>
                    Ejemplo Writer
                </h2>
                <p>
                    <a id="indexterm-61"></a><a id="indexterm-62"></a>
                </p>
                <p>
                    Ubicado en el directorio <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/stax/writer/</code>, 
                    <code>CursorWriter.java</code> demuestra cómo usar la IPA de cursor de StAX para escribir un flujo XML.
                </p>
                <p>
                    <a id="bnbgy"></a>
                </p>
                <h3>
                    Crear la Factoría de Salida
                </h3>
                <p>
                    El primer paso es crear una instancia de <code>XMLOutputFactory</code>:
                </p>
                <div class="codeblock">
                    <pre>
XMLOutputFactory xof =  XMLOutputFactory.newInstance();
                    </pre>
                </div>
                <p>
                    <a id="bnbgz"></a>
                </p>
                <h3>
                    Crear un Escritor de Flujo (Stream Writer)
                </h3>
                <p>
                    El siguiente paso es crear una instancia de <code>XMLStreamWriter</code>:
                </p>
                <div class="codeblock">
                    <pre>
XMLStreamWriter xtw = null;
                    </pre>
                </div>
                <p>
                    <a id="bnbha"></a>
                </p>
                <h3>
                    Escribir el Flujo
                </h3>
                <p>
                    El paso final es escribir el flujo XML. Tenga en cuenta que el flujo es vaciado y cerrado después de que se 
                    escriba el <code>EndDocument</code> final:
                </p>
                <div class="codeblock">
                    <pre>
xtw = xof.createXMLStreamWriter(new FileWriter(fileName));

xtw.writeComment("all elements here are explicitly in the HTML namespace");
xtw.writeStartDocument("utf-8","1.0");
xtw.setPrefix("html", "http://www.w3.org/TR/REC-html40");
xtw.writeStartElement("http://www.w3.org/TR/REC-html40","html");
xtw.writeNamespace("html", "http://www.w3.org/TR/REC-html40");
xtw.writeStartElement("http://www.w3.org/TR/REC-html40", "head");
xtw.writeStartElement("http://www.w3.org/TR/REC-html40", "title");
xtw.writeCharacters("Frobnostication");
xtw.writeEndElement();
xtw.writeEndElement();

xtw.writeStartElement("http://www.w3.org/TR/REC-html40", "body");
xtw.writeStartElement("http://www.w3.org/TR/REC-html40", "p");
xtw.writeCharacters("Moved to");
xtw.writeStartElement("http://www.w3.org/TR/REC-html40", "a");
xtw.writeAttribute("href","http://frob.com");
xtw.writeCharacters("here");
xtw.writeEndElement();
xtw.writeEndElement();
xtw.writeEndElement();
xtw.writeEndElement();
xtw.writeEndDocument();

xtw.flush();
xtw.close();
                    </pre>
                </div>
                <p>
                    <a id="bnbhb"></a>
                </p>
                <h3>
                    Devolver la Salida
                </h3>
                <p>
                    Cuando ejecuta el ejemplo Writer, la clase <code>CursorWriter</code> se compila, y el flujo XML es analizado 
                    como eventos y escritos a un fichero llamado <code>dist/CursorWriter-Output</code>:
                </p>
                <div class="codeblock">
                    <pre>
&lt;!--all elements here are explicitly in the HTML namespace-->
&lt;?xml version="1.0" encoding="utf-8"?>
&lt;html:html xmlns:html="http://www.w3.org/TR/REC-html40">
&lt;html:head>
&lt;html:title>Frobnostication&lt;/html:title>&lt;/html:head>
&lt;html:body>
&lt;html:p>Moved to &lt;html:a href="http://frob.com">here&lt;/html:a>
&lt;/html:p>
&lt;/html:body>
&lt;/html:html>
                    </pre>
                </div>
                <p>
                    En el fichero <code>dist/CursorWriter-Output</code> real, este flujo se escribe sin saltos de línea; los saltos 
                    se han agregado aquí para hacer el listado más fácil de leer. En este ejemplo, como con el flujo de objetos en 
                    el ejemplo Evento, el prefijo del espacio de nombres se agrega en las etiquetas de apertura y cierre de HTML. 
                    La especificación StAX no requiere agregar este prefijo, pero es una buena práctica cuando el alcance final del 
                    flujo de salida no se conoce definitivamente.
                </p>
                <p>
                    <a id="gfyez"></a>
                </p>
                <h3>
                    Para Ejecutar el Ejemplo Escritor (Writer)
                </h3>
                <ol>
                    <li>
                        <b>Para compilar y ejecutar el ejemplo Writer, en una ventana terminal, vaya al directorio >
                            <i>INSTALL_DIR</i><code>/jaxp-</code><i>version</i><code>/samples/</code> y teclee lo siguiente:</b>
                        <div class="codeblock">
                            <pre>
javac -classpath \
    ../lib/jaxp-ri.jar stax/writer/*.java
                            </pre>
                        </div>
                    </li>
                    <li>
                        <b>Ejecute el ejemplo <code>CursorWriter</code>, especificando el nombre del fichero en el que se debe 
                            escribir la salida.</b>
                        <div class="codeblock">
                            <pre>
java stax/writer/CursorWriter -f <i>output_file</i>
                            </pre>
                        </div>
                        <p>
                            <code>CursorWriter</code> creará un fichero de salida del nombre apropiado, que contiene los datos 
                            mostrados en <a href="#bnbhb">Devolver la Salida</a>.
                        </p>
                    </li>
                </ol>
            </div>
            <div class="NavBit">
                <a target="_top" href="parser.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="info.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">
                            Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.
                        </p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente
                            <a target="_blank" href="../../information/run-examples.html">Compilando y Ejecutando los Ejemplos: PFs
                            </a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Implementación del Analizador de Flujos XML de Oracle<br />
            <b>Página siguiente:</b> Información Adicional
        </div>
    </body>
</html> 
