<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Soltado Nivel Superior (Los Tutoriales de Java&trade; &gt; Creando una IGU (Interfaz Gráfica de Usuario) con
            JFC/Swing &gt; Arrastrar y Soltar y Transferencia de Datos)
        </title>
        <meta name="description" content="Este tutorial de Swing Java describe el desarrollo de interfaces gráficas de usuario (GUI)
              para aplicaciones y applets que utilizan componentes Swing" />
        <meta name="keywords" content="java programming, learn java, java sample code, java swing, java ui, java user interface,
              swing components, swing events, swing layout  " />
        <link rel="stylesheet" href="../../indice.css" type="text/css" />
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper  clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Arrastrar y Soltar y Transferencia de Datos</a></div>
                <div class="linkAHEAD"><a href="intro.html">Introducción al Arrastrar y Soltar (Dnd)</a></div>
                <div class="linkAHEAD"><a href="defaultsupport.html">Soporte de DnD por Defecto</a></div>
                <div class="linkBHEAD"><a href="basicdemo.html">Demostración - BasicDnD</a></div>
                <div class="linkAHEAD"><a href="transferhandler.html">Clase TransferHandler</a></div>
                <div class="linkBHEAD"><a href="export.html">Métodos de Exportación</a></div>
                <div class="linkBHEAD"><a href="import.html">Métodos de Importación</a></div>
                <div class="linkAHEAD"><a href="transfersupport.html">Clase TransferSupport</a></div>
                <div class="linkAHEAD"><a href="dropmodes.html">Estableciendo el Modo Soltar</a></div>
                <div class="linkBHEAD"><a href="dropmodedemo.html">Demostración - DropDemo</a></div>
                <div class="linkAHEAD"><a href="dropaction.html">Eligiendo la Acción al Soltar</a></div>
                <div class="linkBHEAD"><a href="dropactiondemo.html">Demostración - ChooseDropAction</a></div>
                <div class="linkAHEAD"><a href="showdroploc.html">Mostrando la Ubicación de lo Soltado</a></div>
                <div class="linkAHEAD"><a href="locsensitivedrop.html">Soltado Sensible a la Ubicación</a></div>
                <div class="linkBHEAD"><a href="locsensitivedemo.html">Demostración - LocationSensitiveDemo</a></div>
                <div class="linkAHEAD"><a href="emptytable.html">Soltado en una Tabla Vacía</a></div>
                <div class="linkAHEAD"><a href="droplocation.html">Renderización de la Ubicación del Soltado</a></div>
                <div class="nolinkAHEAD">Soltado Nivel Superior</div>
                <div class="linkAHEAD"><a href="cutpaste.html">Añadiendo Cortar, Copiar y Pegar (CCP)</a></div>
                <div class="linkAHEAD"><a href="textpaste.html">CCP en un Componente de Texto</a></div>
                <div class="linkAHEAD"><a href="listpaste.html">CCP en un Componente No de Texto</a></div>
                <div class="linkAHEAD"><a href="dataflavor.html">Usando y Creando un DataFlavor</a></div>
                <div class="linkAHEAD"><a href="together.html">Poniéndolo todo junto - DnD y CCP</a></div>
                <div class="linkAHEAD"><a href="info.html">Información Adicional</a></div>
                <div class="linkAHEAD"><a href="problems.html">Resolviendo Problemas Comunes de Transferencia de Datos</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing<br />
                <b>Lección:</b> Arrastrar y Soltar y Transferencia de Datos
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Arrastrar y Soltar y Transferencia de Datos</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="droplocation.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="cutpaste.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Soltado Nivel Superior</h1>
            </div>
            <div id="PageContent">
                <p>
                    Hasta ahora, nos hemos centrado principalmente en adjuntar un <code>TransferHandler</code> a una de las 
                    subclases de <code>JComponent</code>. Pero también puede establecer un <code>TransferHandler</code> 
                    directamente en el contenedor de más arriba, tal como <code>JFrame</code> y <code>JDialog</code>.
                </p>
                <p>
                    Esto es particularmente útil para aplicaciones que importan ficheros, tales como editores, EIDs, programas de 
                    manipulación de imagenes, programas de grabación de CD. Tales aplicaciones generalmente incluyen un menú, una 
                    barra de herramientas, un área para editar documentos, y probablemente una lista o mecanismos para cambiar 
                    entre documentos abiertos.
                </p>
                <p>
                    Tenemos un ejemplo de este tipo pero debido a que esta demostración lee archivos, no proporcionamos una versión 
                    de Java Web Start &mdash; tendrá que descargar y compilar la demostración usted mismo.
                </p>
                <p>
                    Como puede ver en la captura de pantalla de abajo, <code>TopLevelTransferHandlerDemo</code> tiene un menú 
                    (vacío, excepto para el submenú Demo), una barra de herramientas (no funcional), un área (a la izquierda) que 
                    muestra una lista de documentos abiertos, y un área (a la derecha) que muestra el contenido de cada documento 
                    abierto. En el arranque el área del documento azul tiene asignado un manejador de transferencias que soporta la 
                    importación de ficheros &mdash; así que es el único lugar que puede aceptar un soltado.
                </p>
                <p style="text-align:center">
                    <img src="../../figures/uiswing/dnd/TopLevelTransferHandlerDemo.png" width="365" height="268" class="imgbottom"
                         alt="Una captura de la demostración TopLevelTransferHandlerDemo." />
                </p>
                <div class="note">
                    <hr />
                    <strong>Intente esto:</strong>&nbsp;
                    <ol>
                        <li>
                            Compile y ejecute el ejemplo
                            <a class="SourceLink" target="_blank"
                               href="../examples/dnd/TopLevelTransferHandlerDemoProject/src/dnd/TopLevelTransferHandlerDemo.java"
                               onclick="showCode('../../displayCode.html',
                                               '../examples/dnd/TopLevelTransferHandlerDemoProject/src/dnd/TopLevelTransferHandlerDemo.java');
                                       return false;">
                                <code>TopLevelTransferHandlerDemo</code></a>, consulte el 
                            <a href="../examples/dnd/index.html#TopLevelTransferHandlerDemo">índice de ejemplos </a> si le gustase 
                            descargar un fichero zip estructurado para NetBeans.
                        </li>
                        <li>
                            Arrastre un fichero desde su escritorio nativo o sistema de ficheros y suéltelo en el área del 
                            documento azul a la derecha.
                            El fichero es abierto y un marco llenado con su contenido aparecerá - El área de documento, un 
                            <code>JDesktopPane</code>, contiene un manejador de transferencias que soporta la importación de 
                            <code>javaFileListFlavor</code>.
                        </li>
                        <li>
                            Arrastre otro fichero e intente soltarlo en el área de documentos. Encontrará que no puede soltarlo 
                            sobre lo alto del marco que muestra el último fichero. Tampoco puede soltarlo en la lista, el menú, o 
                            la barra de herramientas. El único lugar en el que puede soltar es en la porción azul del área de 
                            documento o en la barra de menú de un marco previamente abierto. Dentro de cada marco de contenido hay 
                            un manejador de transferencias de componente de texto que no entiende las sueltas de fichero &mdash; 
                            puede soltar texto dentro de ese área, pero no un fichero.
                        </li>
                        <li>
                            Desde el menú, elija Demo-&gt;Use Top-Level TransferHandler para instalar el manejador de 
                            transferencias en el contenedor de más alto nivel &mdash; un <code>JFrame</code>.
                        </li>
                        <li>
                            Intente arrastrar sobre la demostración de nuevo. El número de áreas que aceptan los soltados se ha 
                            incrementado. Puede ahora soltar en casi cualquier parte de la aplicación incluyendo la barra de menús, 
                            la barra de herramientas, la barra de títulos del cuadro, excepto en la lista (a la izquierda) o en el 
                            área de contenido de un fichero abierto previamente. Los manejadores de transferencia de 
                            <code>JList</code> o del área de texto no saben como importar ficheros.
                        </li>
                        <li>
                            Deshabilite los manejadores de transferencia en los componentes restantes seleccionando Demo-&gt;Remove 
                            TransferHandler from List and Text desde el menú.
                        </li>
                        <li>
                            Arrastre sobre la demostración de nuevo. ¡Ahora puede soltar un fichero <em>en cualquier parte</em> de 
                            la aplicación!
                        </li>
                        <li>
                            Desde el menú, elija Demo-&gt;Use COPY Action.
                        </li>
                        <li>
                            Arastre sobre la demostración de nuevo. Note que el cursor del ratón ahora muestra el cursor COPY 
                            &mdash; esto ofrece una respuesta más adecuada porque un soltado exitoso no elimina el fichero de la 
                            fuente. El destino puede ser programado para seleccionar desde las acciones de soltado disponibles como 
                            se describió en 
                            <a class="TutorialLink" target="_top" href="dropaction.html">Eligiendo la Acción al Soltar</a>.
                        </li>
                    </ol>
                    <hr />
                </div>
                <p>
                    Tenga en cuenta un efecto secundario no deseado de deshabilitar el controlador de transferencia predeterminado 
                    en el componente de texto: Ya no puede arrastrar y soltar (o cortar / copiar / pegar) texto dentro del área de 
                    edición. Para arreglar esto, necesitará implementar un controlador de transferencia personalizado para el 
                    componente de texto que acepte sueltas de fichero y que también reimplemente el soporte perdido para las 
                    transferencias de texto. Podría querer ver 
                    <a class="OutsideLink" target="_blank"
                       href="http://bugs.java.com/bugdatabase/view_bug.do?bug_id=4830695">RFE 4830695</a> el cual le permitiría 
                    agregar la importación de datos encima de un <code>TransferHandler</code> existente.
                </p>
                <p>Aquí está el código fuente para 
                    <a class="SourceLink" target="_blank"
                       href="../examples/dnd/TopLevelTransferHandlerDemoProject/src/dnd/TopLevelTransferHandlerDemo.java"
                       onclick="showCode('../../displayCode.html',
                                       '../examples/dnd/TopLevelTransferHandlerDemoProject/src/dnd/TopLevelTransferHandlerDemo.java');
                               return false;">
                        <code>TopLevelTransferHandlerDemo.java</code>
                    </a>:
                </p>
                <div class="codeblock">
                    <pre>
/**
 * Demonstration of the top-level {@code TransferHandler}
 * support on {@code JFrame}.
 */
public class TopLevelTransferHandlerDemo extends JFrame {

    private static boolean DEMO = false;

    private JDesktopPane dp = new JDesktopPane();
    private DefaultListModel listModel = new DefaultListModel();
    private JList list = new JList(listModel);
    private static int left;
    private static int top;
    private JCheckBoxMenuItem copyItem;
    private JCheckBoxMenuItem nullItem;
    private JCheckBoxMenuItem thItem;

    private class Doc extends InternalFrameAdapter implements ActionListener {
        String name;
        JInternalFrame frame;
        TransferHandler th;
        JTextArea area;

        public Doc(File file) {
            this.name = file.getName();
            try {
                init(file.toURI().toURL());
            } catch (MalformedURLException e) {
                e.printStackTrace();
            }
        }

        public Doc(String name) {
            this.name = name;
            init(getClass().getResource(name));
        }

        private void init(URL url) {
            frame = new JInternalFrame(name);
            frame.addInternalFrameListener(this);
            listModel.add(listModel.size(), this);

            area = new JTextArea();
            area.setMargin(new Insets(5, 5, 5, 5));

            try {
                BufferedReader reader = new BufferedReader(new InputStreamReader(url.openStream()));
                String in;
                while ((in = reader.readLine()) != null) {
                    area.append(in);
                    area.append("\n");
                }
                reader.close();
            } catch (Exception e) {
                e.printStackTrace();
                return;
            }

            th = area.getTransferHandler();
            area.setFont(new Font("monospaced", Font.PLAIN, 12));
            area.setCaretPosition(0);
            area.setDragEnabled(true);
            area.setDropMode(DropMode.INSERT);
            frame.getContentPane().add(new JScrollPane(area));
            dp.add(frame);
            frame.show();
            if (DEMO) {
                frame.setSize(300, 200);
            } else {
                frame.setSize(400, 300);
            }
            frame.setResizable(true);
            frame.setClosable(true);
            frame.setIconifiable(true);
            frame.setMaximizable(true);
            frame.setLocation(left, top);
            incr();
            SwingUtilities.invokeLater(new Runnable() {
                public void run() {
                    select();
                }
            });
            nullItem.addActionListener(this);
            setNullTH();
        }

        public void internalFrameClosing(InternalFrameEvent event) {
            listModel.removeElement(this);
            nullItem.removeActionListener(this);
        }

        public void internalFrameOpened(InternalFrameEvent event) {
            int index = listModel.indexOf(this);
            list.getSelectionModel().setSelectionInterval(index, index);
        }

        public void internalFrameActivated(InternalFrameEvent event) {
            int index = listModel.indexOf(this);
            list.getSelectionModel().setSelectionInterval(index, index);
        }

        public String toString() {
            return name;
        }

        public void select() {
            try {
                frame.toFront();
                frame.setSelected(true);
            } catch (java.beans.PropertyVetoException e) {}
        }

        public void actionPerformed(ActionEvent ae) {
            setNullTH();
        }

        public void setNullTH() {
            if (nullItem.isSelected()) {
                area.setTransferHandler(null);
            } else {
                area.setTransferHandler(th);
            }
        }
    }

    private TransferHandler handler = new TransferHandler() {
        public boolean canImport(TransferHandler.TransferSupport support) {
            if (!support.isDataFlavorSupported(DataFlavor.javaFileListFlavor)) {
                return false;
            }

            if (copyItem.isSelected()) {
                boolean copySupported = (COPY &amp; support.getSourceDropActions()) == COPY;

                if (!copySupported) {
                    return false;
                }

                support.setDropAction(COPY);
            }

            return true;
        }

        public boolean importData(TransferHandler.TransferSupport support) {
            if (!canImport(support)) {
                return false;
            }

            Transferable t = support.getTransferable();

            try {
                java.util.List&lt;File&gt; l =
                    (java.util.List&lt;File&gt;)t.getTransferData(DataFlavor.javaFileListFlavor);

                for (File f : l) {
                    new Doc(f);
                }
            } catch (UnsupportedFlavorException e) {
                return false;
            } catch (IOException e) {
                return false;
            }

            return true;
        }
    };

    private static void incr() {
        left += 30;
        top += 30;
        if (top == 150) {
            top = 0;
        }
    }

    public TopLevelTransferHandlerDemo() {
        super("TopLevelTransferHandlerDemo");
        setJMenuBar(createDummyMenuBar());
        getContentPane().add(createDummyToolBar(), BorderLayout.NORTH);

        JSplitPane sp = new JSplitPane(JSplitPane.HORIZONTAL_SPLIT, list, dp);
        sp.setDividerLocation(120);
        getContentPane().add(sp);
        //new Doc("sample.txt");
        //new Doc("sample.txt");
        //new Doc("sample.txt");

        list.getSelectionModel().setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

        list.addListSelectionListener(new ListSelectionListener() {
            public void valueChanged(ListSelectionEvent e) {
                if (e.getValueIsAdjusting()) {
                    return;
                }

                Doc val = (Doc)list.getSelectedValue();
                if (val != null) {
                    val.select();
                }
             }
        });

        final TransferHandler th = list.getTransferHandler();

        nullItem.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                if (nullItem.isSelected()) {
                    list.setTransferHandler(null);
                } else {
                    list.setTransferHandler(th);
                }
            }
        });
        thItem.addActionListener(new ActionListener() {
            public void actionPerformed(ActionEvent ae) {
                if (thItem.isSelected()) {
                    setTransferHandler(handler);
                } else {
                    setTransferHandler(null);
                }
            }
        });
        dp.setTransferHandler(handler);
    }

    private static void createAndShowGUI(String[] args) {
        try {
            UIManager.setLookAndFeel(UIManager.getSystemLookAndFeelClassName());
        } catch (Exception e) {
        }

        TopLevelTransferHandlerDemo test = new TopLevelTransferHandlerDemo();
        test.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
        if (DEMO) {
            test.setSize(493, 307);
        } else {
            test.setSize(800, 600);
        }
        test.setLocationRelativeTo(null);
        test.setVisible(true);
        test.list.requestFocus();
    }

    public static void main(final String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                //Turn off metal's use of bold fonts
                UIManager.put("swing.boldMetal", Boolean.FALSE);
                createAndShowGUI(args);
            }
        });
    }

    private JToolBar createDummyToolBar() {
        JToolBar tb = new JToolBar();
        JButton b;
        b = new JButton("New");
        b.setRequestFocusEnabled(false);
        tb.add(b);
        b = new JButton("Open");
        b.setRequestFocusEnabled(false);
        tb.add(b);
        b = new JButton("Save");
        b.setRequestFocusEnabled(false);
        tb.add(b);
        b = new JButton("Print");
        b.setRequestFocusEnabled(false);
        tb.add(b);
        b = new JButton("Preview");
        b.setRequestFocusEnabled(false);
        tb.add(b);
        tb.setFloatable(false);
        return tb;
    }

    private JMenuBar createDummyMenuBar() {
        JMenuBar mb = new JMenuBar();
        mb.add(createDummyMenu("File"));
        mb.add(createDummyMenu("Edit"));
        mb.add(createDummyMenu("Search"));
        mb.add(createDummyMenu("View"));
        mb.add(createDummyMenu("Tools"));
        mb.add(createDummyMenu("Help"));

        JMenu demo = new JMenu("Demo");
        demo.setMnemonic(KeyEvent.VK_D);
        mb.add(demo);

        thItem = new JCheckBoxMenuItem("Use Top-Level TransferHandler");
        thItem.setMnemonic(KeyEvent.VK_T);
        demo.add(thItem);

        nullItem = new JCheckBoxMenuItem("Remove TransferHandler from List and Text");
        nullItem.setMnemonic(KeyEvent.VK_R);
        demo.add(nullItem);

        copyItem = new JCheckBoxMenuItem("Use COPY Action");
        copyItem.setMnemonic(KeyEvent.VK_C);
        demo.add(copyItem);

        return mb;
    }

    private JMenu createDummyMenu(String str) {
        JMenu menu = new JMenu(str);
        JMenuItem item = new JMenuItem("[Empty]");
        item.setEnabled(false);
        menu.add(item);
        return menu;
    }
}
                    </pre>
                </div>
            </div>
            <div class="NavBit">
                <a target="_top" href="droplocation.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="cutpaste.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.</p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs</a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Renderización de la Ubicación del Soltado<br />
            <b>Página siguiente:</b> Añadiendo Cortar, Copiar y Pegar (CCP)
        </div>
    </body>
</html>