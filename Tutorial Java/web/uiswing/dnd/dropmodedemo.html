<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Demostración - DropDemo (Los Tutoriales de Java&trade; &gt; Creando una IGU (Interfaz Gráfica de Usuario) con
            JFC/Swing &gt; Arrastrar y Soltar y Transferencia de Datos)
        </title>
        <meta name="description" content="Este tutorial de Swing Java describe el desarrollo de interfaces gráficas de usuario (GUI)
              para aplicaciones y applets que utilizan componentes Swing" />
        <meta name="keywords" content="java programming, learn java, java sample code, java swing, java ui, java user interface,
              swing components, swing events, swing layout  " />
        <link rel="stylesheet" href="../../indice.css" type="text/css" />
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper  clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Arrastrar y Soltar y Transferencia de Datos</a></div>
                <div class="linkAHEAD"><a href="intro.html">Introducción al Arrastrar y Soltar (Dnd)</a></div>
                <div class="linkAHEAD"><a href="defaultsupport.html">Soporte de DnD por Defecto</a></div>
                <div class="linkBHEAD"><a href="basicdemo.html">Demostración - BasicDnD</a></div>
                <div class="linkAHEAD"><a href="transferhandler.html">Clase TransferHandler</a></div>
                <div class="linkBHEAD"><a href="export.html">Métodos de Exportación</a></div>
                <div class="linkBHEAD"><a href="import.html">Métodos de Importación</a></div>
                <div class="linkAHEAD"><a href="transfersupport.html">Clase TransferSupport</a></div>
                <div class="linkAHEAD"><a href="dropmodes.html">Estableciendo el Modo Soltar</a></div>
                <div class="nolinkBHEAD">Demostración - DropDemo</div>
                <div class="linkAHEAD"><a href="dropaction.html">Eligiendo la Acción al Soltar</a></div>
                <div class="linkBHEAD"><a href="dropactiondemo.html">Demostración - ChooseDropAction</a></div>
                <div class="linkAHEAD"><a href="showdroploc.html">Mostrando la Ubicación de lo Soltado</a></div>
                <div class="linkAHEAD"><a href="locsensitivedrop.html">Soltado Sensible a la Ubicación</a></div>
                <div class="linkBHEAD"><a href="locsensitivedemo.html">Demostración - LocationSensitiveDemo</a></div>
                <div class="linkAHEAD"><a href="emptytable.html">Soltado en una Tabla Vacía</a></div>
                <div class="linkAHEAD"><a href="droplocation.html">Renderización de la Ubicación del Soltado</a></div>
                <div class="linkAHEAD"><a href="toplevel.html">Soltado Nivel Superior</a></div>
                <div class="linkAHEAD"><a href="cutpaste.html">Añadiendo Cortar, Copiar y Pegar (CCP)</a></div>
                <div class="linkAHEAD"><a href="textpaste.html">CCP en un Componente de Texto</a></div>
                <div class="linkAHEAD"><a href="listpaste.html">CCP en un Componente No de Texto</a></div>
                <div class="linkAHEAD"><a href="dataflavor.html">Usando y Creando un DataFlavor</a></div>
                <div class="linkAHEAD"><a href="together.html">Poniéndolo todo junto - DnD y CCP</a></div>
                <div class="linkAHEAD"><a href="info.html">Información Adicional</a></div>
                <div class="linkAHEAD"><a href="problems.html">Resolviendo Problemas Comunes de Transferencia de Datos</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing<br />
                <b>Lección:</b> Arrastrar y Soltar y Transferencia de Datos<br />
                <b>Sección:</b> Estableciendo el Modo Soltar
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Arrastrar y Soltar y Transferencia de Datos</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="dropmodes.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="dropaction.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Demostración - DropDemo</h1>
            </div>
            <div id="PageContent">
                <p>
                    Ahora veremos una demostración que usa un manejador de transferencia personalizada para implementar el gesto de 
                    soltar para un componente de lista. Aunque el manejador de transferencia predeterminado para la lista 
                    implementa la exportación, debido a que estamos creando un manejador de transferencia personalizado para 
                    implementar la importación, tendremos que reimplementar también la exportación.
                </p>
                <p>
                    Como ve en la captura de pantalla, <code>DropDemo</code> contiene un área de texto editable, una lista, y una 
                    caja combo que le permite seleccionar el modo de suelta para la lista.
                </p>
                <p style="text-align: center">
                    <img src="../../figures/uiswing/dnd/DropDemo.png" width="418" height="356" class="imgbottom"
                         alt="Captura DropDemo" />
                </p>
                <div class="note">
                    <hr />
                    <strong>Intente esto:</strong>&nbsp;
                    <ol>
                        <li>
                            Pulse el botón Lanzar para ejecutar <code>DropDemo</code> usando
                            <a class="OutsideLink" target="_blank"
                               href="http://www.oracle.com/technetwork/java/javase/javawebstart/index.html">
                                Java&trade; Web Start</a> (
                            <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                descargue KDJ 7 o posterior</a>). Alternativamente, para compilar y ejecutar el ejemplo por usted 
                                mismo, consulte el 
                            <a href="../examples/dnd/index.html#DropDemo">índice de ejemplos</a>.
                            <a href="https://docs.oracle.com/javase/tutorialJWS/samples/uiswing/DropDemoProject/DropDemo.jnlp">
                                <img src="../../images/jws-launch-button.png" width="88" height="23" class="imgbottom"
                                     alt="Lanza el ejemplo DropDemo" /></a>
                            <br />
                        </li>
                        <li>
                            Seleccione algunos textos en el área de texto y suéltelos sobre la lista. La entrada seleccionada de la 
                            lista es reemplazada y ese elemento se convierte en la selección actual. Esto es como 
                            <code>USE_SELECTION</code> funciona y se ofrece por compatibilidad hacia atrás pero es de otra forma 
                            no recomendado.
                        </li>
                        <li>
                            Cambie el Modo de Soltado de la Lista a <code>ON</code> e intente la misma acción. Una vez de nuevo, el 
                            elemento de la lista seleccionada es reemplazado, pero la selección actual no se mueve.
                        </li>
                        <li>
                            Cambie el Modo de Soltado de la Lista a <code>INSERT</code> y repita la misma acción. El texto agregado 
                            es insertado en la ubicación de soltado. En este modo no es posible modificar los elementos existentes 
                            en la lista.
                        </li>
                        <li>
                            Cambie el Modo de Soltado de la Lista a <code>ON_OR_INSERT</code>. Dependiendo de la posición del 
                            cursor, puede insertar el nuevo texto o puede reemplazar el texto existente.                            
                        </li>
                    </ol>
                    <hr />
                </div>
                <p>
                   Aquí está la implementación de 
                    <a class="SourceLink" target="_blank"
                       href="../examples/dnd/DropDemoProject/src/dnd/ListTransferHandler.java"
                       onclick="showCode('../../displayCode.html',
                                       '../examples/dnd/DropDemoProject/src/dnd/ListTransferHandler.java');
                               return false;">
                        <code>ListTransferHandler</code></a> para
                    <a class="SourceLink" target="_blank"
                       href="../examples/dnd/DropDemoProject/src/dnd/DropDemo.java"
                       onclick="showCode('../../displayCode.html',
                                       '../examples/dnd/DropDemoProject/src/dnd/DropDemo.java');
                               return false;">
                        <code>DropDemo.java</code></a>.
                </p>
                <p>
                    El manejador de transferencia para esta lista soporta copiar y mover y reimplementa el soporte de arrastre que 
                    la lista ofrece de manera predeterminada.
                </p>
                <div class="codeblock">
                    <pre>
public class ListTransferHandler extends TransferHandler {
    private int[] indices = null;
    private int addIndex = -1; //Lugar donde se agregaron los artículos
    private int addCount = 0;  //Número de elementos agregados.

    /**
     * Nosotros sólo soportamos la importación de cadenas.
     */
    public boolean canImport(TransferHandler.TransferSupport info) {
        // Comprobamos el sabor de Cadenas
        if (!info.isDataFlavorSupported(DataFlavor.stringFlavor)) {
            return false;
        }
        return true;
   }

    /**
     * Agrupa los elementos seleccionados en una sola lista para exportar.
     * Cada línea se separa por un retorno de carro.
     */
    protected Transferable createTransferable(JComponent c) {
        JList list = (JList)c;
        indices = list.getSelectedIndices();
        Object[] values = list.getSelectedValues();

        StringBuffer buff = new StringBuffer();

        for (int i = 0; i &lt; values.length; i++) {
            Object val = values[i];
            buff.append(val == null ? "" : val.toString());
            if (i != values.length - 1) {
                buff.append("\n");
            }
        }

        return new StringSelection(buff.toString());
    }

    /**
     * Soportamos las acciones de copiar y mover.
     */
    public int getSourceActions(JComponent c) {
        return TransferHandler.COPY_OR_MOVE;
    }

    /**
     * Realiza la importación real. Esta demostración solo admite arrastrar y soltar.
     */
    public boolean importData(TransferHandler.TransferSupport info) {
        if (!info.isDrop()) {
            return false;
        }

        JList list = (JList)info.getComponent();
        DefaultListModel listModel = (DefaultListModel)list.getModel();
        JList.DropLocation dl = (JList.DropLocation)info.getDropLocation();
        int index = dl.getIndex();
        boolean insert = dl.isInsert();

        // Tomamos la cadena que está siendo soltada.
        Transferable t = info.getTransferable();
        String data;
        try {
            data = (String)t.getTransferData(DataFlavor.stringFlavor);
        }
        catch (Exception e) { return false; }

        // Siempre que haya una nueva línea en los datos entrantes, 
        // divídala en un elemento separado en la lista.
        String[] values = data.split("\n");

        addIndex = index;
        addCount = values.length;

        // Realizamos la importación real.
        for (int i = 0; i &lt; values.length; i++) {
            if (insert) {
                listModel.add(index++, values[i]);
            } else {
                // Si los elementos van más allá del final de la 
                // lista actual, agréguelos.
                if (index &lt; listModel.getSize()) {
                    listModel.set(index++, values[i]);
                } else {
                    listModel.add(index++, values[i]);
                }
            }
        }
        return true;
    }

    /**
     * Elimina los elementos movidos de la lista.
     */
    protected void exportDone(JComponent c, Transferable data, int action) {
        JList source = (JList)c;
        DefaultListModel listModel  = (DefaultListModel)source.getModel();

        if (action == TransferHandler.MOVE) {
            for (int i = indices.length - 1; i >= 0; i--) {
                listModel.remove(indices[i]);
            }
        }

        indices = null;
        addCount = 0;
        addIndex = -1;
    }
}
                    </pre>
                </div>
                <p>
                    A continuación vemos cómo el destino puede elegir la acción de soltado.
                </p>
            </div>
            <div class="NavBit">
                <a target="_top" href="dropmodes.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="dropaction.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales</a>.
                        </p>
                        <p class="footertext">Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.</p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs</a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Estableciendo el Modo Soltar<br />
            <b>Página siguiente:</b> Eligiendo la Acción al Soltar
        </div>
    </body>
</html>