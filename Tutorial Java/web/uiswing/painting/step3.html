<!DOCTYPE html>
<html lang="es">
    <head>
        <meta charset="UTF-8" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <title>
            Creando la Aplicación Demo (Paso 3) (Los Tutoriales de Java&trade; &gt; Creando una IGU (Interfaz Gráfica de Usuario)
            con JFC/Swing &gt; Realización de Pintado Personalizado)
        </title>
        <meta name="description" content="Este tutorial de Swing Java describe el desarrollo de interfaces gráficas de usuario (GUI)
              para aplicaciones y applets que utilizan componentes Swing" />
        <meta name="keywords" content="java programming, learn java, java sample code, java swing, java ui, java user interface,
              swing components, swing events, swing layout  " />
        <link rel="stylesheet" href="../../indice.css" type="text/css"/>
        <script src="../../navegacion.js"></script>
    </head>
    <body onload="load()">
        <noscript>Se requiere un navegador con JavaScript habilitado para que esta página opere apropiadamente.</noscript>
        <div class="header-container">
            <div class="bookwrapper  clearfix">
                <div id="brandProdName">
                    <div id="logocover"></div>
                    <div id="productName">Documentación</div>
                </div>
                <br class="clearfloat" />
            </div>
        </div>
        <div id="TopBar">
            <div id="TopBar_tr">
                <div id="TopBar_tl">
                    <div id="TopBar_br">
                        <div id="TopBar_bl">
                            <div id="TopBar_left">Los Tutoriales de Java&trade;</div>
                            <div id="TopBar_right">
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/java-se-7-tutorial-2012-02-28-1536013.html">
                                    Descargar Libros Electrónicos</a><br />
                                <a target="_blank" href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">
                                    Descargar KDJ</a><br />
                                <a href="javascript:toggleLeft()" id="ToggleLeft">
                                    Ocultar TdC</a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
        <div id="LeftBar" class="LeftBar_shown">
            <div id="Contents">
                <div class="linkLESSON"><a href="index.html">Realización de Pintado Personalizado</a></div>
                <div class="linkAHEAD"><a href="step1.html">Creando la Aplicación Demo (Paso 1)</a></div>
                <div class="linkAHEAD"><a href="step2.html">Creando la Aplicación Demo (Paso 2)</a></div>
                <div class="nolinkAHEAD">Creando la Aplicación Demo (Paso 3)</div>
                <div class="linkAHEAD"><a href="refining.html">Refinando el Diseño</a></div>
                <div class="linkAHEAD"><a href="closer.html">Una Mirada más Cercana al Mecanismo de Pintado</a></div>
                <div class="linkAHEAD"><a href="summary.html">Sumario</a></div>
                <div class="linkAHEAD"><a href="problems.html">Resolviendo Problemas Comunes de Pintado</a></div>
            </div>
        </div>
        <div id="MainFlow" class="MainFlow_indented">
            <div class="PrintHeaders">
                <b>Recorrido:</b> Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing<br />
                <b>Lección:</b> Realización de Pintado Personalizado
            </div>
            <div id="BreadCrumbs">
                <a href="../../index.html" target="_top">Página de Inicio</a>&nbsp;&gt;&nbsp;
                <a href="../index.html" target="_top">Creando una IGU (Interfaz Gráfica de Usuario) con JFC/Swing</a>&nbsp;&gt;&nbsp;
                <a href="index.html" target="_top">Realización de Pintado Personalizado</a>
            </div>
            <div class="NavBit">
                <a target="_top" href="step2.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="refining.html">Siguiente&nbsp;&raquo;</a>
            </div>
            <div id="PageTitle">
                <h1>Creando la Aplicación Demo (Paso 3)</h1>
            </div>
            <div id="PageContent">
                <p>
                    Finalmente, agregaremos el código de manejo de eventos para repintar programáticamente el componente cada vez 
                    que el usuario pulse o arrastre el ratoón. Para mantener nuestro pintado personalizado tan eficiente como sea 
                    posible, seguiremos las coordenadas del mouse y volveremos a pintar solo las áreas de la pantalla que han 
                    cambiado. Esta es una práctica recomendada que mantendrá su aplicación ejecutándose de la manera más 
                    eficientemente posible.
                </p>
                <p style="text-align: center">
                    <img src="../../figures/uiswing/painting/swing3.png" width="258" height="234" class="imgbottom"
                         alt="La aplicación completada, mostrando un cuadro rojo con un borde negro" />
                </p>
                <p class="FigureCaption">
                    La Aplicación Completa
                </p>
                Figura 3: La Aplicación Completa<br />
                <p>
                     Pulse el botón Lanzar para ejecutar SwingPaintDemo3 usando 
                    <a class="OutsideLink" target="_blank"
                       href="http://www.oracle.com/technetwork/java/javase/javawebstart/index.html">Java&trade; Web Start</a> (
                    <a href="http://www.oracle.com/technetwork/java/javase/downloads/index.html">descargue KDJ 7 o posterior</a>). 
                    Alternativamente, para compilar y ejecutar el ejemplo por sí mismo, consulte el 
                    <a href="../examples/painting/index.html#SwingPaintDemo3">índice de ejemplos</a>.
                </p>
                <a href="https://docs.oracle.com/javase/tutorialJWS/samples/uiswing/SwingPaintDemo3Project/SwingPaintDemo3.jnlp">
                    <img src="../../images/jws-launch-button.png" width="88" height="23" class="imgbottom"
                         alt="Lanza el ejemplo SwingPaintDemo3" /></a>
                <br />
                <div class="codeblock">
                    <pre>
package painting;

import javax.swing.SwingUtilities;
import javax.swing.JFrame;
import javax.swing.JPanel;
import javax.swing.BorderFactory;
import java.awt.Color;
import java.awt.Dimension;
import java.awt.Graphics;
<b>import java.awt.event.MouseEvent;
import java.awt.event.MouseListener;
import java.awt.event.MouseAdapter;
import java.awt.event.MouseMotionListener;
import java.awt.event.MouseMotionAdapter;</b>

public class SwingPaintDemo3 {
    
    public static void main(String[] args) {
        SwingUtilities.invokeLater(new Runnable() {
            public void run() {
                createAndShowGUI(); 
            }
        });
    }

    private static void createAndShowGUI() {
        System.out.println("Created GUI on EDT? "+
        SwingUtilities.isEventDispatchThread());
        JFrame f = new JFrame("Swing Paint Demo");
        f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE); 
        f.add(new MyPanel());
        f.pack();
        f.setVisible(true);
    } 
}

class MyPanel extends JPanel {

    <b>private int squareX = 50;
    private int squareY = 50;
    private int squareW = 20;
    private int squareH = 20;</b>

    public MyPanel() {

        setBorder(BorderFactory.createLineBorder(Color.black));

        <b>addMouseListener(new MouseAdapter() {
            public void mousePressed(MouseEvent e) {
                moveSquare(e.getX(),e.getY());
            }
        });

        addMouseMotionListener(new MouseAdapter() {
            public void mouseDragged(MouseEvent e) {
                moveSquare(e.getX(),e.getY());
            }
        });
        </b>
    }
    <b>
    private void moveSquare(int x, int y) {
        int OFFSET = 1;
        if ((squareX!=x) || (squareY!=y)) {
            repaint(squareX,squareY,squareW+OFFSET,squareH+OFFSET);
            squareX=x;
            squareY=y;
            repaint(squareX,squareY,squareW+OFFSET,squareH+OFFSET);
        } 
    }
    </b>

    public Dimension getPreferredSize() {
        return new Dimension(250,200);
    }
    
    protected void paintComponent(Graphics g) {
        super.paintComponent(g);       
        g.drawString("This is my custom Panel!",10,20);
        <b>g.setColor(Color.RED);
        g.fillRect(squareX,squareY,squareW,squareH);
        g.setColor(Color.BLACK);
        g.drawRect(squareX,squareY,squareW,squareH);</b>
    }  
}
                    </pre>
                </div>
                <p>
                    Este cambio primero importa varias clases del ratón desde el paquete <code>java.awt.event</code>, haciendo que 
                    la aplicación sea capaz de responder a la actividad del ratón del usuario. El constructor ha sido actualizado 
                    para registrar los monitores de evnetos para las pulsaciones y arrastres del ratón. Simpre que se recibe un 
                    <code>MouseEvent</code>, se reenvía al método <code>moveSquare</code>, el cual actualiza las coordenadas del 
                    cuadrado y repinta el componente de una manera inteligente. Note que por defecto, cualquier código que se 
                    coloque dentro de estos manejadores de eventos serán ejecutados en el Hilo de Envío de Eventos.
                </p>
                <p>
                    Pero el cambio más importante es la invocación del método <code>repaint</code>. Este método se define en 
                    <code>java.awt.Component</code> y es el mecanismo que le permite repintar programáticamente la superficie de 
                    cualquier componente dado. Tiene una versión sin argumentos (el cual repinta el componente entero) y una 
                    versión con varios argumentos (la cual sólo repinta el área especificada). Esta área es conocida también como 
                    <i>clip</i>. Invocar la versión multi-arg de <code>repaint</code> requiere un poco de esfuerzo adicional, pero 
                    garantiza que su código de pintado no desperdiciará ciclos repintando áreas de la pantalla que no han cambiado.
                </p>
                <p>
                    Debido a que estamos configurando manualmente el clip, nuestro método <code>moveSquare</code> invoca el método 
                    repintado no una, sino dos veces. La primera invocación le indica a Swing que repinte el área del componente 
                    donde esta <i>previamente</i> el cuadrado (el comportamiento heradado usa el Delegado IU para rellenar ese área 
                    con el color de fondo actual). La segunda invocación pinta el área del componete donde está el cuadrado 
                    <i>actualmente</i>. Un punto importante que vale la pena señalar es que, aunque hemos invocado el repintado dos 
                    veces seguidas en el mismo controlador de eventos, Swing es lo suficientemente inteligente como para tomar esa 
                    información y repintar esas secciones de la pantalla, todo en una sola operación de pintura. En otras palabras, 
                    Swing no volverá a pintar el componente dos veces seguidas, incluso si eso es lo que parece estar haciendo el 
                    código.
                </p>
                <p>
                    Ejercicios:
                </p>
                <ol>
                    <li>
                        Comente la primera invocación del repintado y note qué ocurre cuando pulsa o arrastra el ratón. Ya que esa 
                        línea es responsable de rellenar el fondo, deberá notar que todos los cuadrados permanecen en la pantalla 
                        después de ser pintados.
                    </li>
                    <li>
                        Con múltiples cuadrados en la pantalla, minimize y restaure el marco de la aplicación. ¿Qué ocurre? Debe 
                        notar que el acto de maximizar la pantalla causa que el sistema repinte completamente los componentes de la 
                        superficie, lo cual borrará todos los cuadrados excepto el actual.
                    </li>
                    <li>
                        Comente ambas invocaciones del repintado, y agregue una línea al final de método paintComponent que invoque 
                        la versión sin argumentos del repintado. La aplicación parecerá restaurada a su comportamiento 
                        original, pero el pintado será ahora menos eficiente ya que se está pintando el área entera de la 
                        superficie del componente. Puede notar un rendimiento más lento, especialmente si se maximiza la aplicación.
                    </li>
                </ol>
            </div>
            <div class="NavBit">
                <a target="_top" href="step2.html">&laquo;&nbsp;Anterior</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="../TOC.html">TdC</a>&nbsp;&bull;&nbsp;
                <a target="_top" href="refining.html">Siguiente&nbsp;&raquo;</a>
            </div>
        </div>
        <hr class="clearfloat"/>
        <div id="Footer">
            <table style="width: 100%;padding: 5px">
                <tr>
                    <td>
                        <p class="footertext">
                            <a id="license_info">Su uso de ésta</a> página y todo el material en las páginas bajo el anuncio
                            &quot;Los Tutoriales de Java&quot; está sujeto a estos <a href="../../information/cpyr.html">avisos
                                legales </a>.
                        </p>
                        <p class="footertext">Copyright &copy; 1995, 2015 Oracle y/o sus afiliados. Todos los derechos reservados.</p>
                    </td>
                    <td style="text-align: right">
                        <p class="footertext">
                            ¿Problemas con estos ejemplos? Intente <a target="_blank" href="../../information/run-examples.html">
                                Compilando y Ejecutando los Ejemplos: PFs</a>.
                        </p>
                        <p class="footertext">
                            ¿Quejas? ¿Elogios? ¿Sugerencias? <a target="_blank" href="https://docs.oracle.com/javase/feedback.html">
                                Denos su opinión</a>.
                        </p>
                    </td>
                </tr>
            </table>
        </div>
        <div class="PrintHeaders">
            <b>Página anterior:</b> Creando la Aplicación Demo (Paso 2)<br />
            <b>Página siguiente:</b> Refinando el Diseño
        </div>
    </body>
</html>