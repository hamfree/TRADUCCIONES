<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Creación de Esquemas de Bases de Datos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="persistence-intro005.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-intro007.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="CHDBEGIC">
      <h2 id="database-schema-creation">Creación de Esquemas de Bases de Datos</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            El proveedor de persistencia se puede configurar para crear automáticamente las tablas de la base 
            de datos, cargar datos en las tablas y eliminar las tablas durante la implementación de la 
            aplicación utilizando las propiedades estándar en el descriptor de implementación de la 
            aplicación. Estas tareas se utilizan normalmente durante la fase de desarrollo de una versión, no 
            en una base de datos de producción.
          </p>
        </div>
        <div class="paragraph">
          <p>
            El siguiente es un ejemplo de un descriptor de implementación <code>persistence.xml</code> que 
            especifica que el proveedor debe descartar todos los artefactos de la base de datos mediante un 
            script proporcionado, crear los artefactos con un script proporcionado y cargar datos desde un 
            script proporcionado cuando la aplicación está desplegada:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;?xml version="1.0" encoding="UTF-8"?&gt;
&lt;persistence version="2.1" xmlns="http://xmlns.jcp.org/xml/ns/persistence"
 xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
 xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/persistence
 http://xmlns.jcp.org/xml/ns/persistence/persistence_2_1.xsd"&gt;
  &lt;persistence-unit name="examplePU" transaction-type="JTA"&gt;
    &lt;jta-data-source&gt;java:global/ExampleDataSource&lt;/jta-data-source&gt;
    &lt;properties&gt;
        &lt;property name="javax.persistence.schema-generation.database.action"
                  value="drop-and-create"/&gt;
        &lt;property name="javax.persistence.schema-generation.create-source"
                  value="script"/&gt;
        &lt;property name="javax.persistence.schema-generation.create-script-source"
                  value="META-INF/sql/create.sql" /&gt;
        &lt;property name="javax.persistence.sql-load-script-source"
                  value="META-INF/sql/data.sql" /&gt;
        &lt;property name="javax.persistence.schema-generation.drop-source"
                  value="script" /&gt;
        &lt;property name="javax.persistence.schema-generation.drop-script-source"
                  value="META-INF/sql/drop.sql" /&gt;
    &lt;/properties&gt;
  &lt;/persistence-unit&gt;
&lt;/persistence&gt;
            </code></pre>
          </div>
        </div>
        <div class="sect2" id="sthref161">
          <h3 id="configuring-an-application-to-create-or-drop-database-tables">
            Configurando una Aplicación para Crear o Borrar Tablas de Bases de Datos
          </h3>
          <div class="paragraph">
            <p>
              La propiedad <code>javax.persistence.schema-generation.database.action</code> se utiliza para 
              especificar la acción que realiza el proveedor de persistencia cuando se implementa una 
              aplicación. Si no se establece la propiedad, el proveedor de persistencia no creará ni eliminará 
              ningún artefacto de la base de datos.
            </p>
          </div>
          <div class="paragraph">
            <p><a id="sthref162"></a><a id="sthref163"></a></p>
          </div>
          <div class="paragraph">
            <p><strong>Tabla 40-3 Acciones de Creación de Esquemas</strong></p>
          </div>
          <table class="tableblock frame-all grid-all" style="width: 75%;">
            <colgroup>
              <col style="width: 20%;">
              <col style="width: 80%;">
            </colgroup>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><strong>Ajuste</strong></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><strong>Descripción</strong></p></td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>none</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">No se creará ni eliminará ningún esquema.</p></td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>create</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    El proveedor creará los artefactos de la base de datos en la implementación de la 
                    aplicación. Los artefactos permanecerán sin cambios después de la redistribución de la 
                    aplicación.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>drop-and-create</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Se eliminarán todos los artefactos de la base de datos y el proveedor creará los 
                    artefactos de la base de datos en la implementación.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top"><p class="tableblock"><code>drop</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Cualquier artefacto en la base de datos se eliminará en la implementación de la 
                    aplicación.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="paragraph">
            <p>
              En este ejemplo, el proveedor de persistencia eliminará cualquier artefacto de base de datos 
              restante y luego creará los artefactos cuando se implemente la aplicación:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;property name="javax.persistence.schema-generation.database.action"
           value="drop-and-create"/&gt;
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              De forma predeterminada, los metadatos de objeto/relacionales en la unidad de persistencia se 
              utilizan para crear los artefactos de la base de datos. También puede proporcionar secuencias de 
              comandos utilizadas por el proveedor para crear y eliminar los artefactos de la base de datos. 
              Las propiedades <code>javax.persistence.schema-generation.create-source</code> y 
              <code>javax.persistence.schema-generation.drop-source</code> controlan cómo el proveedor creará 
              o eliminará los artefactos de la base de datos.
            </p>
          </div>
          <div class="paragraph">
            <p><a id="sthref164"></a><a id="sthref165"></a></p>
          </div>
          <div class="paragraph">
            <p><strong>Tabla 40-4 Configuración para Crear y Eliminar Propiedades de Origen</strong></p>
          </div>
          <table class="tableblock frame-all grid-all" style="width: 75%;">
            <colgroup>
              <col style="width: 20%;">
              <col style="width: 80%;">
            </colgroup>
            <tbody>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><strong>Ajuste</strong></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><strong>Descripción</strong></p></td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>metadata</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Utilice los metadatos de objeto/relacionales en la aplicación para crear o eliminar los 
                    artefactos de la base de datos.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>script</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Utilice un script proporcionado para crear o eliminar los artefactos de la base de datos.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>metadata-then-script</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Utilice una combinación de metadatos objeto/relacionales y, a continuación, un script 
                    proporcionado por el usuario para crear o eliminar los artefactos de la base de datos.
                  </p>
                </td>
              </tr>
              <tr>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock"><code>script-then-metadata</code></p></td>
                <td class="tableblock halign-left valign-top">
                  <p class="tableblock">
                    Utilice una combinación de un script proporcionado por el usuario, luego el 
                    objeto/metadatos relacionales para crear y eliminar los artefactos de la base de datos.
                  </p>
                </td>
              </tr>
            </tbody>
          </table>
          <div class="paragraph">
            <p>
              En este ejemplo, el proveedor de persistencia utilizará un script empaquetado dentro de la 
              aplicación para crear los artefactos de la base de datos:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;property name="javax.persistence.schema-generation.create-source"
           value="script"/&gt;
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Si especifica una secuencia de comandos en <code>create-source</code> o 
              <code>drop-source</code>, especifique la ubicación de la secuencia de comandos mediante 
              <code>javax.persistence.schema-generation.create-script -source</code> o propiedad 
              <code>javax.persistence.schema-generation.drop-script-source</code>. La ubicación del script es 
              relativa a la raíz de la unidad de persistencia:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;property name="javax.persistence.schema-generation.create-script-source"
           value="META-INF/sql/create.sql" /&gt;
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              En el ejemplo anterior, <code>create-script-source</code> se establece en un archivo SQL llamado 
              <code>create.sql</code> en el directorio <code>META-INF/sql</code> relativo a la raíz de la 
              unidad de persistencia.
            </p>
          </div>
        </div>
        <div class="sect2" id="sthref166">
          <h3 id="loading-data-using-sql-scripts">Cargando Datos Usando Scripts de SQL</h3>
          <div class="paragraph">
            <p>
              Si desea llenar las tablas de la base de datos con datos antes de que se cargue la aplicación, 
              especifique la ubicación de un script de carga en la propiedad 
              <code>javax.persistence.sql-load-script-source</code>. La ubicación especificada en esta 
              propiedad es relativa a la raíz de la unidad de persistencia.
            </p>
          </div>
          <div class="paragraph">
            <p>
              En este ejemplo, el script de carga es un archivo llamado <code>data.sql</code> en el directorio 
              <code>META-INF/sql</code> relativo a la raíz de la unidad de persistencia:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;property name="javax.persistence.sql-load-script-source"
          value="META-INF/sql/data.sql" /&gt;
                </code>
              </pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="persistence-intro005.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-intro007.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
