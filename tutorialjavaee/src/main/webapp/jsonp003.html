<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Usando la IPA del Modelo de Objetos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="jsonp002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jsonp004.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BABHAHIA">
      <h2 id="using-the-object-model-api">Usando la IPA del Modelo de Objetos</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Esta sección describe cuatro casos de uso de la API del modelo de objetos: crear un modelo de 
            objetos a partir de datos JSON, crear un modelo de objetos a partir del código de la aplicación, 
            navegar por un modelo de objetos y escribir un modelo de objetos en una secuencia.
          </p>
        </div>
        <div class="paragraph">
          <p>Aquí se tratan los siguientes temas:</p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p><a href="#BABBHEBA">Creando un Modelo de Objeto desde Datos JSON</a></p>
            </li>
            <li>
              <p><a href="#BABIGIAF">Creando un Modelo de Objeto desde Código de la Aplicación</a></p>
            </li>
            <li>
              <p><a href="#BABJHEHG">Navegando un Modelo de Objeto</a></p>
            </li>
            <li>
              <p><a href="#BABHEJFF">Escribiendo un Modelo de Objeto a un Flujo</a></p>
            </li>
          </ul>
        </div>
        <div class="sect2" id="BABBHEBA">
          <h3 id="creating-an-object-model-from-json-data">Creando un Modelo de Objeto desde Datos JSON</h3>
          <div class="paragraph">
            <p>
              El siguiente código muestra cómo crear un modelo de objetos a partir de datos JSON en un archivo 
              de texto:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
import java.io.FileReader;
import javax.json.Json;
import javax.json.JsonReader;
import javax.json.JsonStructure;
...
JsonReader reader = Json.createReader(new FileReader("jsondata.txt"));
JsonStructure jsonst = reader.read();
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              La referencia de objeto <code>jsonst</code> puede ser de tipo <code>JsonObject</code> o de tipo 
              <code>JsonArray</code>, según el contenido del archivo. <code>JsonObject</code> y 
              <code>JsonArray</code> son subtipos de <code>JsonStructure</code>. Esta referencia representa la 
              parte superior del árbol y se puede usar para navegar por el árbol o para escribirlo en una 
              secuencia como datos JSON.
            </p>
          </div>
        </div>
        <div class="sect2" id="BABIGIAF">
          <h3 id="creating-an-object-model-from-application-code">
            Creando un Modelo de Objeto desde Código de la Aplicación
          </h3>
          <div class="paragraph">
            <p>
              El siguiente código demuestra cómo crear un modelo de objetos a partir del código de la 
              aplicación:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
import javax.json.Json;
import javax.json.JsonObject;
...
JsonObject model = Json.createObjectBuilder()
   .add("firstName", "Duke")
   .add("lastName", "Java")
   .add("age", 18)
   .add("streetAddress", "100 Internet Dr")
   .add("city", "JavaTown")
   .add("state", "JA")
   .add("postalCode", "12345")
   .add("phoneNumbers", Json.createArrayBuilder()
      .add(Json.createObjectBuilder()
         .add("type", "mobile")
         .add("number", "111-111-1111"))
      .add(Json.createObjectBuilder()
         .add("type", "home")
         .add("number", "222-222-2222")))
   .build();
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              La referencia de objeto <code>model</code> representa la parte superior del árbol, que se crea 
              anidando llamadas a los métodos <code>add</code> y se construye llamando al método 
              <code>build</code>. La clase <code>JsonObjectBuilder</code> contiene los siguientes métodos 
              <code>add</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
JsonObjectBuilder add(String name, BigDecimal value)
JsonObjectBuilder add(String name, BigInteger value)
JsonObjectBuilder add(String name, boolean value)
JsonObjectBuilder add(String name, double value)
JsonObjectBuilder add(String name, int value)
JsonObjectBuilder add(String name, JsonArrayBuilder builder)
JsonObjectBuilder add(String name, JsonObjectBuilder builder)
JsonObjectBuilder add(String name, JsonValue value)
JsonObjectBuilder add(String name, long value)
JsonObjectBuilder add(String name, String value)
JsonObjectBuilder addNull(String name)
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              La clase <code>JsonArrayBuilder</code> contiene métodos <code>add</code> similares que no tienen 
              un parámetro de nombre (clave). Puede anidar matrices y objetos pasando un nuevo objeto 
              <code>JsonArrayBuilder</code> o un nuevo objeto <code>JsonObjectBuilder</code> al método 
              <code>add</code> correspondiente, como se muestra en este ejemplo.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El árbol resultante representa los datos JSON de 
              <a href="jsonp001.html#BABGHEHG">Sintaxis JSON</a>.
            </p>
          </div>
        </div>
        <div class="sect2" id="BABJHEHG">
          <h3 id="navigating-an-object-model">Navegando un Modelo de Objeto</h3>
          <div class="paragraph">
            <p>
              El siguiente código demuestra un enfoque simple para navegar por un modelo de objetos:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
import javax.json.JsonValue;
import javax.json.JsonObject;
import javax.json.JsonArray;
import javax.json.JsonNumber;
import javax.json.JsonString;
...
public static void navigateTree(JsonValue tree, String key) {
   if (key != null)
      System.out.print("Clave " + key + ": ");
   switch(tree.getValueType()) {
      case OBJECT:
         System.out.println("OBJETO");
         JsonObject object = (JsonObject) tree;
         for (String name : object.keySet())
            navigateTree(object.get(name), name);
         break;
      case ARRAY:
         System.out.println("MATRIZ");
         JsonArray array = (JsonArray) tree;
         for (JsonValue val : array)
            navigateTree(val, null);
         break;
      case STRING:
         JsonString st = (JsonString) tree;
         System.out.println("CADENA " + st.getString());
         break;
      case NUMBER:
         JsonNumber num = (JsonNumber) tree;
         System.out.println("NÚMERO " + num.toString());
         break;
      case TRUE:
      case FALSE:
      case NULL:
         System.out.println(tree.getValueType().toString());
         break;
   }
}
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              El método <code>navigateTree</code> se puede usar con los modelos integrados 
              <a href="#BABBHEBA">Creando un Modelo de Objeto desde Datos JSON</a> y 
              <a href="#BABIGIAF">Creando an Modelo de Objeto desde Código de la Aplicación</a> como sigue:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
navigateTree(model, null);
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              El método <code>navigateTree</code> toma dos argumentos: un elemento JSON y una clave. La clave 
              se usa solo para ayudar a imprimir los pares clave-valor dentro de los objetos. Los elementos de 
              un árbol están representados por el tipo <code>JsonValue</code>. Si el elemento es un objeto o 
              una matriz, se realiza una nueva llamada a este método para cada elemento contenido en el objeto 
              o la matriz. Si el elemento es un valor, se imprime en la salida estándar.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El método <code>JsonValue.getValueType</code> identifica el elemento como un objeto, una matriz 
              o un valor. Para los objetos, el método <code>JsonObject.keySet</code> devuelve un conjunto de 
              cadenas que contiene las claves del objeto, y el método <code>JsonObject.get(String name)</code> 
              devuelve el valor del elemento cuya clave es <code>name</code>. Para matrices, 
              <code>JsonArray</code> implementa la interfaz <code>List&lt;JsonValue&gt;</code>. Puede usar 
              bucles <code>for</code> mejorados con la instancia <code>Set&lt;String&gt;</code> devuelta por 
              <code>JsonObject.keySet</code> y con instancias de <code>JsonArray</code >, como se muestra en 
              este ejemplo.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El método <code>navigateTree</code> para el modelo construido en 
              <a href="#BABIGIAF">Creando un Modelo de Objeto desde Código de la Aplicación</a> produce el 
              siguiente resultado:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
OBJETO
Clave firstName: CADENA Duke
Clave lastName: CADENA Java
Clave age: NÚMERO 18
Clave streetAddress: CADENA 100 Internet Dr
Clave city: CADENA JavaTown
Clave state: CADENA JA
Clave postalCode: CADENA 12345
Clave phoneNumbers: ARRAY
OBJETO
Clave type: CADENA mobile
Clave number: CADENA 111-111-1111
OBJETO
Clave type: CADENA home
Clave number: CADENA 222-222-2222
              </code></pre>
            </div>
          </div>
        </div>
        <div class="sect2" id="BABHEJFF">
          <h3 id="writing-an-object-model-to-a-stream">Escribiendo un Modelo de Objeto a un Flujo</h3>
          <div class="paragraph">
            <p>
              Los modelos de objetos creados en 
              <a href="#BABBHEBA">Creando un Modelo de Objeto desde Datos JSON</a> y 
              <a href="#BABIGIAF">Creando an Modelo de Objeto desde Código de la Aplicación</a> se pueden 
              escribir en una secuencia usando la clase <code>JsonWriter</code> de la siguiente manera:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
import java.io.StringWriter;
import javax.json.JsonWriter;
...
StringWriter stWriter = new StringWriter();
JsonWriter jsonWriter = Json.createWriter(stWriter);
jsonWriter.writeObject(model);
jsonWriter.close();
String jsonData = stWriter.toString();
System.out.println(jsonData);
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              El método <code>Json.createWriter</code> toma un flujo de salida como parámetro. El método 
              <code>JsonWriter.writeObject</code> escribe el objeto en la secuencia. El método 
              <code>JsonWriter.close</code> cierra el flujo de salida subyacente.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El siguiente ejemplo usa <code>try</code>-with-resources para cerrar el escritor JSON 
              automáticamente:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
StringWriter stWriter = new StringWriter();
try (JsonWriter jsonWriter = Json.createWriter(stWriter)) {
   jsonWriter.writeObject(model);
}
String jsonData = stWriter.toString();
System.out.println(jsonData);
              </code></pre>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="jsonp002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jsonp004.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
