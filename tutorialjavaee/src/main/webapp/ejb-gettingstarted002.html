<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Creando el Enterprise Bean</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="ejb-gettingstarted001.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="ejb-gettingstarted003.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="GIPSS">
      <h2 id="creating-the-enterprise-bean">Creando el Enterprise Bean</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            El enterprise bean de nuestro ejemplo es un bean de sesión sin estado llamado 
            <code>ConverterBean</code>. El código fuente de <code>ConverterBean</code> está en el 
            directorio <code>_tut-install_/examples/ejb/converter/src/main/java/</code>.
          </p>
        </div>
        <div class="paragraph">
          <p>La creación de <code>ConverterBean</code> requiere estos pasos:</p>
        </div>
        <div class="olist arabic">
          <ol class="arabic">
            <li>
              <p>
                Codificación de la clase de implementación del bean (se proporciona el código 
                fuente)
              </p>
            </li>
            <li>
              <p>Compilar el código fuente</p>
            </li>
          </ol>
        </div>
        <div class="sect2" id="GIPSX">
          <h3 id="coding-the-enterprise-bean-class">Codificando la Clase del Enterprise Bean</h3>
          <div class="paragraph">
            <p>
              La clase de bean empresarial para este ejemplo se llama <code>ConverterBean</code>. 
              Esta clase implementa dos métodos de negocio: <code>dollarToYen</code> y 
              <code>yenToEuro</code>. Debido a que la clase de enterprise bean no implementa una 
              interfaz de negocio, el enterprise bean expone una vista local sin interfaz. Los 
              métodos públicos en la clase de enterprise bean están disponibles para los clientes 
              que obtienen una referencia a <code>ConverterBean</code>. El código fuente de la clase 
              <code>ConverterBean</code> es el siguiente:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
package javaeetutorial.converter.ejb;
import java.math.BigDecimal;
import javax.ejb.*;
@Stateless
public class ConverterBean {
    private BigDecimal yenRate = new BigDecimal("83.0602");
    private BigDecimal euroRate = new BigDecimal("0.0093016");
    public BigDecimal dollarToYen(BigDecimal dollars) {
        BigDecimal result = dollars.multiply(yenRate);
        return result.setScale(2, BigDecimal.ROUND_UP);
    }
    public BigDecimal yenToEuro(BigDecimal yen) {
        BigDecimal result = yen.multiply(euroRate);
        return result.setScale(2, BigDecimal.ROUND_UP);
    }
}
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Tenga en cuenta la anotación <code>@Stateless</code> que decora la clase de enterprise 
              bean. Esta anotación le permite al contenedor saber que <code>ConverterBean</code> es 
              un bean de sesión sin estado.
            </p>
          </div>
        </div>
        <div class="sect2" id="GIPSI">
          <h3 id="creating-the-converter-web-client">Creando el Cliente Web converter</h3>
          <div class="paragraph">
            <p>
              El cliente web está contenido en la siguiente clase de servlet en el directorio 
              <code>_tut-install_/examples/ejb/converter/src/main/java/</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
converter/web/ConverterServlet.java
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>Un servlet de Java es un componente web que responde a solicitudes HTTP.</p>
          </div>
          <div class="paragraph">
            <p>
              La clase <code>ConverterServlet</code> utiliza inyección de dependencia para obtener 
              una referencia a <code>ConverterBean</code>. La anotación <code>javax.ejb.EJB</code> 
              se agrega a la declaración de la variable miembro privada <code>converter</code>, que 
              es de tipo <code>ConverterBean</code>. <code>ConverterBean</code> expone una vista 
              local sin interfaz, por lo que la clase de implementación del enterprise bean es del 
              tipo variable:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@WebServlet(urlPatterns="/")
public class ConverterServlet extends HttpServlet {
  @EJB
  ConverterBean converter;
  ...
}
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Cuando el usuario ingresa una cantidad para convertir a yenes y euros, la cantidad se 
              recupera de los parámetros de solicitud; luego se llaman los métodos 
              <code>ConverterBean.dollarToYen</code> y <code>ConverterBean.yenToEuro</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
...
try {
  String amount = request.getParameter("amount");
  if (amount != null &amp;&amp; amount.length()&gt; 0) {
    // convertir la cantidad a BigDecimal desde el parámetro de solicitud
    BigDecimal d = new BigDecimal(amount);
    // llame al método ConverterBean.dollarToYen() para obtener la cantidad
    // en Yenes
    BigDecimal yenAmount = converter.dollarToYen(d);
    // llame al método ConverterBean.yenToEuro() para obtener la cantidad
    // en Euros
    BigDecimal euroAmount = converter.yenToEuro(yenAmount);
    ...
  }
  ...
}
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>Los resultados se muestran al usuario.</p>
          </div>
        </div>
        <div class="sect2" id="GIPVV">
          <h3 id="running-the-converter-example">Ejecutando el Ejemplo converter</h3>
          <div class="paragraph">
            <p>
              Ahora está listo para compilar la clase de enterprise bean 
              (<code>ConverterBean.java</code>) y la clase de servlet 
              (<code>ConverterServlet.java</code>) y empaquetar las clases compiladas en un archivo 
              WAR. Puede usar el EID NetBeans o Maven para compilar, empaquetar, implementar y 
              ejecutar el ejemplo de <code>converter</code>.
            </p>
          </div>
          <div class="paragraph">
            <p>Aquí se tratan los siguientes temas:</p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p><a href="#GIPUM">Para Ejecutar el Ejemplo converter Usando el EID NetBeans</a></p>
              </li>
              <li>
                <p><a href="#GIPVQ">Para Ejecutar el Ejemplo converter Usando Maven</a></p>
              </li>
            </ul>
          </div>
          <div class="sect3" id="GIPUM">
            <h4 id="to-run-the-converter-example-using-netbeans-ide">
              Para Ejecutar el Ejemplo converter Usando el EID NetBeans
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que se haya iniciado el Servidor GlassFish (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor 
                      GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En el menú Archivo, elija Abrir proyecto.</p>
                </li>
                <li>
                  <p>En el cuadro de diálogo Abrir proyecto, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/ejb
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Seleccione la carpeta <code>converter</code>.</p>
                </li>   
                <li>  
                  <p>Haga clic en Abrir proyecto.</p>
                </li>
                <li>
                  <p>
                    En la pestaña Proyectos, haga clic con el botón derecho en el proyecto 
                    <code>converter</code> y seleccione Build.
                  </p>
                </li>
                <li>
                  <p>Abra un navegador web en la siguiente URL:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/converter
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    En la página Servlet ConverterServlet, ingrese <code>100</code> en el campo y 
                    haga clic en Enviar.
                  </p>
                  <div class="paragraph">
                    <p>Se abre una segunda página que muestra los valores convertidos.</p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="GIPVQ">
            <h4 id="to-run-the-converter-example-using-maven">
              Para Ejecutar el Ejemplo converter Usando Maven
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que se haya iniciado el Servidor GlassFish (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor 
                      GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En una ventana de terminal, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/ejb/converter/
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Introduzca el siguiente comando:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
mvn install
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Este comando compila los archivos fuente para el enterprise bean y el servlet, 
                      empaqueta el proyecto en un módulo WAR (<code>converter.war</code>) y 
                      despliega el WAR en el servidor. Para obtener más información sobre Maven, consulte                               <a href="usingexamples005.html#BNAAN">Creación de ejemplos</a>.
                    </p>
                  </div>
                </li>
                <li>
                  <p>Abra un navegador web en la siguiente URL:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
                          http://localhost:8080/converter
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    En la página Servlet ConverterServlet, ingrese <code>100</code> en el campo y 
                    haga clic en Enviar.
                  </p>
                  <div class="paragraph">
                    <p>Se abre una segunda página que muestra los valores convertidos.</p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12  %"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="ejb-gettingstarted001.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="ejb-gettingstarted003.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
