<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Transacciones Gestionadas por Beans</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="transactions004.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="transactions006.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BNCIY">
      <h2 id="bean-managed-transactions">Transacciones Gestionadas por Beans</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            En la demarcación de transacciones administradas por beans, el código en la sesión o el bean 
            controlado por mensajes marca explícitamente los límites de la transacción. Aunque los beans con 
            transacciones administradas por contenedor requieren menos codificación, tienen una limitación: 
            cuando un método se está ejecutando, se puede asociar con una sola transacción o con ninguna 
            transacción. Si esta limitación dificulta la codificación de su bean, debería considerar el uso de 
            transacciones administradas por bean.
          </p>
        </div>
        <div class="paragraph">
          <p>
            El siguiente pseudocódigo ilustra el tipo de control detallado que puede obtener con las 
            transacciones administradas por la aplicación. Al verificar varias condiciones, el pseudocódigo 
            decide si iniciar o detener ciertas transacciones dentro del método de negocio:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
comenzar la transacción
...
     actualizar tabla-a
...
     si (condición-x)
    confirmar transacción
     pero si (condición-y)
    actualizar tabla-b
    confirmar transacción
     para las demás
    transacción de reversión
    comenzar la transacción
    actualizar tabla-c
    confirmar transacción
               </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Al codificar una transacción administrada por aplicaciones para beans controlados por mensajes o 
            sesiones, debe decidir si usará la conectividad de base de datos Java o las transacciones JTA. Las 
            secciones siguientes analizan ambos tipos de transacciones.
          </p>
        </div>
        <div class="sect2" id="BNCIZ">
          <h3 id="jta-transactions">Transacciones JTA</h3>
          <div class="paragraph">
            <p>
              JTA, o la IPA de Java Transaction, le permite demarcar transacciones de una manera independiente 
              de la implementación del administrador de transacciones. El servidor GlassFish implementa el 
              administrador de transacciones con Java Transaction Service (JTS). Sin embargo, su código no 
              llama a los métodos JTS directamente, sino que invoca los métodos JTA, que luego llaman a las 
              rutinas JTS de nivel inferior.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Una transacción JTA está controlada por el administrador de transacciones Java EE. Es posible 
              que desee utilizar una transacción JTA porque puede abarcar actualizaciones de varias bases de 
              datos de diferentes proveedores. Es posible que el administrador de transacciones de un DBMS en 
              particular no funcione con bases de datos heterogéneas. Sin embargo, el administrador de 
              transacciones Java EE tiene una limitación: no admite transacciones anidadas. En otras palabras, 
              no puede iniciar una transacción para una instancia hasta que finalice la transacción anterior.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Para delimitar una transacción JTA, invoque los métodos <code>begin</code>, <code>commit</code> 
              y <code>rollback</code> de la interfaz <code>javax.transaction.UserTransaction</code>.
            </p>
          </div>
        </div>
        <div class="sect2" id="BNCJA">
          <h3 id="returning-without-committing">Regresar sin Confirmar</h3>
          <div class="paragraph">
            <p>
              En un bean de sesión sin estado con transacciones administradas por bean, un método de negocio 
              debe confirmar o revertir una transacción antes de regresar. Sin embargo, un bean de sesión con 
              estado no tiene esta restricción.
            </p>
          </div>
          <div class="paragraph">
            <p>
              En un bean de sesión con estado con una transacción JTA, la asociación entre la instancia del 
              bean y la transacción se conserva en varias llamadas de clientes. Incluso si cada método de 
              negocio llamado por el cliente abre y cierra la conexión de la base de datos, la asociación se 
              conserva hasta que la instancia completa la transacción.
            </p>
          </div>
          <div class="paragraph">
            <p>
              En un bean de sesión con estado con una transacción JDBC, la conexión JDBC conserva la 
              asociación entre la instancia del bean y la transacción a través de varias llamadas. Si se 
              cierra la conexión, no se conserva la asociación.
            </p>
          </div>
        </div>
        <div class="sect2" id="BNCJB">
          <h3 id="methods-not-allowed-in-bean-managed-transactions">
            Métodos no Permitidos en Transacciones Gestionadas por Beans
          </h3>
          <div class="paragraph">
            <p>
              No invoque los métodos <code>getRollbackOnly</code> y <code>setRollbackOnly</code> de la 
              interfaz <code>EJBContext</code> en transacciones gestionadas por beans. Estos métodos deben 
              usarse solo en transacciones administradas por contenedores. Para transacciones administradas 
              por beans, invoque los métodos <code>getStatus</code> y <code>rollback</code> de la interfaz 
              <code>UserTransaction</code>.
            </p>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="transactions004.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="transactions006.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
