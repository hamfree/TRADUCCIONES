<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Descripción General de la Caché de Segundo Nivel</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="persistence-cache.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-cache002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="GKJIO">
      <h2 id="overview-of-the-second-level-cache">Descripción General de la Caché de Segundo Nivel</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Una caché de segundo nivel es un almacén local de datos de entidad administrado por el proveedor 
            de persistencia para mejorar el rendimiento de la aplicación. Un caché de segundo nivel ayuda a 
            mejorar el rendimiento al evitar costosas llamadas a la base de datos, manteniendo los datos de la 
            entidad locales para la aplicación. Una memoria caché de segundo nivel suele ser transparente para 
            la aplicación, ya que la administra el proveedor de persistencia y subyace en el contexto de 
            persistencia de una aplicación. Es decir, la aplicación lee y envía datos a través de las 
            operaciones normales del administrador de entidades sin conocer la memoria caché.
          </p>
        </div>
        <table class="tableblock frame-all grid-all spread">
          <colgroup>
            <col style="width: 100%;">
          </colgroup>
          <tbody>
            <tr>
              <td class="tableblock halign-left valign-top">
                <div>
                  <div class="paragraph">
                    <p><strong>Nota</strong>:</p>
                  </div>
                  <div class="paragraph">
                    <p>
                      Los proveedores de persistencia no están obligados a admitir una memoria caché de 
                      segundo nivel. Las aplicaciones portables no deben depender del soporte de los 
                      proveedores de persistencia para un caché de segundo nivel.
                    </p>
                  </div>
                </div>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="paragraph">
          <p>
            La memoria caché de segundo nivel para una unidad de persistencia se puede configurar en uno de 
            varios modos de memoria caché de segundo nivel. La siguiente configuración del modo de caché está 
            definida por la IPA de la Persistencia de Java.
          </p>
        </div>
        <div class="paragraph">
          <p><a id="sthref188"></a><a id="GKJDG"></a></p>
        </div>
        <div class="paragraph">
          <p><strong>Tabla 47-1 Configuración del Modo de Caché para el Caché de Segundo Nivel</strong></p>
        </div>
        <table class="tableblock frame-all grid-all" style="width: 80%;">
          <colgroup>
            <col style="width: 25%;">
            <col style="width: 75%;">
          </colgroup>
          <tbody>
            <tr>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock"><strong>Configuración del Modo de Caché</strong></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock"><strong>Descripción</strong></p></td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-top"><p class="tableblock"><code>ALL</code></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock">
                  Todos los datos de la entidad se almacenan en la memoria caché de segundo nivel para esta 
                  unidad de persistencia.
                </p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-top"><p class="tableblock"><code>NONE</code></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock">
                  No se almacenan datos en caché en la unidad de persistencia. El proveedor de persistencia no 
                  debe almacenar en caché ningún dato.
                </p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock"><code>ENABLE_SELECTIVE</code></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock">
                  Habilita el almacenamiento en caché para las entidades que se han establecido explícitamente 
                  con la anotación <code>@Cacheable</code>.
                </p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock"><code>DISABLE_SELECTIVE</code></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock">
                  Habilita el almacenamiento en caché para todas las entidades excepto aquellas que se hayan 
                  establecido explícitamente con la anotación <code>@Cacheable(false)</code>.
                </p>
              </td>
            </tr>
            <tr>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock"><code>UNSPECIFIED</code></p></td>
              <td class="tableblock halign-left valign-top">
                <p class="tableblock">
                  El comportamiento de almacenamiento en caché para la unidad de persistencia no está 
                  definido. Se utilizará el comportamiento de almacenamiento en caché predeterminado del 
                  proveedor de persistencia.
                </p>
              </td>
            </tr>
          </tbody>
        </table>
        <div class="paragraph">
          <p>
            Una consecuencia de usar un caché de segundo nivel en una aplicación es que los datos subyacentes 
            pueden haber cambiado en las tablas de la base de datos, mientras que el valor en el caché no, una 
            circunstancia denominada lectura obsoleta. Para evitar lecturas obsoletas, utilice cualquiera de 
            estas estrategias:
          </p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p>
                Cambie el caché de segundo nivel a una de las configuraciones del modo de caché
              </p>
            </li>
            <li>
              <p>
                Controlar qué entidades se pueden almacenar en caché (ver 
                <a href="#GKJIW">Controlar si las Entidades Pueden Almacenarse en Caché</a>)
              </p>
            </li>
            <li>
              <p>
                Cambie los modos de almacenamiento o recuperación de la memoria caché (consulte 
                <a href="persistence-cache002.html#GKJDK">
                  Configuración de los Modos de Almacenamiento y Recuperación de Caché</a>)
              </p>
            </li>
          </ul>
        </div>
        <div class="paragraph">
          <p>
            Cuál de estas estrategias funciona mejor para evitar lecturas obsoletas depende de la aplicación.
          </p>
        </div>
        <div class="sect2" id="GKJIW">
          <h3 id="controlling-whether-entities-may-be-cached">
            Controlar si las Entidades Pueden Almacenarse en Caché
          </h3>
          <div class="paragraph">
            <p>
              La anotación <code>javax.persistence.Cacheable</code> se usa para especificar que una clase de 
              entidad y cualquier subclase se pueden almacenar en caché cuando se usan los modos de caché
              <code>ENABLE_SELECTIVE</code> o <code>DISABLE_SELECTIVE</code>. Las subclases pueden anular la 
              configuración <code>@Cacheable</code> agregando una anotación <code>@Cacheable</code> y 
              cambiando el valor.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Para especificar que una entidad se puede almacenar en caché, agregue una anotación 
              <code>@Cacheable</code> en el nivel de clase:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@Cacheable
@Entity
public class Person { ... }
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              De forma predeterminada, la anotación <code>@Cacheable</code> es <code>true</code>. El siguiente 
              ejemplo es equivalente:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@Cacheable(true)
@Entity
public class Person{ ... }
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Para especificar que una entidad no debe almacenarse en caché, agregue una anotación 
              <code>@Cacheable</code> y establézcala en <code>false</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@Cacheable(false)
@Entity
public class OrderStatus { ... }
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Cuando se establece el modo de caché <code>ENABLE_SELECTIVE</code>, el proveedor de persistencia 
              almacenará en caché cualquier entidad que tenga la anotación <code>@Cacheable(true)</code> y 
              cualquier subclase de esa entidad que no haya sido anulada. El proveedor de persistencia no 
              almacenará en caché las entidades que tengan <code>@Cacheable(false)</code> o que no tengan la 
              anotación <code>@Cacheable</code>. Es decir, el modo <code>ENABLE_SELECTIVE</code> almacenará en 
              caché solo las entidades que se han marcado explícitamente para el caché mediante la anotación 
              <code>@Cacheable</code>.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Cuando se establece el modo de caché <code>DISABLE_SELECTIVE</code>, el proveedor de 
              persistencia almacenará en caché cualquier entidad que no tenga la anotación 
              <code>@Cacheable(false)</code>. Las entidades que no tienen anotaciones 
              <code>@Cacheable</code> y las entidades con la anotación <code>@Cacheable(true)</code> se 
              almacenarán en caché. Es decir, el modo <code>DISABLE_SELECTIVE</code> almacenará en caché todas 
              las entidades que no se hayan impedido explícitamente que se almacenen en caché.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Si el modo de caché se establece en <code>UNDEFINED</code>, o no se establece, el comportamiento 
              de las entidades anotadas con <code>@Cacheable</code> no está definido. Si el modo de caché se 
              establece en <code>ALL</code> o <code>NONE</code>, el proveedor de persistencia ignora el valor 
              de la anotación <code>@Cacheable</code>.
            </p>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="persistence-cache.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-cache002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
