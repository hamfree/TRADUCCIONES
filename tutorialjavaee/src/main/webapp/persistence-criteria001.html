<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Descripción General de las IPA de Criteria y Metamodelos</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="persistence-criteria.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-criteria002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="GJRIJ">
      <h2 id="overview-of-the-criteria-and-metamodel-apis">
        Descripción General de las IPA de Criteria y Metamodelos
      </h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Al igual que JPQL, la IPA de Criterios se basa en el esquema abstracto de entidades persistentes,
            sus relaciones y objetos incrustados. La IPA de Criterios opera en este esquema abstracto para 
            permitir que los desarrolladores busquen, modifiquen y eliminen entidades persistentes mediante la 
            invocación de operaciones de entidad de la IPA de Persistencia de Java. La IPA de Metamodel 
            funciona en conjunto con la IPA de Criterios para modelar clases de entidades persistentes para 
            consultas de Criterios.
          </p>
        </div>
        <div class="paragraph">
          <p>
            La IPA de Criterios y JPQL están estrechamente relacionadas y están diseñadas para permitir 
            operaciones similares en sus consultas. Los desarrolladores familiarizados con la sintaxis de JPQL 
            encontrarán operaciones equivalentes a nivel de objeto en la IPA de Criterios.
          </p>
        </div>
        <div class="paragraph">
          <p>
            La siguiente consulta de Criterios simple devuelve todas las instancias de la entidad 
            <code>Pet</code> en la fuente de datos:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
EntityManager em = ...;
CriteriaBuilder cb = em.getCriteriaBuilder();
CriteriaQuery&lt;Pet&gt; cq = cb.createQuery(Pet.class);
Root&lt;Pet&gt; pet = cq.from(Pet.class);
cq.select(pet);
TypedQuery&lt;Pet&gt; q = em.createQuery(cq);
List&lt;Pet&gt; allPets = q.getResultList();
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            La consulta JPQL equivalente es
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
SELECT p
FROM Pet p
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Esta consulta demuestra los pasos básicos para crear una consulta de Criterios.
          </p>
        </div>
        <div class="olist arabic">
          <ol class="arabic">
            <li>
              <p>
                Utilice una instancia de <code>EntityManager</code> para crear un objeto 
                <code>CriteriaBuilder</code>.
              </p>
            </li>
            <li>
              <p>
                Cree un objeto de consulta creando una instancia de la interfaz <code>CriteriaQuery</code>. 
                Los atributos de este objeto de consulta se modificarán con los detalles de la consulta.
              </p>
            </li>
            <li>
              <p>
                Establezca la raíz de la consulta llamando al método <code>from</code> en el objeto 
                <code>CriteriaQuery</code>.
              </p>
            </li>
            <li>
              <p>
                Especifique cuál será el tipo de resultado de la consulta llamando al método 
                <code>select</code> del objeto <code>CriteriaQuery</code>.
              </p>
            </li>
            <li>
              <p>
                Prepare la consulta para su ejecución creando una instancia de 
                <code>TypedQuery&lt;T&gt;</code>, especificando el tipo de resultado de la consulta.
              </p>
            </li>
            <li>
              <p>
                Ejecute la consulta llamando al método <code>getResultList</code> en el objeto 
                <code>TypedQuery&lt;T&gt;</code>. Debido a que esta consulta devuelve una colección de 
                entidades, el resultado se almacena en una <code>List</code>.
              </p>
            </li>
          </ol>
        </div>
        <div class="paragraph">
          <p>
            Las tareas asociadas con cada paso se describen en detalle en este capítulo.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Para crear una instancia de <code>CriteriaBuilder</code>, llama al método 
            <code>getCriteriaBuilder</code> en la instancia de <code>EntityManager</code>:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
CriteriaBuilder cb = em.getCriteriaBuilder();
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Utilice la instancia de <code>CriteriaBuilder</code> para crear un objeto de consulta:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
CriteriaQuery&lt;Pet&gt; cq = cb.createQuery(Pet.class);
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            La consulta devolverá instancias de la entidad <code>Pet</code>. Para crear una consulta con 
            seguridad de tipos, especifique el tipo de consulta cuando cree el objeto 
            <code>CriteriaQuery</code>.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Llame al método <code>from</code> del objeto de consulta para establecer la cláusula 
            <code>FROM</code> de la consulta y especificar la raíz de la consulta:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
Root&lt;Pet&gt; pet = cq.from(Pet.class);
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Llame al método <code>select</code> del objeto de consulta, pasando la raíz de la consulta, para 
            establecer la cláusula <code>SELECT</code> de la consulta:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
cq.select(pet);
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Ahora, use el objeto de consulta para crear un objeto <code>TypedQuery&lt;T&gt;</code> que se 
            puede ejecutar en la fuente de datos. Las modificaciones al objeto de consulta se capturan para 
            crear una consulta lista para ejecutar:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
TypedQuery&lt;Pet&gt; q = em.createQuery(cq);
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Ejecute este objeto de consulta escrito llamando a su método <code>getResultList</code>, porque 
            esta consulta devolverá varias instancias de entidad. La siguiente instrucción almacena los 
            resultados en un objeto con valor de colección <code>List&lt;Pet&gt;</code>:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
List&lt;Pet&gt; allPets = q.getResultList();
              </code>
            </pre>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="persistence-criteria.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-criteria002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
