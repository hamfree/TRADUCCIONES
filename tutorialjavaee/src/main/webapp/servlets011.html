<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Carga de Archivos con la Tecnología Java Servlet</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="servlets010.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="servlets012.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BABFGCHB">
      <h2 id="uploading-files-with-java-servlet-technology">
        Carga de Archivos con la Tecnología Java Servlet
      </h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            La compatibilidad con la carga de archivos es un requisito muy básico y común para muchas 
            aplicaciones web. En versiones anteriores de la especificación Servlet, implementar la carga de 
            archivos requería el uso de bibliotecas externas o un procesamiento de entrada complejo. La 
            especificación Java Servlet ahora ayuda a proporcionar una solución viable al problema de forma 
            genérica y portátil. La tecnología Java Servlet ahora admite la carga de archivos desde el primer 
            momento, por lo que cualquier contenedor web que implemente la especificación puede analizar 
            solicitudes de varias partes y hacer que los archivos adjuntos mime estén disponibles a través del 
            objeto <code>HttpServletRequest</code>.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Se utiliza una nueva anotación, <code>javax.servlet.annotation.MultipartConfig</code>, para 
            indicar que el servlet en el que se declara espera que se realicen solicitudes mediante el tipo 
            MIME <code>multipart/form-data</code>. Los servlets que están anotados con 
            <code>@MultipartConfig</code> pueden recuperar los componentes <code>Part</code> de una 
            determinada solicitud <code>multipart/form-data</code> llamando a 
            <code>request. método getPart(String name)</code> o <code>request.getParts()</code>.
          </p>
        </div>
        <div class="sect2" id="sthref101">
          <h3 id="the-multipartconfig-annotation">La Anotación @MultipartConfig</h3>
          <div class="paragraph">
            <p>
              La anotación <code>@MultipartConfig</code> admite los siguientes atributos opcionales.
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>
                  <code>location</code>: una ruta absoluta a un directorio en el sistema de archivos. El 
                  atributo <code>location</code> no admite una ruta relativa al contexto de la aplicación. 
                  Esta ubicación se usa para almacenar archivos temporalmente mientras se procesan las partes 
                  o cuando el tamaño del archivo excede la configuración <code>fileSizeThreshold</code> 
                  especificada. La ubicación predeterminada es <code>""</code>.
                </p>
              </li>
              <li>
                <p>
                  <code>fileSizeThreshold</code>: el tamaño del archivo en bytes después del cual el archivo 
                  se almacenará temporalmente en el disco. El tamaño predeterminado es 0 bytes.
                </p>
              </li>
              <li>
                <p>
                  <code>MaxFileSize</code>: el tamaño máximo permitido para los archivos subidos, en bytes. Si 
                  el tamaño de cualquier archivo cargado es mayor que este tamaño, el contenedor web generará 
                  una excepción (<code>IllegalStateException</code>). El tamaño predeterminado es ilimitado.
                </p>
              </li>
              <li>
                <p>
                  <code>maxRequestSize</code>: el tamaño máximo permitido para una solicitud 
                  <code>multipart/form-data</code>, en bytes. El contenedor web generará una excepción si el 
                  tamaño total de todos los archivos cargados supera este umbral. El tamaño predeterminado es 
                  ilimitado.
                </p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              Por ejemplo, la anotación <code>@MultipartConfig</code> podría construirse de la siguiente 
              manera:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@MultipartConfig(location="/tmp", fileSizeThreshold=1024*1024,
    maxFileSize=1024*1024*5, maxRequestSize=1024*1024*5*5)
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              En lugar de usar la anotación <code>@MultipartConfig</code> para codificar estos atributos en su 
              servlet de carga de archivos, puede agregar lo siguiente como elemento secundario del elemento 
              de configuración del servlet en el archivo <code>web.xml</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;multipart-config&gt;
    &lt;location&gt;/tmp&lt;/location&gt;
    &lt;max-file-size&gt;20848820&lt;/max-file-size&gt;
    &lt;max-request-size&gt;418018841&lt;/max-request-size&gt;
    &lt;file-size-threshold&gt;1048576&lt;/file-size-threshold&gt;
&lt;/multipart-config&gt;
                </code>
              </pre>
            </div>
          </div>
        </div>
        <div class="sect2" id="sthref102">
          <h3 id="the-getparts-and-getpart-methods">Los Métodos getParts y getPart</h3>
          <div class="paragraph">
            <p>
              La especificación de servlet admite dos métodos <code>HttpServletRequest</code> adicionales:
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p><code>Collection&lt;Part&gt; getParts()</code></p>
              </li>
              <li>
                <p><code>Part getPart(String name)</code></p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              El método <code>request.getParts()</code> devuelve colecciones de todos los objetos 
              <code>Part</code>. Si tiene más de una entrada de tipo archivo, se devuelven varios objetos 
              <code>Part</code>. Debido a que los objetos <code>Part</code> tienen nombre, el método 
              <code>getPart(String name)</code> se puede usar para acceder a un objeto <code>Part</code> 
              particular. Alternativamente, el método <code>getParts()</code>, que devuelve un 
              <code>Iterable&lt;Part&gt;</code>, se puede usar para obtener un <code>Iterator</code> sobre 
              todos los objetos <code>Part</code>.
            </p>
          </div>
          <div class="paragraph">
            <p>
              La interfaz <code>javax.servlet.http.Part</code> es simple y proporciona métodos que permiten la 
              introspección de cada <code>Part</code>. Los métodos hacen lo siguiente:
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>Recuperar el nombre, el tamaño y el tipo de contenido del <code>Part</code></p>
              </li>
              <li>
                <p>Consulta los encabezados enviados con un <code>Part</code></p>
              </li>
              <li>
                <p>Eliminar un objeto <code>Part</code></p>
              </li>
              <li>
                <p>Escribir un objeto <code>Part</code> en el disco</p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              Por ejemplo, la interfaz <code>Part</code> proporciona el método 
              <code>write(String filename)</code> para escribir el archivo con el nombre especificado. El 
              archivo se puede guardar en el directorio que se especifica con el atributo 
              <code>location</code> de la anotación <code>@MultipartConfig</code> o, en el caso del ejemplo 
              <code>fileupload</code>, en la ubicación especificada por el campo Destino en el formulario.
            </p>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="servlets010.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="servlets012.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
