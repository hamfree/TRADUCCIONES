<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Herencia de la Entidad</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="persistence-intro002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-intro004.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BNBQN">
      <h2 id="entity-inheritance">Herencia de la Entidad</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Las entidades admiten herencia de clases, asociaciones polimórficas y consultas polimórficas. Las 
            clases de entidad pueden extender las clases que no son de entidad, y las clases que no son de 
            entidad pueden extender las clases de entidad. Las clases de entidad pueden ser tanto abstractas 
            como concretas.
          </p>
        </div>
        <div class="paragraph">
          <p>
            La aplicación de ejemplo <code>roster</code> demuestra la herencia de entidades, como se describe 
            en <a href="persistence-basicexamples003.html#GIQRF">
              Herencia de Entidad en la Aplicación roster</a>.
          </p>
        </div>
        <div class="paragraph">
          <p>Aquí se tratan los siguientes temas:</p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p><a href="#BNBQO">Entidades Abstractas</a></p>
            </li>
            <li>
              <p><a href="#BNBQP">Superclases Mapeadas</a></p>
            </li>
            <li>
              <p><a href="#BNBQQ">Superclases Sin Entidad</a></p>
            </li>
            <li>
              <p><a href="#BNBQR">Estrategias de Mapeo de Herencia de Entidades</a></p>
            </li>
          </ul>
        </div>
        <div class="sect2" id="BNBQO">
          <h3 id="abstract-entities">Entidades Abstractas</h3>
          <div class="paragraph">
            <p>
              Una clase abstracta puede declararse una entidad decorando la clase con <code>@Entity</code>. 
              Las entidades abstractas son como las entidades concretas, pero no se pueden instanciar.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Las entidades abstractas se pueden consultar al igual que las entidades concretas. Si una 
              entidad abstracta es el objetivo de una consulta, la consulta opera en todas las subclases 
              concretas de la entidad abstracta:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@Entity
public abstract class Employee {
    @Id
    protected Integer employeeId;
    ...
}
@Entity
public class FullTimeEmployee extends Employee {
    protected Integer salary;
    ...
}
@Entity
public class PartTimeEmployee extends Employee {
    protected Float hourlyWage;
}
                </code>
              </pre>
            </div>
          </div>
        </div>
        <div class="sect2" id="BNBQP">
          <h3 id="mapped-superclasses">Superclases Mapeadas</h3>
          <div class="paragraph">
            <p>
              Las entidades pueden heredar de las superclases que contienen información de mapeo y estado 
              persistente, pero no son entidades. Es decir, la superclase no está decorada con la anotación 
              <code>@Entity</code> y el proveedor de persistencia de Java no la asigna como una entidad. Estas 
              superclases se usan con mayor frecuencia cuando tiene información de estado y mapeo común a 
              varias clases de entidad.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Las superclases mapeadas se especifican decorando la clase con la anotación 
              <code>javax.persistence.MappedSuperclass</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
@MappedSuperclass
public class Employee {
    @Id
    protected Integer employeeId;
    ...
}
@Entity
public class FullTimeEmployee extends Employee {
    protected Integer salary;
    ...
}
@Entity
public class PartTimeEmployee extends Employee {
    protected Float hourlyWage;
    ...
}
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Las superclases mapeadas no se pueden consultar y no se pueden usar en operaciones 
              <code>EntityManager</code> o <code>Query</code>. Debe usar subclases de entidad de la superclase 
              asignada en las operaciones <code>EntityManager</code> o <code>Query</code>. Las superclases 
              asignadas no pueden ser objetivos de las relaciones entre entidades. Las superclases mapeadas 
              pueden ser abstractas o concretas.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Las superclases asignadas no tienen tablas correspondientes en el almacén de datos subyacente. 
              Las entidades que heredan de la superclase asignada definen las asignaciones de tablas. Por 
              ejemplo, en el ejemplo de código anterior, las tablas subyacentes serían 
              <code>FULLTIMEEEMLOYEE</code> y <code>PARTTIMEEMPLOYEE</code>, pero no hay ninguna tabla 
              <code>EMPLOYEE</code>.
            </p>
          </div>
        </div>
        <div class="sect2" id="BNBQQ">
          <h3 id="non-entity-superclasses">Superclases Sin Entidad</h3>
          <div class="paragraph">
            <p>
              Las entidades pueden tener superclases que no sean entidades, y estas superclases pueden ser 
              abstractas o concretas. El estado de las superclases que no son entidades no es persistente, y 
              cualquier estado heredado de la superclase que no son entidades por una clase de entidad no es 
              persistente. Las superclases que no son entidades no se pueden usar en las operaciones 
              <code>EntityManager</code> o <code>Query</code>. Se ignora cualquier anotación de correlación o 
              relación en superclases que no sean entidades.
            </p>
          </div>
        </div>
        <div class="sect2" id="BNBQR">
          <h3 id="entity-inheritance-mapping-strategies">Estrategias de Mapeo de Herencia de Entidades</h3>
          <div class="paragraph">
            <p>
              Puede configurar cómo el proveedor de persistencia de Java asigna entidades heredadas al 
              almacén de datos subyacente decorando la clase raíz de la jerarquía con la anotación 
              <code>javax.persistence.Inheritance</code>. Las siguientes estrategias de asignación se utilizan 
              para asignar los datos de la entidad a la base de datos subyacente:
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>Una sola tabla por jerarquía de clases</p>
              </li>
              <li>
                <p>Una tabla por clase de entidad concreta</p>
              </li>
              <li>
                <p>
                  Una estrategia de "unión", mediante la cual los campos o propiedades que son específicos de 
                  una subclase se asignan a una tabla diferente a los campos o propiedades que son comunes a 
                  la clase principal.
                </p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              La estrategia se configura configurando el elemento <code>strategy</code> de 
              <code>@Inheritance</code> en una de las opciones definidas en el tipo enumerado 
              <code>javax.persistence.InheritanceType</code>:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
public enum InheritanceType {
    SINGLE_TABLE,
    JOINED,
    TABLE_PER_CLASS
};
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              La estrategia predeterminada, <code>InheritanceType.SINGLE_TABLE</code>, se usa si la anotación 
              <code>@Inheritance</code> no se especifica en la clase raíz de la jerarquía de entidades.
            </p>
          </div>
          <div class="sect3" id="BNBQS">
            <h4 id="the-single-table-per-class-hierarchy-strategy">
              La Estrategia de Jerarquía de Tabla Única por Clase
            </h4>
            <div class="paragraph">
              <p>
                Con esta estrategia, que corresponde al <code>InheritanceType.SINGLE_TABLE</code> 
                predeterminado, todas las clases de la jerarquía se asignan a una sola tabla en la base de 
                datos. Esta tabla tiene una columna discriminadora que contiene un valor que identifica la 
                subclase a la que pertenece la instancia representada por la fila.
              </p>
            </div>
            <div class="paragraph">
              <p>
                La columna discriminadora, cuyos elementos se muestran en la <a href="#BNBQT">Tabla 40-2</a>, 
                puede especificarse usando la anotación <code>javax.persistence.DiscriminatorColumn</code> en 
                la raíz de la jerarquía de clases de entidad.
              </p>
            </div>
            <div class="paragraph">
              <p><a id="sthref160"></a><a id="BNBQT"></a></p>
            </div>
            <div class="paragraph">
              <p><strong>Tabla 40-2 Elementos @DiscriminatorColumn</strong></p>
            </div>
            <table class="tableblock frame-all grid-all" style="width: 99%;">
              <colgroup>
                <col style="width: 20%;">
                <col style="width: 20%;">
                <col style="width: 60%;">
              </colgroup>
              <tbody>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><strong>Tipo</strong></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><strong>Nombre</strong></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><strong>Descripción</strong></p></td>
                </tr>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>String</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>name</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock">
                      El nombre de la columna que se utilizará como columna discriminadora. El valor 
                      predeterminado es <code>DTYPE</code>. Este elemento es opcional.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>DiscriminatorType</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>discriminatorType</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock">
                      El tipo de columna que se utilizará como columna discriminadora. El valor predeterminado 
                      es <code>DiscriminatorType.STRING</code>. Este elemento es opcional.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>String</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>columnDefinition</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock">
                      El fragmento de SQL que se usará al crear la columna discriminadora. El proveedor de 
                      persistencia genera el valor predeterminado y es específico de la implementación. Este 
                      elemento es opcional.
                    </p>
                  </td>
                </tr>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>String</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock"><code>length</code></p></td>
                  <td class="tableblock halign-left valign-top">
                    <p class="tableblock">
                      La longitud de columna para tipos de discriminadores basados en <code>String</code>. 
                      Este elemento se ignora para los tipos de discriminador que no son <code>String</code>. 
                      El valor predeterminado es 31. Este elemento es opcional.
                    </p>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="paragraph">
              <p>
                El tipo enumerado <code>javax.persistence.DiscriminatorType</code> se utiliza para establecer 
                el tipo de la columna discriminadora en la base de datos configurando el elemento 
                <code>discriminatorType</code> de <code>@DiscriminatorColumn</code> a uno de los tipos 
                definidos. <code>DiscriminatorType</code> se define de la siguiente manera:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight">
                  <code class="language-oac_no_warn" data-lang="oac_no_warn">
public enum DiscriminatorType {
    STRING,
    CHAR,
    INTEGER
};
                  </code>
                </pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                Si no se especifica <code>@DiscriminatorColumn</code> en la raíz de la jerarquía de entidades 
                y se requiere una columna discriminadora, el proveedor de persistencia asume un nombre de 
                columna predeterminado de <code>DTYPE</code> y un tipo de columna de 
                <code >TipoDiscriminador.STRING</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                La anotación <code>javax.persistence.DiscriminatorValue</code> se puede usar para establecer 
                el valor ingresado en la columna discriminadora para cada entidad en una jerarquía de clase. 
                Puede decorar solo clases de entidades concretas con <code>@DiscriminatorValue</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Si no se especifica <code>@DiscriminatorValue</code> en una entidad en una jerarquía de clase 
                que utiliza una columna discriminadora, el proveedor de persistencia proporcionará un valor 
                predeterminado específico de la implementación. Si el elemento 
                <code>discriminatorType</code> de <code>@DiscriminatorColumn</code> es 
                <code>DiscriminatorType.STRING</code>, el valor predeterminado es el nombre de la entidad.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Esta estrategia proporciona un buen soporte para relaciones polimórficas entre entidades y 
                consultas que cubren toda la jerarquía de clases de entidades. Sin embargo, esta estrategia 
                requiere que las columnas que contienen el estado de las subclases sean anulables.
              </p>
            </div>
          </div>
          <div class="sect3" id="BNBQU">
            <h4 id="the-table-per-concrete-class-strategy">La Tabla por Estrategia de Clase Concreta</h4>
            <div class="paragraph">
              <p>
                En esta estrategia, que corresponde a <code>InheritanceType.TABLE_PER_CLASS</code>, cada clase 
                concreta se asigna a una tabla separada en la base de datos. Todos los campos o propiedades de 
                la clase, incluidos los campos o las propiedades heredados, se asignan a las columnas de la 
                tabla de la clase en la base de datos.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Esta estrategia brinda poca compatibilidad con las relaciones polimórficas y, por lo general, 
                requiere consultas SQL <code>UNION</code> o consultas SQL separadas para cada subclase para 
                consultas que cubren toda la jerarquía de clases de entidad.
              </p>
            </div>
            <div class="paragraph">
              <p>
                La compatibilidad con esta estrategia es opcional y es posible que no la admitan todos los 
                proveedores de persistencia de IPA de Java. El proveedor de persistencia IPA de Java 
                predeterminado en el Servidor GlassFish no admite esta estrategia.
              </p>
            </div>
          </div>
          <div class="sect3" id="BNBQV">
            <h4 id="the-joined-subclass-strategy">La Estrategia de la Subclase Unida</h4>
            <div class="paragraph">
              <p>
                En esta estrategia, que corresponde a <code>InheritanceType.JOINED</code>, la raíz de la 
                jerarquía de clases está representada por una sola tabla y cada subclase tiene una tabla 
                separada que contiene solo los campos específicos de esa subclase. Es decir, la tabla de la 
                subclase no contiene columnas para campos o propiedades heredados. La tabla de la subclase 
                también tiene una columna o columnas que representan su clave principal, que es una clave 
                externa a la clave principal de la tabla de la superclase.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Esta estrategia proporciona un buen soporte para las relaciones polimórficas, pero requiere 
                que se realicen una o más operaciones de combinación al crear instancias de subclases de 
                entidades. Esto puede dar como resultado un rendimiento deficiente para jerarquías de clases 
                extensas. De manera similar, las consultas que cubren toda la jerarquía de clases requieren 
                operaciones de unión entre las tablas de subclases, lo que reduce el rendimiento.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Algunos proveedores de persistencia de IPA de Java, incluido el proveedor predeterminado en el 
                servidor GlassFish, requieren una columna discriminadora que corresponda a la entidad raíz 
                cuando se usa la estrategia de subclase unida. Si no está utilizando la creación automática de 
                tablas en su aplicación, asegúrese de que la tabla de la base de datos esté configurada 
                correctamente para los valores predeterminados de la columna discriminadora, o use la 
                anotación <code>@DiscriminatorColumn</code> para que coincida con el esquema de su base de 
                datos. Para obtener información sobre las columnas discriminatorias, consulte 
                <a href="#BNBQS">La Estrategia de Jerarquía de Tabla Única por Clase</a>.
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="persistence-intro002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="persistence-intro004.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
