<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Descripción General de la IPA Cliente</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="jaxrs-client.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jaxrs-client002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BABBIHEJ">
      <h2 id="overview-of-the-client-api">Descripción General de la IPA Cliente</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            La API de cliente JAX-RS proporciona una IPA de alto nivel para acceder a cualquier recurso REST, 
            no solo a los servicios JAX-RS. La IPA del cliente se define en el paquete 
            <code>javax.ws.rs.client</code>.
          </p>
        </div>
        <div class="paragraph">
          <p>Aquí se tratan los siguientes temas:</p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p><a href="#CHDFCABB">Creando una Petición Básica Cliente Usando la IPA Cliente</a></p>
            </li>
            <li>
              <p><a href="#CHDHBFHJ">Obteniendo la Instancia Cliente</a></p>
            </li>
            <li>
              <p><a href="#CHDDCICC">Estableciendo el Objetivo del Cliente</a></p>
            </li>
            <li>
              <p><a href="#CHDDBFCG">Estableciendo los Parámetros de Ruta en los Objetivos</a></p>
            </li>
            <li>
              <p><a href="#CHDEFCDB">Invocando la Petición</a></p>
            </li>
          </ul>
        </div>
        <div class="sect2" id="CHDFCABB">
          <h3 id="creating-a-basic-client-request-using-the-client-api">
            Creando una Petición Básica Cliente Usando la IPA Cliente
          </h3>
          <div class="paragraph">
            <p>
              Los siguientes pasos son necesarios para acceder a un recurso REST mediante la IPA de cliente.
            </p>
          </div>
          <div class="olist arabic">
            <ol class="arabic">
              <li>
                <p>Obtenga una instancia de la interfaz <code>javax.ws.rs.client.Client</code>.</p>
              </li>
              <li>
                <p>Configure la instancia de <code>Client</code> con un objetivo.</p>
              </li>
              <li>
                <p>Cree una solicitud basada en el objetivo.</p>
              </li>
              <li>
                <p>Invoque la solicitud.</p>
              </li>
            </ol>
          </div>
          <div class="paragraph">
            <p>
              La IPA del cliente está diseñada para ser fluida, con invocaciones de métodos encadenadas para 
              configurar y enviar una solicitud a un recurso REST en solo unas pocas líneas de código.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
String name = client.target("http://example.com/webapi/hello")
        .request(MediaType.TEXT_PLAIN)
        .get(String.class);
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              En este ejemplo, la instancia del cliente se crea primero llamando al método 
              <code>javax.ws.rs.client.ClientBuilder.newClient</code>. Luego, la solicitud se configura e 
              invoca mediante el encadenamiento de llamadas a métodos en una línea de código. El método 
              <code>Client.target</code> establece el destino en función de un URI. El método 
              <code>javax.ws.rs.client.WebTarget.request</code> establece el tipo de medio para la entidad 
              devuelta. El método <code>javax.ws.rs.client.Invocation.Builder.get</code> invoca el servicio 
              mediante una solicitud HTTP <code>GET</code>, estableciendo el tipo de entidad devuelta en 
              <code>String</code>.
            </p>
          </div>
        </div>
        <div class="sect2" id="CHDHBFHJ">
          <h3 id="obtaining-the-client-instance">Obteniendo la Instancia Cliente</h3>
          <div class="paragraph">
            <p>
              La interfaz <code>Client</code> define las acciones y la infraestructura que requiere un cliente 
              REST para consumir un servicio web RESTful. Las instancias de <code>Client</code> se obtienen 
              llamando al método <code>ClientBuilder.newClient</code>.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Utilice el método <code>close</code> para cerrar las instancias de <code>Client</code> después 
              de que se hayan realizado todas las invocaciones para el recurso de destino:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
...
client.close();
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Las instancias de <code>Client</code> son objetos pesados. Por motivos de rendimiento, limite la 
              cantidad de instancias de <code>Client</code> en su aplicación, ya que la inicialización y 
              destrucción de estas instancias puede resultar costosa en su entorno de tiempo de ejecución.
            </p>
          </div>
        </div>
        <div class="sect2" id="CHDDCICC">
          <h3 id="setting-the-client-target">Estableciendo el Objetivo del Cliente</h3>
          <div class="paragraph">
            <p>
              El destino de un cliente, el recurso REST en un URI particular, está representado por una 
              instancia de la interfaz <code>javax.ws.rs.client.WebTarget</code>. Obtiene una instancia de 
              <code>WebTarget</code> llamando al método <code>Client.target</code> y pasando el URI del 
              recurso REST de destino.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
WebTarget myResource = client.target("http://example.com/webapi");
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Para recursos REST complejos, puede ser beneficioso crear varias instancias de 
              <code>WebTarget</code>. En el siguiente ejemplo, se utiliza un destino base para construir 
              varios otros destinos que representan diferentes servicios proporcionados por un recurso REST.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
WebTarget base = client.target("http://example.com/webapi");
// WebTarget at http://example.com/webapi/read
WebTarget read = base.path("read");
// WebTarget at http://example.com/webapi/write
WebTarget write = base.path("write");
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              El método <code>WebTarget.path</code> crea una nueva instancia de <code>WebTarget</code> 
              agregando el URI de destino actual con la ruta que se pasó.
            </p>
          </div>
        </div>
        <div class="sect2" id="CHDDBFCG">
          <h3 id="setting-path-parameters-in-targets">
            Estableciendo los Parámetros de Ruta en los Objetivos
          </h3>
          <div class="paragraph">
            <p>
              Los parámetros de ruta en las solicitudes de los clientes se pueden especificar como parámetros 
              de plantilla de URI, de forma similar a los parámetros de plantilla utilizados al definir un URI 
              de recurso en un servicio JAX-RS. Los parámetros de plantilla se especifican rodeando la 
              variable de plantilla con llaves (<code>{}</code>). Llame al método <code>resolveTemplate</code> 
              para sustituir el <code>{username}</code>, y luego llame al método <code>queryParam</code> para 
              agregar otra variable para pasar.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
WebTarget myResource = client.target("http://example.com/webapi/read")
        .path("{userName}")
        .resolveTemplate("userName", "janedoe")        
        .queryParam("chapter", "1");// http://example.com/webapi/read/janedoe?chapter=1
Response response = myResource.request(...)        
        .get();
                </code>
              </pre>
            </div>
          </div>
        </div>
        <div class="sect2" id="CHDEFCDB">
          <h3 id="invoking-the-request">Invocando la Petición</h3>
          <div class="paragraph">
            <p>
              Después de establecer y aplicar cualquier opción de configuración al destino, llame a uno de los 
              métodos <code>WebTarget.request</code> para comenzar a crear la solicitud. Esto generalmente se 
              logra pasando a <code>WebTarget.request</code> el tipo de respuesta de medios aceptado para la 
              solicitud, ya sea como una cadena del tipo MIME o usando una de las constantes en 
              <code>javax.ws.rs.core.MediaType</code>. El método <code>WebTarget.request</code> devuelve una 
              instancia de <code>javax.ws.rs.client.Invocation.Builder</code>, un objeto auxiliar que 
              proporciona métodos para preparar la solicitud del cliente.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
WebTarget myResource = client.target("http://example.com/webapi/read");
Invocation.Builder builder = myResource.request(MediaType.TEXT_PLAIN);
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Usar una constante <code>MediaType</code> es equivalente a usar la cadena que define el tipo 
              MIME.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Invocation.Builder builder = myResource.request("text/plain");
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Después de configurar el tipo de medio, invoque la solicitud llamando a uno de los métodos de la 
              instancia <code>Invocation.Builder</code> que corresponda al tipo de solicitud HTTP que espera 
              el recurso REST de destino. Estos métodos son:
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p><code>get()</code></p>
              </li>
              <li>
                <p><code>post()</code></p>
              </li>
              <li>
                <p><code>delete()</code></p>
              </li>
              <li>
                <p><code>put()</code></p>
              </li>
              <li>
                <p><code>head()</code></p>
              </li>
              <li>
                <p><code>options()</code></p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              Por ejemplo, si el recurso REST de destino es para una solicitud HTTP GET, llame al método 
              <code>Invocation.Builder.get</code>. El tipo de devolución debe corresponder a la entidad 
              devuelta por el recurso REST de destino.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
WebTarget myResource = client.target("http://example.com/webapi/read");
String response = myResource.request(MediaType.TEXT_PLAIN)
        .get(String.class);
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Si el recurso REST de destino espera una solicitud HTTP POST, llame al método 
              <code>Invocation.Builder.post</code>.
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
Client client = ClientBuilder.newClient();
StoreOrder order = new StoreOrder(...);
WebTarget myResource = client.target("http://example.com/webapi/write");
TrackingNumber trackingNumber = myResource.request(MediaType.APPLICATION_XML)
                                   .post(Entity.xml(order), TrackingNumber.class);
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              En el ejemplo anterior, el tipo de devolución es una clase personalizada y se recupera 
              configurando el tipo en el método 
              <code>Invocación.Builder.post(Entity&lt;?&gt; entity, Class&lt;T&gt; responseType)</code> como 
              un parámetro.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Si el tipo de devolución es una colección, utilice 
              <code>javax.ws.rs.core.GenericType&lt;T&gt;</code> como parámetro de tipo de respuesta, donde 
              <code>T</code> es el tipo de colección:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight">
                <code class="language-oac_no_warn" data-lang="oac_no_warn">
List&lt;StoreOrder&gt; orders = client.target("http://example.com/webapi/read")
        .path("allOrders")
        .request(MediaType.APPLICATION_XML)
        .get(new GenericType&lt;List&lt;StoreOrder&gt;&gt;() {});
                </code>
              </pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Este ejemplo anterior muestra cómo se encadenan los métodos en la IPA de cliente para 
              simplificar la forma en que se configuran e invocan las solicitudes.
            </p>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="jaxrs-client.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jaxrs-client002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
