<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Trabajar con Certificados Digitales</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="security-advanced.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="security-advanced002.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="BNBYB">
      <h2 id="working-with-digital-certificates">Trabajar con Certificados Digitales</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Los certificados digitales para el servidor GlassFish ya se generaron y se pueden encontrar en el 
            directorio domain-dir`/config/`. Estos certificados digitales están autofirmados y están 
            destinados para su uso en un entorno de desarrollo; no están destinados a fines de producción. Para 
            fines de producción, genere sus propios certificados y pídales que los firme una autoridad de 
            certificación (CA).
          </p>
        </div>
        <div class="paragraph">
          <p>
            Para usar la capa de sockets seguros (SSL), una aplicación o servidor web debe tener un 
            certificado asociado para cada interfaz externa o dirección IP que acepte conexiones seguras. La 
            teoría detrás de este diseño es que un servidor debe proporcionar algún tipo de garantía razonable 
            de que su propietario es quien cree que es, especialmente antes de recibir información 
            confidencial. Puede ser útil pensar en un certificado como una "licencia de conducir digital" para 
            una dirección de Internet. El certificado indica con qué empresa está asociado el sitio, junto con 
            información de contacto básica sobre el propietario o administrador del sitio.
          </p>
        </div>
        <div class="paragraph">
          <p>
            El certificado digital está firmado criptográficamente por su propietario y es difícil de 
            falsificar para cualquier otra persona. Para los sitios involucrados en el comercio electrónico o 
            en cualquier otra transacción comercial en la que la autenticación de la identidad sea importante, 
            se puede comprar un certificado de una Autoridad de Certificación (CA, en inglés) conocida como 
            VeriSign o Thawte. Si su certificado de servidor está autofirmado, debe instalarlo en el archivo 
            de almacén de claves del servidor GlassFish (<code>keystore.jks</code>). Si su certificado de 
            cliente está autofirmado, debe instalarlo en el archivo de almacén de confianza del servidor 
            GlassFish (<code>cacerts.jks</code>).
          </p>
        </div>
        <div class="paragraph">
          <p>
            A veces, la autenticación no es realmente una preocupación. Por ejemplo, es posible que un 
            administrador simplemente quiera asegurarse de que los datos que el servidor transmite y recibe 
            son privados y no pueden ser espiados por nadie que esté espiando la conexión. En tales casos, 
            puede ahorrar el tiempo y los gastos que implica obtener un certificado de CA y simplemente 
            utilizar un certificado autofirmado.
          </p>
        </div>
        <div class="paragraph">
          <p>
            SSL utiliza criptografía de clave pública, que se basa en pares de claves. Los pares de claves 
            contienen una clave pública y una clave privada. Los datos cifrados con una clave solo se pueden 
            descifrar con la otra clave del par. Esta propiedad es fundamental para establecer confianza y 
            privacidad en las transacciones. Por ejemplo, al usar SSL, el servidor calcula un valor y lo 
            encripta usando su clave privada. El valor cifrado se denomina firma digital. El cliente descifra 
            el valor cifrado utilizando la clave pública del servidor y compara el valor con su propio valor 
            calculado. Si los dos valores coinciden, el cliente puede confiar en que la firma es auténtica, 
            porque solo se podría haber utilizado la clave privada para producir dicha firma.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Los certificados digitales se utilizan con HTTPS para autenticar clientes web. El servicio HTTPS 
            de la mayoría de los servidores web no se ejecutará a menos que se haya instalado un certificado 
            digital. Use el procedimiento descrito en la siguiente sección, 
            <a href="#BNBYC">Creación de un Certificado de Servidor</a>, para configurar un certificado 
            digital que pueda usar su aplicación o servidor web para habilitar SSL.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Una herramienta que se puede utilizar para configurar un certificado digital es 
            <code>keytool</code>, una utilidad de gestión de claves y certificados que se incluye con el JDK. 
            Esta herramienta permite a los usuarios administrar sus propios pares de claves pública/privada y 
            los certificados asociados para usar en la autoautenticación, mediante la cual el usuario se 
            autentica ante otros usuarios o servicios, o servicios de autenticación e integridad de datos, 
            mediante firmas digitales. La herramienta también permite a los usuarios almacenar en caché las 
            claves públicas, en forma de certificados, de sus compañeros de comunicación.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Para comprender mejor <code>keytool</code> y la criptografía de clave pública, consulte 
            <a href="security-advanced008.html#BABBGBBF">
              Más Información sobre Temas Avanzados de Seguridad
            </a> para obtener un enlace a la Documentación de <code>keytool</code>.
          </p>
        </div>
        <div class="sect2" id="BNBYC">
          <h3 id="creating-a-server-certificate">Creación de un Certificado de Servidor</h3>
          <div class="paragraph">
            <p>
              Ya se ha creado un certificado de servidor para el servidor GlassFish y se puede encontrar en el 
              directorio domain-dir`/config/`. El certificado del servidor está en 
              <code>keystore.jks</code>. El archivo <code>cacerts.jks</code> contiene todos los certificados 
              de confianza, incluidos los certificados de cliente.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Si es necesario, puede usar <code>keytool</code> para generar certificados. La utilidad 
              <code>keytool</code> almacena las claves y los certificados en un archivo denominado almacén de 
              claves, un depósito de certificados que se utiliza para identificar un cliente o un servidor. 
              Normalmente, un almacén de claves es un archivo que contiene la identidad de un cliente o un 
              servidor. El almacén de claves protege las claves privadas mediante el uso de una contraseña.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Si no especifica un directorio al especificar el nombre del archivo del almacén de claves, los 
              almacenes de claves se crean en el directorio desde el que se ejecuta el comando 
              <code>keytool</code>. Este puede ser el directorio donde reside la aplicación o puede ser un 
              directorio común a muchas aplicaciones.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Los pasos generales para crear un certificado de servidor son los siguientes.
            </p>
          </div>
          <div class="olist arabic">
            <ol class="arabic">
              <li>
                <p>Cree el almacén de claves.</p>
              </li>
              <li>
                <p>Exporte el certificado del almacén de claves.</p>
              </li>
              <li>
                <p>Firme el certificado.</p>
              </li>
              <li>
                <p>
                  Importe el certificado a un almacén de confianza: un depósito de certificados que se utiliza 
                  para verificar los certificados. Un almacén de confianza normalmente contiene más de un 
                  certificado.
                </p>
              </li>
            </ol>
          </div>
          <div class="paragraph">
            <p>
              La siguiente sección proporciona información específica sobre el uso de la utilidad 
              <code>keytool</code> para realizar estos pasos.
            </p>
          </div>
          <div class="sect3" id="GJRGY">
            <h4 id="to-use-keytool-to-create-a-server-certificate">
              Cómo Utilizar keytool para Crear un Certificado de Servidor
            </h4>
            <div class="paragraph">
              <p>
                Ejecute <code>keytool</code> para generar un nuevo par de claves en el archivo de almacén de 
                claves de desarrollo predeterminado, <code>keystore.jks</code>. Este ejemplo utiliza el alias 
                <code>server-alias</code> para generar un nuevo par de claves pública/privada y envolver la 
                clave pública en un certificado autofirmado dentro de <code>keystore.jks</code>. El par de 
                claves se genera utilizando un algoritmo de tipo RSA, con una contraseña predeterminada de 
                <code>changeit</code>. Para obtener más información y otros ejemplos de cómo crear y 
                administrar archivos de almacenamiento de claves, lea la documentación de 
                <code>keytool</code>.
              </p>
            </div>
            <table class="tableblock frame-all grid-all spread">
              <colgroup>
                <col style="width: 100%;">
              </colgroup>
              <tbody>
                <tr>
                  <td class="tableblock halign-left valign-top">
                    <div>
                      <div class="paragraph">
                        <p>Nota:</p>
                      </div>
                      <div class="paragraph">
                        <p>
                          RSA es una tecnología de cifrado de clave pública desarrollada por RSA Data 
                          Security, Inc.
                        </p>
                      </div>
                    </div>
                  </td>
                </tr>
              </tbody>
            </table>
            <div class="paragraph">
              <p>
                Desde el directorio en el que desea crear el par de claves, ejecute <code>keytool</code> como 
                se muestra en los siguientes pasos.
              </p>
            </div>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>Genere el certificado del servidor.</p>
                  <div class="paragraph">
                    <p>Ingrese el comando <code>keytool</code> todo en una línea:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
java-home/bin/keytool -genkey -alias server-alias -keyalg RSA
-keypass changeit -storepass changeit -keystore keystore.jks
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Cuando presiona Intro, <code>keytool</code> le solicita que ingrese el nombre del 
                      servidor, la unidad organizativa, la organización, la localidad, el estado y el código 
                      del país.
                    </p>
                  </div>
                  <div class="paragraph">
                    <p>
                      Debe ingresar el nombre del servidor en respuesta al primer aviso de 
                      <code>keytool</code>, en el que solicita el nombre y el apellido. Para fines de prueba, 
                      puede ser <code>localhost</code>.
                    </p>
                  </div>
                </li>
                <li>
                  <p>
                    Exporte el certificado del servidor generado en <code>keystore.jks</code> al archivo 
                    <code>server.cer</code>.
                  </p>
                  <div class="paragraph">
                    <p>Ingrese el comando <code>keytool</code> todo en una línea:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
java-home/bin/keytool -export -alias server-alias -storepass changeit
-file server.cer -keystore keystore.jks
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    Si desea que una CA firme el certificado, lea el ejemplo en la documentación de 
                    <code>keytool</code>.
                  </p>
                </li>
                <li>
                  <p>
                    Para agregar el certificado del servidor al archivo del almacén de confianza, 
                    <code>cacerts.jks</code>, ejecute <code>keytool</code> desde el directorio donde creó el 
                    almacén de claves y el certificado del servidor.
                  </p>
                  <div class="paragraph">
                    <p>Utilice los siguientes parámetros:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
java-home/bin/keytool -import -v -trustcacerts -alias server-alias
-file server.cer -keystore cacerts.jks -keypass changeit
-storepass changeit
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>Aparecerá información sobre el certificado, como la que se muestra a continuación:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Owner: CN=localhost, OU=My Company, O=Software, L=Santa Clara, ST=CA, C=US
Issuer: CN=localhost, OU=My Company, O=Software, L=Santa Clara, ST=CA, C=US
Serial number: 3e932169
Valid from: Mon Nov 26 18:15:47 EST 2012 until: Sun Feb 24 18:15:47 EST 2013
Certificate fingerprints:
         MD5: 52:9F:49:68:ED:78:6F:39:87:F3:98:B3:6A:6B:0F:90
         SHA1: EE:2E:2A:A6:9E:03:9A:3A:1C:17:4A:28:5E:97:20:78:3F:
         SHA256: 80:05:EC:7E:50:50:5D:AA:A3:53:F1:11:9B:19:EB:0D:20:67:C1:12:
AF:42:EC:CD:66:8C:BD:99:AD:D9:76:95
         Signature algorithm name: SHA256withRSA         Version: 3
         ...
Trust this certificate? [no]:
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Ingrese <code>yes</code>, luego presione la tecla Enter o Return.</p>
                  <div class="paragraph">
                    <p>Aparece la siguiente información:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Certificate was added to keystore
[Storing cacerts.jks]
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
        </div>
        <div class="sect2" id="GLIFW">
          <h3 id="adding-users-to-the-certificate-realm">Adición de Usuarios al Dominio del Certificado</h3>
          <div class="paragraph">
            <p>
              En el dominio <code>certificate</code>, la identidad del usuario se configura en el contexto de 
              seguridad del servidor GlassFish y se completa con datos de usuario obtenidos de certificados de 
              cliente verificados criptográficamente. Para obtener instrucciones paso a paso para crear este 
              tipo de certificado, consulte <a href="#BNBYB">Trabajar con Certificados Digitales</a>.
            </p>
          </div>
        </div>
        <div class="sect2" id="BNBYF">
          <h3 id="using-a-different-server-certificate-with-glassfish-server">
            Uso de un Certificado de Servidor Diferente con el Servidor GlassFish
          </h3>
          <div class="paragraph">
            <p>
              Siga los pasos en 
              <a href="#BNBYC">Creación de un Certificado de Servidor</a> para crear su propio certificado de 
              servidor, haga que lo firme una CA e importe el certificado a <code>keystore.jks</code>.
            </p>
          </div>
          <div class="paragraph">
            <p>Asegúrese de seguir estas reglas cuando cree el certificado.</p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>
                  Cuando crea el certificado del servidor, <code>keytool</code> le solicita que ingrese su 
                  nombre y apellido. En respuesta a este mensaje, debe ingresar el nombre de su servidor. Para 
                  fines de prueba, puede ser <code>localhost</code>.
                </p>
              </li>
              <li>
                <p>
                  Si desea reemplazar el <code>keystore.jks</code> existente, debe cambiar la contraseña de su 
                  almacén de claves a la contraseña predeterminada (<code>changeit</code>) o cambiar la 
                  contraseña predeterminada a la contraseña de su almacén de claves.
                </p>
              </li>
            </ul>
          </div>
          <div class="sect3" id="sthref230">
            <h4 id="to-specify-a-different-server-certificate">
              Cómo Especificar un Certificado de Servidor Diferente
            </h4>
            <div class="paragraph">
              <p>
                Para especificar que el servidor GlassFish debe usar el nuevo almacén de claves para las 
                decisiones de autenticación y autorización, debe configurar las opciones de JVM para el 
                servidor GlassFish para que reconozcan el nuevo almacén de claves. Para utilizar un almacén de 
                claves diferente del proporcionado para fines de desarrollo, siga estos pasos.
              </p>
            </div>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Inicie el servidor GlassFish si aún no lo ha hecho. Puede encontrar información sobre cómo 
                    iniciar el servidor GlassFish en 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>.
                  </p>
                </li>
                <li>
                  <p>
                    Abra la consola de administración del servidor GlassFish en un navegador web en 
                    <code>http://localhost:4848</code>.
                  </p>
                </li>
                <li>
                  <p>
                    Expanda Configuraciones, luego expanda server-config, luego haga clic en Configuración de 
                    JVM.
                  </p>
                </li>
                <li>
                  <p>Haga clic en la pestaña Opciones de JVM.</p>
                </li>
                <li>
                  <p>
                    Cambie las siguientes opciones de JVM para que apunten a la ubicación y el nombre del 
                    nuevo almacén de claves. La configuración actual se muestra a continuación:
                  </p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
-Djavax.net.ssl.keyStore=${com.sun.aas.instanceRoot}/config/keystore.jks
-Djavax.net.ssl.trustStore=${com.sun.aas.instanceRoot}/config/cacerts.jks
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    Si ha cambiado la contraseña del almacén de claves de su valor predeterminado, también 
                    debe agregar la opción de contraseña:
                  </p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
-Djavax.net.ssl.keyStorePassword=your-new-password
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Haga clic en Guardar, luego reinicie el servidor GlassFish.</p>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="security-advanced.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="security-advanced002.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
