<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>El Ejemplo de Concurrencia jobs</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="concurrency-utilities004.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="concurrency-utilities006.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="CIHCGGEG">
      <h2 id="the-jobs-concurrency-example">El Ejemplo de Concurrencia jobs</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            Esta sección describe un ejemplo muy básico que muestra cómo usar algunas de las características 
            básicas de concurrencia en una aplicación empresarial. Específicamente, este ejemplo utiliza uno 
            de los componentes principales de Utilidades de Concurrencia para Java EE, un Servicio de Ejecutor 
            Administrado.
          </p>
        </div>
        <div class="paragraph">
          <p>
            El ejemplo muestra un escenario en el que se utiliza un servicio web RESTful, expuesto como una 
            IPA pública, para enviar trabajos genéricos para su ejecución. Estos trabajos se procesan en 
            segundo plano. Cada trabajo imprime un mensaje de "Iniciando" y "Terminado" al principio y al 
            final de la ejecución. Además, para simular el procesamiento en segundo plano, cada trabajo tarda 
            10 segundos en ejecutarse.
          </p>
        </div>
        <div class="paragraph">
          <p>El servicio RESTful expone dos métodos:</p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p>
                <code>/token</code>: expuesto como un método GET que registra y devuelve tokens API válidos
              </p>
            </li>
            <li>
              <p>
                <code>/process</code>: expuesto como un método POST que recibe un parámetro de consulta 
                <code>jobID</code>, que es el identificador del trabajo que se ejecutará, y un encabezado HTTP 
                personalizado denominado <code>X -REST-API-Key</code>, que se usará internamente para validar 
                solicitudes con tokens
              </p>
            </li>
          </ul>
        </div>
        <div class="paragraph">
          <p>
            El token se utiliza para diferenciar la Calidad de Servicio (QoS) que ofrece la IPA. Los usuarios 
            que proporcionan un token en una solicitud de servicio pueden procesar varios trabajos 
            simultáneos. Sin embargo, los usuarios que no proporcionen un token solo pueden procesar un 
            trabajo a la vez. Dado que cada trabajo tarda 10 segundos en ejecutarse, los usuarios que no 
            proporcionen token podrán ejecutar solo una llamada al servicio cada 10 segundos. Para los 
            usuarios que proporcionen un token, el procesamiento será mucho más rápido.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Esta diferenciación es posible gracias al uso de dos Managed Executor Services diferentes, uno 
            para cada tipo de solicitud.
          </p>
        </div>
        <div class="sect2" id="sthref294">
          <h3 id="running-the-jobs-example">Ejecutando el Ejemplo jobs</h3>
          <div class="paragraph">
            <p>
              Después de configurar el servidor GlassFish agregando dos Managed Executor Services, puede usar 
              el EID de NetBeans o Maven para compilar, empaquetar, implementar y ejecutar el ejemplo de 
              <code>jobs</code>.
            </p>
          </div>
          <div class="paragraph">
            <p>Aquí se tratan los siguientes temas:</p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>
                  <a href="#CHDCIBBD">
                    Cómo Configurar el Servidor GlassFish para el Ejemplo de Simultaneidad Básica
                  </a>
                </p>
              </li>
              <li>
                <p>
                  <a href="#CHDFBAHJ">
                    Para Compilar, Empaquetar e Implementar el Ejemplo jobs con el EID NetBeans
                  </a>
                </p>
              </li>
              <li>
                <p>
                  <a href="#CHDECFFF">Para Construir, Empaquetar, y Desplegar el Ejemplo jobs Usando Maven</a>
                </p>
              </li>
              <li>
                <p>
                  <a href="#CHDFHHAF">Para Ejecutar el Ejemplo jobs y Enviar Trabajos con Prioridad Baja</a>
                </p>
              </li>
              <li>
                <p>
                  <a href="#CHDHEABJ">Para Ejecutar el Ejemplo jobs y Enviar Trabajos con Prioridad Alta </a>
                </p>
              </li>
            </ul>
          </div>
          <div class="sect3" id="CHDCIBBD">
            <h4 id="to-configure-glassfish-server-for-the-basic-concurrency-example">
              Cómo Configurar el Servidor GlassFish para el Ejemplo de Simultaneidad Básica
            </h4>
            <div class="paragraph">
              <p>Para configurar el servidor GlassFish, siga estos pasos.</p>
            </div>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Abra la consola de administración en 
                    <code><a href="http://localhost:4848" class="bare">http://localhost:4848</a></code>.
                  </p>
                </li>
                <li>
                  <p>Expanda el nodo Recursos.</p>
                </li>
                <li>
                  <p>Expanda el nodo Recursos Concurrentes.</p>
                </li>
                <li>
                  <p>Haga clic en Servicios de Ejecución Administrados.</p>
                </li>
                <li>
                  <p>
                    En la página Servicios de Ejecución Administrados, haga clic en Nuevo para abrir la página 
                    Nuevos Servicios de Ejecución Administrados.
                  </p>
                </li>
                <li>
                  <p>
                    En el campo Nombre JNDI, ingrese <code>MES_High</code> para crear el Servicio de Ejecución 
                    Administrado de alta prioridad. Use la siguiente configuración (mantenga los valores 
                    predeterminados para otras configuraciones):
                  </p>
                  <div class="ulist">
                    <ul>
                      <li><p>Prioridad de Hilo: 10</p></li>
                      <li><p>Tamaño del Núcleo: 2</p></li>
                      <li><p>Tamaño Máximo del Grupo: 5</p></li>
                      <li><p>Capacidad de la Cola de Tareas: 2</p></li>
                    </ul>
                  </div>
                </li>
                <li><p>Haga clic en Aceptar.</p></li>
                <li>
                  <p>En la página de Servicios de Ejecución Administrados, haga clic en Nuevo nuevamente.</p>
                </li>
                <li>
                  <p>
                    En el campo Nombre JNDI, ingrese <code>MES_Low</code> para crear el Servicio de Ejecución 
                    Administrado de prioridad baja. Use la siguiente configuración (mantenga los valores 
                    predeterminados para otras configuraciones):
                  </p>
                  <div class="ulist">
                    <ul>
                      <li><p>Prioridad de Hilo: 1</p></li>
                      <li><p>Tamaño del Núcleo: 1</p></li>
                      <li><p>Tamaño Máximo del Grupo: 1</p></li>
                      <li><p>Capacidad de la Cola de Tareas: 0</p></li>
                    </ul>
                  </div>
                </li>
                <li><p>Haga clic en Aceptar.</p></li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDFBAHJ">
            <h4 id="to-build-package-and-deploy-the-jobs-example-using-netbeans-ide">
              Para Compilar, Empaquetar e Implementar el Ejemplo jobs con el EID NetBeans
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En el menú Archivo, elija Abrir proyecto.</p>
                </li>
                <li>
                  <p>En el cuadro de diálogo Abrir proyecto, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/concurrency
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Seleccione la carpeta <code>jobs</code>.</p>
                </li>
                <li>
                  <p>Haga clic en Abrir proyecto.</p>
                </li>
                <li>
                  <p>
                    En la pestaña Proyectos, haga clic con el botón derecho en el proyecto <code>jobs</code> y 
                    seleccione Cosntruir.
                  </p>
                  <div class="paragraph">
                    <p>Este comando compila e implementa la aplicación.</p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDECFFF">
            <h4 id="to-build-package-and-deploy-the-jobs-example-using-maven">
              Para Construir, Empaquetar, y Desplegar el Ejemplo jobs Usando Maven
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte  
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En una ventana de terminal, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/concurrency/jobs
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Ingrese el siguiente comando para compilar e implementar la aplicación:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
mvn install
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDFHHAF">
            <h4 id="to-run-the-jobs-example-and-submit-jobs-with-low-priority">
              Para Ejecutar el Ejemplo jobs y Enviar Trabajos con Prioridad Baja
            </h4>
            <div class="paragraph">
              <p>
                Para ejecutar el ejemplo como un usuario que envía trabajos con baja prioridad, siga estos 
                pasos:
              </p>
            </div>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>En un navegador web, ingrese la siguiente URL:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/jobs
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    En la página de Jobs Client, ingrese el valor 1 en el campo Enter a JobID, no ingrese nada 
                    en el campo Enter a Token, luego haga clic en Submit Job.
                  </p>
                  <div class="paragraph">
                    <p>Debe mostrarse el siguiente mensaje en la parte inferior de la página:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Job 1 successfully submitted
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>El registro del servidor incluye los siguientes mensajes:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
INFO:   Invalid or missing token!
INFO:   Task started LOW-1
INFO:   Job 1 successfully submitted
INFO:   Task finished LOW-1
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Envió un trabajo con baja prioridad. Esto significa que no puede enviar otro trabajo 
                      durante 10 segundos. Si intenta hacerlo, la IPA RESTful devolverá una respuesta de 
                      servicio no disponible (HTTP 503) y se mostrará el siguiente mensaje en la parte 
                      inferior de la página:
                    </p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Job 2 was NOT submitted
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>El registro del servidor incluirá los siguientes mensajes:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
INFO:   Invalid or missing token!
INFO:   Job 1 successfully submitted
INFO:   Task started LOW-1
INFO:   Invalid or missing token!
INFO:   Job 2 was NOT submitted
INFO:   Task finished LOW-1
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDHEABJ">
            <h4 id="to-run-the-jobs-example-and-submit-jobs-with-high-priority">
              Para Ejecutar el Ejemplo jobs y Enviar Trabajos con Prioridad Alta 
            </h4>
            <div class="paragraph">
              <p>
                Para ejecutar el ejemplo como un usuario que envía trabajos con alta prioridad, siga estos 
                pasos:
              </p>
            </div>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>En un navegador web, ingrese la siguiente URL:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/jobs
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    En la página Jobs Client, ingrese un valor de uno a diez dígitos en el campo Enter a 
                    JobID.
                  </p>
                </li>
                <li>
                  <p>
                    Haga clic en el enlace aquí en la línea "Get a token here" para obtener un token. La 
                    página que muestra el token se abrirá en una nueva pestaña.
                  </p>
                </li>
                <li>
                  <p>Copie el token y regrese a la página de Jobs Client.</p>
                </li>
                <li>
                  <p>Pegue el token en el campo Enter a Token, luego haga clic en Submit Job.</p>
                  <div class="paragraph">
                    <p>Se debe mostrar un mensaje como el siguiente en la parte inferior de la página:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Job 11 successfully submitted
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>El registro del servidor incluye los siguientes mensajes:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
INFO:   Token accepted. Execution with high priority.
INFO:   Task started HIGH-11
INFO:   Job 11 successfully submitted
INFO:   Task finished HIGH-11
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Envió un trabajo con alta prioridad. Esto significa que puede enviar varios trabajos, 
                      cada uno con un token, y no enfrentar la restricción de 10 segundos por trabajo que 
                      enfrentan los remitentes de baja prioridad. Si envía 3 trabajos con tokens en rápida 
                      sucesión, se mostrarán mensajes como el siguiente en la parte inferior de la página:
                    </p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
Job 1 was submitted
Job 2 was submitted
Job 3 was submitted
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>El registro del servidor incluirá los siguientes mensajes:</p>
                  </div>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
INFO:   Token accepted. Execution with high priority.
INFO:   Task started HIGH-1
INFO:   Job 1 successfully submitted
INFO:   Token accepted. Execution with high priority.
INFO:   Task started HIGH-2
INFO:   Job 2 successfully submitted
INFO:   Task finished HIGH-1
INFO:   Token accepted. Execution with high priority.
INFO:   Task started HIGH-3
INFO:   Job 3 successfully submitted
INFO:   Task finished HIGH-2
INFO:   Task finished HIGH-3
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="concurrency-utilities004.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="concurrency-utilities006.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
