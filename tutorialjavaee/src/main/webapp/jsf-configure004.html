<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>Usando los Flujos de Faces</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="jsf-configure003.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jsf-configure005.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="CHDGFCJF">
      <h2 id="using-faces-flows">Usando los Flujos de Faces</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            La función Flujos de Faces de la tecnología JavaServer Faces le permite crear un conjunto de 
            páginas con un alcance, <code>FlowScoped</code>, que es mayor que el alcance de la solicitud pero 
            menor que el alcance de la sesión. Por ejemplo, es posible que desee crear una serie de páginas 
            para el proceso de pago en una tienda en línea. Puede crear un conjunto de páginas independientes 
            que se puedan transferir de una tienda a otra según sea necesario.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Los flujos de caras son algo análogos a las subrutinas en la programación procedural, de las 
            siguientes maneras.
          </p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p>
                Como una subrutina, un flujo tiene un punto de entrada, una lista de parámetros y un valor de 
                retorno bien definidos. Sin embargo, a diferencia de una subrutina, un flujo puede devolver 
                varios valores.
              </p>
            </li>
            <li>
              <p>
                Como una subrutina, un flujo tiene un alcance, lo que permite que la información esté 
                disponible solo durante la invocación del flujo. Dicha información no está disponible fuera 
                del alcance del flujo y no consume ningún recurso una vez que regresa el flujo.
              </p>
            </li>
            <li>
              <p>
                Como una subrutina, un flujo puede llamar a otros flujos antes de regresar. La invocación de 
                flujos se mantiene en una pila de llamadas: un nuevo flujo provoca una nueva entrada en la 
                pila y un retorno provoca la salida de la entrada de la pila.
              </p>
            </li>
          </ul>
        </div>
        <div class="paragraph">
          <p>
            Una aplicación puede tener cualquier número de flujos. Cada flujo incluye un conjunto de páginas 
            y, por lo general, uno o más beans gestionados dentro del ámbito de ese flujo. Cada flujo tiene un 
            punto de partida, llamado nodo de inicio, y un punto de salida, llamado nodo de retorno.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Los datos de un flujo tienen como alcance ese flujo solo, pero se pueden pasar datos de un flujo a 
            otro especificando parámetros y llamando al otro flujo.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Los flujos se pueden anidar, de modo que si llama a un flujo desde otro y luego sale del segundo 
            flujo, regresa al flujo de llamada en lugar del nodo de retorno del segundo flujo.
          </p>
        </div>
        <div class="paragraph">
          <p>
            Puede configurar un flujo mediante programación, creando una clase anotada 
            <code>@FlowDefinition</code>, o puede configurar un flujo mediante un archivo de configuración. El 
            archivo de configuración puede limitarse a un flujo, o puede usar el archivo 
            <code>faces-config.xml</code> para poner todos los flujos en un solo lugar, si tiene muchos flujos 
            en una aplicación. La configuración programática coloca el código más cerca del resto del código 
            de flujo y le permite modularizar los flujos.
          </p>
        </div>
        <div class="paragraph">
          <p>La <a href="#CHDIHDCD">figure 16-1</a> muestra dos flujos e ilustra cómo interactúan.</p>
        </div>
        <div id="CHDIHDCD" class="paragraph">
          <div class="title">
            <strong>Figura 16-1 Dos Faces Flows  y sus interacciones</strong>
          </div>
          <p>
            <span class="image">
              <img src="img/javaeett_dt_017.png" 
                   alt="Esta figura muestra dos flujos Faces, Flujo A y Flujo B. Cada uno tiene un nodo de 
                   inicio y dos páginas adicionales. Cada uno tiene un bean gestionado asociado. Cada uno 
                   define un nodo de retorno y cada uno define dos parámetros que se pasarán al otro flujo.">
            </span>
          </p>
        </div>
        <div class="paragraph">
          <p>
            En esta figura, el Flujo A tiene un nodo de inicio llamado <code>flow-a</code> y dos páginas 
            adicionales, <code>next_a1</code> y <code>next_a2</code>. Desde <code>next_a2</code>, un usuario 
            puede salir del flujo usando el nodo de retorno definido, <code>taskFlowReturn1</code>, o llamar 
            al Flujo B, pasando dos parámetros. El Flujo A también define dos parámetros de entrada que puede 
            aceptar del Flujo B. El Dlujo B es idéntico al Flujo A, excepto por los nombres del flujo y los 
            archivos. Cada flujo también tiene un bean gestionado asociado; los beans son 
            <code>Flow_a_Bean</code> y <code>Flow_b_Bean</code>.
          </p>
        </div>
        <div class="sect2" id="sthref81">
          <h3 id="packaging-flows-in-an-application">Empaquetando Flujos en una Aplicación</h3>
          <div class="paragraph">
            <p>
              Por lo general, empaqueta los flujos en una aplicación web utilizando una estructura de 
              directorio que modulariza los flujos. En el directorio <code>src/main/webapp</code> de un 
              proyecto Maven, por ejemplo, colocaría los archivos Facelets que están fuera del flujo en el 
              nivel superior como de costumbre. Entonces los archivos <code>webapp</code> para cada flujo 
              estarían en un directorio separado, y los archivos Java estarían bajo 
              <code>src/main/java</code>. Por ejemplo, los archivos de la aplicación que se muestran en la 
              <a href="#CHDIHDCD">figura 16-1</a> podrían verse así:
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
src/main/webapp/
    index.xhtml
    return.xhtml
    WEB_INF/
        beans.xml
        web.xml
    flow-a/
        flow-a.xhtml
        next_a1.xhtml
        next_a2.xhtml
    flow-b/
        flow-b-flow.xml
        next_b1.xhtml
        next_b2.xhtml
src/main/java/javaeetutorial/flowexample
            FlowA.java
            Flow_a_Bean.java
            Flow_b_Bean.java
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              En este ejemplo, <code>flow-a</code> se define mediante programación en <code>FlowA.java</code>, 
              mientras que <code>flow-b</code> se define mediante el archivo de configuración 
              <code>flow -b-flow.xml</code>.
            </p>
          </div>
        </div>
        <div class="sect2" id="sthref82">
          <h3 id="the-simplest-possible-flow-the-simple-flow-example-application">
            El Flujo Más Simple Posible: La Aplicación de Ejemplo simple-flow
          </h3>
          <div class="paragraph">
            <p>
              La aplicación de ejemplo <code>simple-flow</code> demuestra los bloques de construcción más 
              básicos de una aplicación  de Flujos de Faces e ilustra algunas de las convenciones que 
              facilitan la iniciación al desarrollo iterativo utilizando flujos. Es posible que desee comenzar 
              con un ejemplo simple como este y desarrollarlo.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Este ejemplo proporciona una definición de flujo implícita al incluir un archivo de 
              configuración vacío. Un archivo de configuración que tiene contenido, o una clase anotada 
              <code>@FlowDefinition</code>, proporciona una definición de flujo explícita.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El código fuente de esta aplicación se encuentra en el directorio 
              tut-install`/examples/web/jsf/simple-flow/`.
            </p>
          </div>
          <div class="paragraph">
            <p>El diseño de archivo del ejemplo de <code>simple-flow</code> se ve así:</p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
src/main/webapp
    index.xhtml
    simple-flow-return.xhtml
    WEB_INF/
        web.xml
    simple-flow
        simple-flow-flow.xml
        simple-flow.xhtml
        simple-flow-page2.xhtml
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              El ejemplo de <code>simple-flow</code> tiene un archivo de configuración vacío, que por 
              convención se llama nombre-flujo-<code>flow.xml</code>. El flujo no requiere ninguna 
              configuración por las siguientes razones.
            </p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>El flujo no llama a otro flujo ni pasa parámetros a otro flujo.</p>
              </li>
              <li>
                <p>
                  El flujo usa nombres predeterminados para la primera página del flujo, `nombre-flujo.xhtml`, 
                  y la página de retorno, `nombre-flujo-return.xhtml`.
                </p>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>Este ejemplo tiene solo cuatro páginas de Facelets.</p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>
                  <code>index.xhtml</code>, la página de inicio, que no contiene casi nada más que un botón 
                  que navega a la primera página del flujo:
                </p>
                <div class="listingblock">
                  <div class="content">
                    <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;&lt;h:commandButton value="Enter Flow" action="simple-flow"/&gt;&lt;/p&gt;
                    </code></pre>
                  </div>
                </div>
              </li>
              <li>
                <p>
                  <code>simple-flow.xhtml</code> y <code>simple-flow-page2.xhtml</code>, las dos páginas del 
                  propio flujo. En ausencia de una definición de flujo explícita, se supone que la página cuyo 
                  nombre es el mismo que el nombre del flujo es el nodo de inicio del flujo. En este caso, el 
                  flujo se denomina <code>simple-flow</code>, por lo que se supone que la página denominada 
                  <code>simple-flow.xhtml</code> es el nodo de inicio del flujo. El nodo de inicio es el nodo 
                  al que se navega al entrar en el flujo. Se puede considerar como la página de inicio del 
                  flujo.
                </p>
                <div class="paragraph">
                  <p>
                    La página <code>simple-flow.xhtml</code> le pide que ingrese un valor de ámbito de flujo y 
                    proporciona un botón que navega a la siguiente página del flujo:
                  </p>
                </div>
                <div class="listingblock">
                  <div class="content">
                    <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;Value: &lt;h:inputText id="input" value="#{flowScope.value}" /&gt;&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Siguiente" action="simple-flow-page2" /&gt;&lt;/p&gt;
                    </code></pre>
                  </div>
                </div>
                <div class="paragraph">
                  <p>
                    La segunda página, que puede tener cualquier nombre, muestra el valor de ámbito de flujo y 
                    proporciona un botón que navega a la página de retorno:
                  </p>
                </div>
                <div class="listingblock">
                  <div class="content">
                    <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;Value: #{flowScope.value}&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Return" action="simple-flow-return" /&gt;&lt;/p&gt;
                    </code></pre>
                  </div>
                </div>
              </li>
              <li>
                <p>
                  <code>simple-flow-return.xhtml</code>, la página de retorno. La página de retorno, que por 
                  convención se denomina `flow-name-return.xhtml`, debe ubicarse fuera del flujo. Esta página 
                  muestra el valor de ámbito de flujo para mostrar que no tiene ningún valor fuera del flujo y 
                  proporciona un vínculo que navega a la página <code>index.xhtml</code>:
                </p>
                <div class="listingblock">
                  <div class="content">
                    <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;Value (should be empty):
    "&lt;h:outputText id="output" value="#{flowScope.value}" /&gt;"&lt;/p&gt;
&lt;p&gt;&lt;h:link outcome="index" value="Back to Start" /&gt;&lt;/p&gt;
                    </code></pre>
                  </div>
                </div>
              </li>
            </ul>
          </div>
          <div class="paragraph">
            <p>
              Las páginas de Facelets usan solo datos de ámbito de flujo, por lo que el ejemplo no necesita un 
              bean gestionado.
            </p>
          </div>
          <div class="sect3" id="sthref83">
            <h4 id="to-build-package-and-deploy-the-simple-flow-example-using-netbeans-ide">
              Para Construir, Empaquetar, y Desplegar el Ejemplo simple-flow Usando el EID NetBeans
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En el menú Archivo, elija Abrir Proyecto.</p>
                </li>
                <li>
                  <p>En el cuadro de diálogo Abrir Proyecto, navegue hasta:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/web/jsf
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Seleccione la carpeta <code>simple-flow</code>.</p>
                </li>
                <li>
                  <p>Haga clic en Abrir Proyecto.</p>
                </li>
                <li>
                  <p>
                    En la pestaña Proyectos, haga clic con el botón derecho en el proyecto 
                    <code>simple-flow</code> y seleccione Construir.
                  </p>
                  <div class="paragraph">
                    <p>
                      Este comando compila y empaqueta la aplicación en un archivo WAR, 
                      <code>simple-flow.war</code>, que se encuentra en el directorio <code>target</code>. 
                      Luego, implementa la aplicación en el servidor.
                    </p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="sthref84">
            <h4 id="to-build-package-and-deploy-the-simple-flow-example-using-maven">
              Para Construir, Empaquetar, y Desplegar el Ejemplo simple-flow Usando Maven
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En una ventana de terminal, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/web/jsf/simple-flow/
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Ingrese el siguiente comando:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
mvn install
                      </code></pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Este comando compila y empaqueta la aplicación en un archivo WAR, 
                      <code>simple-flow.war</code>, que se encuentra en el directorio <code>target</code>. 
                      Luego, implementa la aplicación en el servidor.
                    </p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="sthref85">
            <h4 id="to-run-the-simple-flow-example">Para Ejecutar el Ejemplo simple-flow</h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>Ingrese la siguiente URL en su navegador web:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/simple-flow
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>En la página <code> index.xhtml </code>, haga clic en Enter Flow.</p>
                </li>
                <li>
                  <p>
                    En la primera página del flujo, ingrese cualquier cadena en el campo Value, luego haga 
                    clic en Next.
                  </p>
                </li>
                <li>
                  <p>
                    En la segunda página del flujo, puede ver el valor que ingresó. Haga clic en Return.
                  </p>
                </li>
                <li>
                  <p>
                    En la página de retorno, un par de comillas vacías encierra el valor inaccesible. Haga 
                    clic en Back to Start para volver a la página <code>index.xhtml</code>.
                  </p>
                </li>
              </ol>
            </div>
          </div>
        </div>
        <div class="sect2" id="sthref86">
          <h3 id="the-checkout-module-example-application">La Aplicación de Ejemplo checkout-module</h3>
          <div class="paragraph">
            <p>
              La aplicación de ejemplo <code>checkout-module</code> es considerablemente más compleja que 
              <code>simple-flow</code>. Muestra cómo puede usar la función Flujos de Faces para implementar un 
              módulo de pago para una tienda en línea.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Como el ejemplo hipotético en la <a href="#CHDIHDCD">figura 16-1</a>, la aplicación de ejemplo 
              contiene dos flujos, cada uno de los cuales puede llamar al otro. Ambos flujos tienen 
              definiciones de flujo explícitas. Un flujo, <code>checkoutFlow</code>, se especifica mediante 
              programación. El otro flujo, <code>joinFlow</code>, se especifica en un archivo de 
              configuración.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El código fuente de esta aplicación se encuentra en el directorio 
              tut-install`/examples/web/jsf/checkout-module/`.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Para la aplicación <code>checkout-module</code>, la estructura del directorio es la siguiente 
              (también hay un directorio <code>src/main/webapp/resources</code> con una hoja de estilo y una 
              imagen):
            </p>
          </div>
          <div class="listingblock">
            <div class="content">
              <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
src/main/webapp/
    index.xhtml
    exithome.xhtml
    WEB_INF/
        beans.xml
        web.xml
    checkoutFlow/
        checkoutFlow.xhtml
        checkoutFlow2.xhtml
        checkoutFlow3.xhtml
        checkoutFlow4.xhtml
    joinFlow/
        joinFlow-flow.xml
        joinFlow.xhtml
        joinFlow2.xhtml
src/main/java/javaeetutorial/checkoutmodule
            CheckoutBean.java
            CheckoutFlow.java
            CheckoutFlowBean.java
            JoinFlowBean.java
              </code></pre>
            </div>
          </div>
          <div class="paragraph">
            <p>
              Para el ejemplo, <code>index.xhtml</code> es la página de inicio de la aplicación, así como el 
              nodo de retorno para el flujo de pago. La página <code>exithome.xhtml</code> es el nodo de 
              retorno del flujo joinFlow.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El archivo de configuración <code>joinFlow-flow.xml</code> define el flujo joinFlow y el archivo 
              fuente <code>CheckoutFlow.java</code> define el flujo checkoutFlow.
            </p>
          </div>
          <div class="paragraph">
            <p>
              El flujo checkoutFlow contiene cuatro páginas de Facelets, mientras que el flujo joinFlow 
              contiene dos.
            </p>
          </div>
          <div class="paragraph">
            <p>
              Los beans gestionados dentro del alcance de cada flujo son <code>CheckoutFlowBean.java</code> y 
              <code>JoinFlowBean.java</code>, mientras que <code>CheckoutBean.java</code> es el bean de 
              respaldo para la  página <code>index.html</code>.
            </p>
          </div>
          <div class="sect3" id="sthref87">
            <h4 id="the-facelets-pages-for-the-checkout-module-example">
              Las Páginas Facelets para el Ejemplo checkout-module
            </h4>
            <div class="paragraph">
              <p>
                La página de inicio del ejemplo, <code>index.xhtml</code>, resume el contenido de un carrito 
                de la compra hipotético. Permite al usuario hacer clic en cualquiera de los dos botones para 
                ingresar a uno de los dos flujos:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;&lt;h:commandButton value="Check Out" action="checkoutFlow"/&gt;&lt;/p&gt;
...
&lt;p&gt;&lt;h:commandButton value="Join" action="joinFlow"/&gt;&lt;/p&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>Esta página también es el nodo de retorno para el flujo checkoutFlow.</p>
            </div>
            <div class="paragraph">
              <p>
                La página de Facelets <code>exithome.xhtml</code> es el nodo de retorno para el flujo 
                joinFlow. Esta página tiene un botón que le permite volver a la página 
                <code>index.xhtml</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Las cuatro páginas de Facelets dentro del flujo checkoutFlow, que comienzan con 
                <code>checkoutFlow.xhtml</code> y terminan con <code>checkoutFlow4.xhtml</code>, le permiten 
                pasar a la página siguiente o, en algunos casos, a salirse del flujo. La página 
                <code>checkoutFlow.xhtml</code> le permite acceder a los parámetros pasados desde el flujo 
                joinFlow a través del alcance del flujo. Estos aparecen como comillas vacías si no ha llamado 
                al flujo checkoutFlow desde el flujo joinFlow.
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;If you called this flow from the Join flow, you can see these parameters:
    "&lt;h:outputText value="#{flowScope.param1Value}"/&gt;" and
    "&lt;h:outputText value="#{flowScope.param2Value}"/&gt;"
&lt;/p&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                Solo <code>checkoutFlow2.xhtml</code> tiene un botón para volver a la página anterior, pero 
                generalmente se permite moverse entre páginas dentro de los flujos. Estos son los botones para 
                `checkoutFlow2.xhtml`:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;&lt;h:commandButton value="Continue" action="checkoutFlow3"/&gt;&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Go Back" action="checkoutFlow"/&gt;&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Exit Flow" action="returnFromCheckoutFlow"/&gt;&lt;/p&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                La acción <code>returnFromCheckoutFlow</code> se define en el archivo de código fuente de 
                configuración, <code>CheckoutFlow.java</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                La página final del flujo checkoutFlow, <code>checkoutFlow4.xhtml</code>, contiene un botón 
                que llama al flujo joinFlow:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;&lt;h:commandButton value="Join" action="calljoin"/&gt;&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Exit Flow" action="returnFromCheckoutFlow"/&gt;&lt;/p&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                La acción <code>calljoin</code> también se define en el archivo de código fuente de 
                configuración, <code>CheckoutFlow.java</code>. Esta acción ingresa al flujo joinFlow, pasando 
                dos parámetros del flujo checkoutFlow.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Las dos páginas del flujo joinFlow, <code>joinFlow.xhtml</code> y 
                <code>joinFlow2.xhtml</code>, son similares a las del flujo checkoutFlow. La segunda página 
                tiene un botón para llamar al checkoutFlow y otro para regresar del flujo joinFlow:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;p&gt;&lt;h:commandButton value="Check Out" action="callcheckoutFlow"/&gt;&lt;/p&gt;
&lt;p&gt;&lt;h:commandButton value="Exit Flow" action="returnFromJoinFlow"/&gt;&lt;/p&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                Para este flujo, las acciones <code>callcheckoutFlow</code> y <code>returnFromJoinFlow</code> 
                se definen en el archivo de configuración <code>joinFlow-flow.xml</code>.
              </p>
            </div>
          </div>
          <div class="sect3" id="sthref88">
            <h4 id="using-a-configuration-file-to-configure-a-flow">
              Usando un Archivo de Configuración para Configurar un Flujo
            </h4>
            <div class="paragraph">
              <p>
                Si usa un archivo de recursos de configuración de la aplicación para configurar un flujo, debe 
                llamarse `flowName-flow.xml`. En este ejemplo, el flujo joinFlow usa un archivo de 
                configuración llamado <code>joinFlow-flow.xml</code>. El archivo es un archivo 
                <code>faces-config</code> que especifica un elemento <code>flow-definition</code>. Este 
                elemento debe definir el nombre del flujo usando el atributo <code>id</code>. Bajo el elemento 
                <code>flow-definition</code>, debe haber un elemento <code>flow-return</code> que especifique 
                el punto de retorno del flujo. Cualquier parámetro de entrada se especifica con elementos 
                <code>inbound-parameter</code>. Si el flujo llama a otro flujo, el elemento 
                <code>call-flow</code> debe usar el elemento de referencia de flujo para nombrar el flujo 
                llamado y puede usar el elemento <code>outbound-parameter</code> para especificar cualquier 
                parámetro.
              </p>
            </div>
            <div class="paragraph">
              <p>El archivo de configuración para el flujo joinFlow tiene este aspecto:</p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
&lt;faces-config version="2.2" xmlns="http://xmlns.jcp.org/xml/ns/javaee"
              xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
              xsi:schemaLocation="http://xmlns.jcp.org/xml/ns/javaee \
              http://xmlns.jcp.org/xml/ns/javaee/web-facesconfig_2_2.xsd"&gt;
    &lt;flow-definition id="joinFlow"&gt;
        &lt;flow-return id="returnFromJoinFlow"&gt;
            &lt;from-outcome&gt;#{joinFlowBean.returnValue}&lt;/from-outcome&gt;
        &lt;/flow-return&gt;
        &lt;inbound-parameter&gt;
            &lt;name&gt;param1FromCheckoutFlow&lt;/name&gt;
            &lt;value&gt;#{flowScope.param1Value}&lt;/value&gt;
        &lt;/inbound-parameter&gt;
        &lt;inbound-parameter&gt;
            &lt;name&gt;param2FromCheckoutFlow&lt;/name&gt;
            &lt;value&gt;#{flowScope.param2Value}&lt;/value&gt;
        &lt;/inbound-parameter&gt;
        &lt;flow-call id="callcheckoutFlow"&gt;
            &lt;flow-reference&gt;
                &lt;flow-id&gt;checkoutFlow&lt;/flow-id&gt;
            &lt;/flow-reference&gt;
            &lt;outbound-parameter&gt;
                &lt;name&gt;param1FromJoinFlow&lt;/name&gt;
                &lt;value&gt;param1 joinFlow value&lt;/value&gt;
            &lt;/outbound-parameter&gt;
            &lt;outbound-parameter&gt;
                &lt;name&gt;param2FromJoinFlow&lt;/name&gt;
                &lt;value&gt;param2 joinFlow value&lt;/value&gt;
            &lt;/outbound-parameter&gt;
        &lt;/flow-call&gt;
    &lt;/flow-definition&gt;
&lt;/faces-config&gt;
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                El atributo <code>id</code> del elemento <code>flow-definition</code> define el nombre del 
                flujo como <code>joinFlow</code>. El valor del atributo <code>id</code> del elemento 
                <code>flow-return</code> identifica el nombre del nodo de retorno, y su valor se define en el 
                elemento <code>from-result</code> como la propiedad <code>returnValue</code> del bean 
                gestionado de ámbito de flujo para el flujo joinFlow, <code>JoinFlowBean</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Los nombres y valores de los parámetros entrantes se recuperan del alcance del flujo en orden 
                (<code>flowScope.param1Value</code>, <code>flowScope.param2Value</code>), según la forma en 
                que se definieron en la configuración  del flujo checkoutFlow.
              </p>
            </div>
            <div class="paragraph">
              <p>
                El elemento <code>flow-call</code> define cómo el flujo joinFlow llama al flujo checkoutFlow. 
                El atributo <code>id</code> del elemento, <code>callcheckoutFlow</code>, define la acción de 
                llamar al flujo. Dentro del elemento <code>flow-call</code>, el elemento 
                <code>flow-reference</code> define el nombre real del flujo a llamar, 
                <code>checkoutFlow</code>. Los elementos <code>outbound-parameter</code> definen los 
                parámetros que se pasarán cuando se llame a <code>checkoutFlow</code>. Aquí son solo cadenas 
                arbitrarias.
              </p>
            </div>
          </div>
          <div class="sect3" id="sthref89">
            <h4 id="using-a-java-class-to-configure-a-flow">
              Usando una Clase Java para Configurar un Flujo
            </h4>
            <div class="paragraph">
              <p>
                Si utiliza una clase Java para configurar un flujo, debe tener el nombre del flujo. La clase 
                para el flujo checkoutFlow se llama <code>CheckoutFlow.java</code>.
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
import java.io.Serializable;
import javax.enterprise.inject.Produces;
import javax.faces.flow.Flow;
import javax.faces.flow.builder.FlowBuilder;
import javax.faces.flow.builder.FlowBuilderParameter;
import javax.faces.flow.builder.FlowDefinition;
class CheckoutFlow implements Serializable {
    private static final long serialVersionUID = 1L;
    @Produces
    @FlowDefinition
    public Flow defineFlow(@FlowBuilderParameter FlowBuilder flowBuilder) {
        String flowId = "checkoutFlow";
        flowBuilder.id("", flowId);
        flowBuilder.viewNode(flowId,
                "/" + flowId + "/" + flowId + ".xhtml").
                markAsStartNode();
        flowBuilder.returnNode("returnFromCheckoutFlow").
                fromOutcome("#{checkoutFlowBean.returnValue}");
        flowBuilder.inboundParameter("param1FromJoinFlow",
                "#{flowScope.param1Value}");
        flowBuilder.inboundParameter("param2FromJoinFlow",
                "#{flowScope.param2Value}");
        flowBuilder.flowCallNode("calljoin").flowReference("", "joinFlow").
                outboundParameter("param1FromCheckoutFlow",
                    "#{checkoutFlowBean.name}").
                outboundParameter("param2FromCheckoutFlow",
                    "#{checkoutFlowBean.city}");
        return flowBuilder.getFlow();
    }
}
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                La clase realiza acciones que son casi idénticas a las realizadas por el archivo de 
                configuración <code>joinFlow-flow.xml</code>. Contiene un método único, 
                <code>defineFlow</code>, como método productor con el calificador <code>@FlowDefinition</code> 
                que devuelve una clase <code>javax.faces.flow.Flow</code>. El método <code>defineFlow</code> 
                toma un parámetro, un <code>FlowBuilder</code> con el calificador 
                <code>@FlowBuilderParameter</code>, que se pasa desde la implementación de JavaServer Faces. 
                Luego, el método llama a métodos de la clase <code>javax.faces.flow.Builder.FlowBuilder</code> 
                para configurar el flujo.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Primero, el método define el <code>id</code> del flujo como <code>checkoutFlow</code>. Luego, 
                define explícitamente el nodo de inicio del flujo. De forma predeterminada, este es el nombre 
                del flujo con un sufijo <code>.xhtml</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Luego, el método define el nodo de retorno de manera similar a como lo hace el archivo de 
                configuración. El método <code>returnNode</code> establece el nombre del nodo de retorno como 
                <code>returnFromCheckoutFlow</code>, y el método encadenado <code>fromOutcome</code> 
                especifica su valor como la propiedad <code>returnValue</code> del bean gestionado de ámbito 
                de flujo para el flujo checkoutFlow, <code>CheckoutFlowBean</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                El método <code>inboundParameter</code> establece los nombres y valores de los parámetros de 
                entrada del flujo joinFlow, que se recuperan del alcance del flujo en orden 
                (<code>flowScope.param1Value</code>, <code>flowScope.param2Value</code>), según la forma en 
                que se definieron en la configuración del flujo joinFlow.
              </p>
            </div>
            <div class="paragraph">
              <p>
                El método <code>flowCallNode</code> define cómo el flujo checkoutFlow llama al flujo joinFlow. 
                El argumento, <code>calljoin</code>, especifica la acción de llamar al flujo. El método 
                encadenado <code>flowReference</code> define el nombre real del flujo a llamar, 
                <code>joinFlow</code>, luego llama a los métodos <code>outboundParameter</code> para definir 
                los parámetros que se pasarán cuando se llama a <code>joinFlow</code>. Aquí están los valores 
                del bean gestionado <code>CheckoutFlowBean</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Finalmente, el método <code>defineFlow</code> llama al método <code>getFlow</code> y devuelve 
                el resultado.
              </p>
            </div>
          </div>
          <div class="sect3" id="sthref90">
            <h4 id="the-flow-scoped-managed-beans">Los Beans Gestionados en el Ámbito del Flujo</h4>
            <div class="paragraph">
              <p>
                Cada uno de los dos flujos tiene un bean gestionado que define las propiedades de las páginas 
                dentro del flujo. Por ejemplo, <code>CheckoutFlowBean</code> define propiedades cuyos valores 
                ingresa el usuario tanto en la página <code>checkoutFlow.xhtml</code> como en la página 
                <code>checkoutFlow3.xhtml</code>.
              </p>
            </div>
            <div class="paragraph">
              <p>
                Cada bean gestionado tiene un método <code>getReturnValue</code> que establece el valor del 
                nodo de retorno. Para <code>CheckoutFlowBean</code>, el nodo de retorno es la página 
                <code>index.xhtml</code>, especificada mediante navegación implícita:
              </p>
            </div>
            <div class="listingblock">
              <div class="content">
                <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
public String getReturnValue() {
    return "index";
}
                </code></pre>
              </div>
            </div>
            <div class="paragraph">
              <p>
                Para <code>JoinFlowBean</code>, el nodo de retorno es la página <code>exithome.xhtml</code>.
              </p>
            </div>
          </div>
          <div class="sect3" id="sthref91">
            <h4 id="to-build-package-and-deploy-the-checkout-module-example-using-netbeans-ide">
              Para Construir, Empaquetar, y Desplegar el Ejemplo checkout-module Usando el EID NetBeans
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En el menú Archivo, elija Abrir Proyecto.</p>
                </li>
                <li>
                  <p>En el cuadro de diálogo Abrir Proyecto, navegue hasta:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/web/jsf
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Seleccione la carpeta <code>checkout-module</code>.</p>
                </li>
                <li>
                  <p>Haga clic en Abrir proyecto.</p>
                </li>
                <li>
                  <p>
                    En la pestaña Proyectos, haga clic con el botón derecho en el proyecto 
                    <code>checkout-module</code> y seleccione Construir.
                  </p>
                  <div class="paragraph">
                    <p>
                      Este comando compila y empaqueta la aplicación en un archivo WAR, 
                      <code>checkout-module.war</code>, que se encuentra en el directorio <code>target</code>. 
                      Luego, implementa la aplicación en el servidor.
                    </p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="sthref92">
            <h4 id="to-build-package-and-deploy-the-checkout-module-example-using-maven">
              Para Construir, Empaquetar, y Desplegar el Ejemplo checkout-module Usando Maven
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En una ventana de terminal, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/web/jsf/checkout-module/
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Ingrese el siguiente comando:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
mvn install
                      </code></pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Este comando compila y empaqueta la aplicación en un archivo WAR, 
                      <code>checkout-module.war</code>, que se encuentra en el directorio <code>target</code>. 
                      Luego, implementa la aplicación en el servidor.
                    </p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="sthref93">
            <h4 id="to-run-the-checkout-module-example">Para Ejecutar el Ejemplo checkout-module</h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>Ingrese la siguiente URL en su navegador web:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight"><code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/checkout-module
                      </code></pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    La página <code>index.xhtml</code> presenta resultados hipotéticos de la expedición de 
                    compras. Haga clic en Check Out o Join para ingresar uno de los dos flujos.
                  </p>
                </li>
                <li>
                  <p>
                    Siga el flujo, proporcione información según sea necesario y elija si continuar, 
                    retroceder o salir del flujo.
                  </p>
                  <div class="paragraph">
                    <p>
                      En el flujo de pago (checkoutFlow), solo se valida uno de los campos de entrada (el 
                      campo de la tarjeta de crédito espera 16 dígitos), por lo que puede ingresar los valores 
                      que desee. El flujo de unión (joinFlow) no requiere que marque ninguna casilla en sus 
                      menús de casillas de verificación.
                    </p>
                  </div>
                </li>
                <li>
                  <p>
                    En la última página de un flujo, seleccione la opción para ingresar al otro flujo. Esto le 
                    permite ver los parámetros entrantes del flujo anterior.
                  </p>
                </li>
                <li>
                  <p>
                    Debido a que los flujos están anidados, si hace clic en Exit Flow desde un flujo llamado, 
                    volverá a la primera página del flujo de llamada. (Es posible que vea una advertencia, que 
                    puede ignorar). Haga clic en Exit Flow en esa página para ir al nodo de retorno 
                    especificado.
                  </p>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="jsf-configure003.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="jsf-configure005.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
