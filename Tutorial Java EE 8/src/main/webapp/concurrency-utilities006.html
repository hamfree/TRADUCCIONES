<!DOCTYPE html>
<html lang="es">
  <head>
    <meta charset="utf-8"/>
    <title>El Ejemplo de Concurrencia de taskcreator</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="css/style.css" rel="stylesheet">
    <script src="https://use.fontawesome.com/96c4d89611.js"></script>
  </head>
  <body>
    <table id="doc-title" cellspacing="0" cellpadding="0">
      <tr>
        <td align="left" valign="top">
          <b>Plataforma Java, Edición Empresarial (Java EE) 8</b><br />
          <b>El Tutorial de Java EE</b>
        </td>
      </tr>
    </table>
    <hr />
    <table width="90%" id="top-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>
        <td align="left">
          <a href="concurrency-utilities005.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="concurrency-utilities007.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class=" vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <div class="sect1" id="CIHBFEAE">
      <h2 id="the-taskcreator-concurrency-example">El Ejemplo de Concurrencia de taskcreator</h2>
      <div class="sectionbody">
        <div class="paragraph">
          <p>
            El ejemplo de <code>taskcreator</code> demuestra cómo utilizar las utilidades de concurrencia para 
            Java EE para ejecutar tareas de forma inmediata, periódica o después de un retraso fijo. Este 
            ejemplo proporciona una interfaz JavaServer Faces que permite a los usuarios enviar tareas para 
            ejecutar y muestra mensajes de información para cada tarea. El ejemplo utiliza el Servicio de 
            Ejecutor Administrado para ejecutar tareas inmediatamente y el Servicio de Ejecutor Programado 
            Administrado para ejecutar tareas periódicamente o después de un retraso fijo. (Consulte 
            <a href="concurrency-utilities002.html#CIHFBCFH">
              Componentes Principales de las Utilidades de Concurrencia
            </a> para obtener información sobre estos servicios).
          </p>
        </div>
        <div class="paragraph">
          <p>El ejemplo de <code>taskcreator</code> consta de los siguientes componentes.</p>
        </div>
        <div class="ulist">
          <ul>
            <li>
              <p>
                Una página de JavaServer Faces (<code>index.xhtml</code>) que contiene tres elementos: un 
                formulario para enviar tareas, un registro de ejecución de tareas y un formulario para 
                cancelar tareas periódicas. Esta página envía solicitudes Ajax para crear y cancelar tareas. 
                Esta página también recibe mensajes de WebSocket, utilizando código JavaScript para actualizar 
                el registro de ejecución de tareas.
              </p>
            </li>
            <li>
              <p>
                Un bean gestionado por CDI (<code>TaskCreatorBean</code>) que procesa las solicitudes de la 
                página JavaServer Faces. Este bean invoca los métodos en <code>TaskEJB</code> para enviar 
                nuevas tareas y cancelar tareas periódicas.
              </p>
            </li>
            <li>
              <p>
                Un enterprise bean (<code>TaskEJB</code>) que obtiene instancias de servicio ejecutor mediante 
                la inyección de recursos y envía tareas para su ejecución. Este bean también es un punto final 
                de servicio web JAX-RS. Las tareas envían mensajes de información a este punto final.
              </p>
            </li>
            <li>
              <p>
                Un punto final de WebSocket (<code>InfoEndpoint</code>) que utiliza el enterprise bean para 
                enviar mensajes de información a los clientes.
              </p>
            </li>
            <li>
              <p>
                Una clase de tarea (<code>Task</code>) que implementa la interfaz <code>Runnable</code>. El 
                método <code>run</code> de esta clase envía mensajes de información al extremo del servicio 
                web en <code>TaskEJB</code> y duerme durante 1,5 segundos.
              </p>
            </li>
          </ul>
        </div>
        <div class="paragraph">
          <p>
            La <a href="#CIHHACFF">Figura 59-1</a> muestra la arquitectura del ejemplo 
            <code>taskcreator</code>.
          </p>
        </div>
        <div id="CIHHACFF" class="paragraph">
          <div class="title">
            <strong>Figura 59-1 Arquitectura del ejemplo taskcreator</strong>
          </div>
          <p>
            <span class="image">
              <img src="img/javaeett_dt_060.png" 
                   alt="La figura muestra la arquitectura del ejemplo de taskcreator. La página JavaServer 
                   Faces invoca métodos en un bean administrado por CDI, que envía solicitudes de iniciación 
                   de tareas a un enterprise bean. El enterprise bean utiliza un punto final de WebSocket para 
                   indicar a los clientes que hay disponible un registro de ejecución de tareas actualizado.">
            </span>
          </p>
        </div>
        <div class="paragraph">
          <p>
            La clase <code>TaskEJB</code> obtiene los objetos de servicio del ejecutor predeterminados del 
            servidor de aplicaciones de la siguiente manera:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
@Resource(name="java:comp/DefaultManagedExecutorService")
ManagedExecutorService mExecService;
@Resource(name="java:comp/DefaultManagedScheduledExecutorService")
ManagedScheduledExecutorService sExecService;
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            El método <code>submitTask</code> en <code>TaskEJB</code> utiliza estos objetos para enviar tareas 
            para su ejecución de la siguiente manera:
          </p>
        </div>
        <div class="listingblock">
          <div class="content">
            <pre class="prettyprint highlight">
              <code class="language-oac_no_warn" data-lang="oac_no_warn">
public void submitTask(Task task, String type) {
    /* Use the managed executor objects from the app server */
    switch (type) {
        case "IMMEDIATE":
            mExecService.submit(task);
            break;
        case "DELAYED":
            sExecService.schedule(task, 3, TimeUnit.SECONDS);
            break;
        case "PERIODIC":
            ScheduledFuture&lt;?&gt; fut;
            fut = sExecService.scheduleAtFixedRate(task, 0, 8,
                    TimeUnit.SECONDS);
            periodicTasks.put(task.getName(), fut);
            break;
    }
}
              </code>
            </pre>
          </div>
        </div>
        <div class="paragraph">
          <p>
            Para tareas periódicas, <code>TaskEJB</code> mantiene una referencia al objeto 
            <code>ScheduledFuture</code>, para que el usuario pueda cancelar la tarea en cualquier momento.
          </p>
        </div>
        <div class="sect2" id="sthref296">
          <h3 id="running-the-taskcreator-example">Ejecutando el Ejemplo taskcreator</h3>
          <div class="paragraph">
            <p>
              Esta sección describe cómo compilar, empaquetar, implementar y ejecutar el ejemplo de 
              <code>taskcreator</code> utilizando el EID de NetBeans o Maven.
            </p>
          </div>
          <div class="paragraph">
            <p>Aquí se tratan los siguientes temas:</p>
          </div>
          <div class="ulist">
            <ul>
              <li>
                <p>
                  <a href="#CHDCCJHB">
                    Para Construir, Empaquetar, y Desplegar el Ejemplo taskcreator Usando el EID NetBeans
                  </a>
                </p>
              </li>
              <li>
                <p>
                  <a href="#CHDHJBDD">
                    Para Construir, Empaquetar, y Desplegar el Ejemplo taskcreator Usando Maven
                  </a>
                </p>
              </li>
              <li>
                <p><a href="#CHDBJGID">Para Ejecutar el Ejemplo taskcreator</a></p>
              </li>
            </ul>
          </div>
          <div class="sect3" id="CHDCCJHB">
            <h4 id="to-build-package-and-deploy-the-taskcreator-example-using-netbeans-ide">
              Para Construir, Empaquetar, y Desplegar el Ejemplo taskcreator Usando el EID NetBeans
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el Servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En el menú Archivo, elija Abrir proyecto.</p>
                </li>
                <li>
                  <p>En el cuadro de diálogo Abrir proyecto, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/concurrency
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Seleccione la carpeta <code>taskcreator</code>.</p>
                </li>
                <li>
                  <p>Haga clic en Abrir proyecto.</p>
                </li>
                <li>
                  <p>
                    En la pestaña Proyectos, haga clic con el botón derecho en el proyecto 
                    <code>taskcreator</code> y seleccione Generar.
                  </p>
                  <div class="paragraph">
                    <p>Este comando compila e implementa la aplicación.</p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDHJBDD">
            <h4 id="to-build-package-and-deploy-the-taskcreator-example-using-maven">
              Para Construir, Empaquetar, y Desplegar el Ejemplo taskcreator Usando Maven
            </h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>
                    Asegúrese de que el Servidor GlassFish se haya iniciado (consulte 
                    <a href="usingexamples002.html#BNADI">Arrancando y Parando el Servidor GlassFish</a>).
                  </p>
                </li>
                <li>
                  <p>En una ventana de terminal, vaya a:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
tut-install/examples/concurrency/taskcreator
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>Ingrese el siguiente comando para compilar e implementar la aplicación:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
mvn install
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
              </ol>
            </div>
          </div>
          <div class="sect3" id="CHDBJGID">
            <h4 id="to-run-the-taskcreator-example">Para Ejecutar el Ejemplo taskcreator</h4>
            <div class="olist arabic">
              <ol class="arabic">
                <li>
                  <p>Abra la siguiente URL en un navegador web:</p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
http://localhost:8080/taskcreator/
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      La página contiene un formulario para enviar tareas, un registro de ejecución de tareas 
                      y un formulario para cancelar tareas periódicas.
                    </p>
                  </div>
                </li>
                <li>
                  <p>
                    Seleccione el tipo de tarea Inmediata, ingrese un nombre de tarea y haga clic en el botón 
                    Enviar. Aparecen mensajes como el siguiente en el registro de ejecución de la tarea:
                  </p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
12:40:47 - IMMEDIATE Task TaskA finished
12:40:45 - IMMEDIATE Task TaskA started
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    Seleccione el tipo de tarea Retrasada (3 segundos), ingrese un nombre de tarea y haga clic 
                    en el botón Enviar. Aparecen mensajes como el siguiente en el registro de ejecución de la 
                    tarea:
                  </p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
12:43:26 - DELAYED Task TaskB finished
12:43:25 - DELAYED Task TaskB started
12:43:22 - DELAYED Task TaskB submitted
                        </code>
                      </pre>
                    </div>
                  </div>
                </li>
                <li>
                  <p>
                    Seleccione el tipo de tarea Periódica (8 segundos), ingrese un nombre de tarea y haga clic 
                    en el botón Enviar. Aparecen mensajes como el siguiente en el registro de ejecución de la 
                    tarea:
                  </p>
                  <div class="listingblock">
                    <div class="content">
                      <pre class="prettyprint highlight">
                        <code class="language-oac_no_warn" data-lang="oac_no_warn">
12:45:25 - PERIODIC Task TaskC finished run #2
12:45:23 - PERIODIC Task TaskC started run #2
12:45:17 - PERIODIC Task TaskC finished run #1
12:45:15 - PERIODIC Task TaskC started run #1
                        </code>
                      </pre>
                    </div>
                  </div>
                  <div class="paragraph">
                    <p>
                      Puede agregar más de una tarea periódica. Para cancelar una tarea periódica, 
                      selecciónela del formulario y haga clic en Cancelar tarea.
                    </p>
                  </div>
                </li>
              </ol>
            </div>
          </div>
        </div>
      </div>
    </div>
    <hr />
    <table width="90%" id="bottom-nav" cellspacing="0" cellpadding="0">
      <colgroup>
        <col width="12%"/>
        <col width="12%"/>
        <col width="*"/>
      </colgroup>
      <tr>		
        <td align="left">
          <a href="concurrency-utilities005.html">
            <span class=" vector-font"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Anterior</span>
          </a>
        </td>
        <td align="left">
          <a href="concurrency-utilities007.html">
            <span class="vector-font"><i class="fa fa-arrow-circle-right vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Siguiente</span>
          </a>
        </td>
        <td align="right">
          <a href="toc.html">
            <span class="vector-font"><i class="fa fa-list vector-font" aria-hidden="true"></i></span>
            <span style="position:relative;top:-2px;">Contenidos</span>
          </a>
        </td>
      </tr>
    </table>
    <span id="copyright">
      <a href="img/cpyr.adoc">
        <img src="img/oracle.gif" height="10" alt="Logo de Oracle" />&nbsp;			
        <span>
          Copyright&nbsp;&copy;&nbsp;2017,&nbsp;Oracle&nbsp;y/o&nbsp;sus&nbsp;afiliados.&nbsp;Todos&nbsp;los&nbsp;
          derechos&nbsp;reservados.
        </span>
      </a>
    </span>
  </body>
</html>
